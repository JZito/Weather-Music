!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return r(i?i:e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e){p5.prototype.Gibber=e("gibber.core.lib"),p5.prototype.Gibber.Audio=e("gibber.audio.lib")(p5.prototype.Gibber),p5.prototype.Gibber.export(p5.prototype),p5.prototype.Gibber.init({globalize:!1,target:p5.prototype})},{"gibber.audio.lib":5,"gibber.core.lib":26}],2:[function(require,module,exports){(function(global){!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Gibberish=t()}(this,function(){function createInput(){console.log("connecting audio input..."),navigator.getUserMedia({audio:!0},function(e){console.log("audio input connected"),Gibberish.mediaStreamSource=Gibberish.context.createMediaStreamSource(e),Gibberish.mediaStreamSource.connect(Gibberish.node),_hasInput=!0},function(e){console.log(e),console.log("error opening audio input")})}var Gibberish={memo:{},codeblock:[],analysisCodeblock:[],analysisUgens:[],dirtied:[],id:0,isDirty:!1,out:null,debug:!1,callback:"",audioFiles:{},sequencers:[],callbackArgs:["input"],callbackObjects:[],analysisCallbackArgs:[],analysisCallbackObjects:[],onBlock:null,createCallback:function(){this.memo={},this.codeblock.length=0,this.callbackArgs.length=0,this.callbackObjects.length=0,this.analysisCallbackArgs.length=0,this.dirtied.length=0,this.codestring="",this.args=["input"],this.memo={},this.out.codegen();var e=this.codeblock.slice(0);if(this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var t=0;t<this.analysisUgens.length;t++)this.analysisCallbackArgs.push(this.analysisUgens[t].analysisSymbol)}if(this.args=this.args.concat(this.callbackArgs),this.args=this.args.concat(this.analysisCallbackArgs),this.codestring+=e.join("	"),this.codestring+="\n	",this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var t=0;t<this.analysisUgens.length;t++)this.codeblock.length=0,this.analysisUgens[t].analysisCodegen();this.codestring+=this.analysisCodeblock.join("\n	"),this.codestring+="\n	"}return this.codestring+="return "+this.out.variable+";\n",this.callbackString=this.codestring,this.debug&&console.log(this.callbackString),[this.args,this.codestring]},audioProcess:function(e){var t,i,n=e.outputBuffer.getChannelData(0),r=e.outputBuffer.getChannelData(1),o=e.inputBuffer.getChannelData(0),s=Gibberish,a=s.callback,u=s.sequencers,c=(Gibberish.out.callback,s.callbackObjects.slice(0));null!==s.onBlock&&s.onBlock(s.context),c.unshift(0);for(var l=0,p=e.outputBuffer.length;p>l;l++){for(var f=0;f<u.length;f++)u[f].tick();if(s.isDirty){t=s.createCallback();try{a=s.callback=new Function(t[0],t[1])}catch(e){console.error("ERROR WITH CALLBACK : \n\n",t)}s.isDirty=!1,c=s.callbackObjects.slice(0),c.unshift(0)}c[0]=o[l],i=a.apply(null,c),n[l]=i[0],r[l]=i[1]}},audioProcessFirefox:function(e){var t,i=Gibberish,n=i.callback,r=i.sequencers,o=i.callbackObjects.slice(0);o.unshift(0);for(var s=0,a=e.length;a>s;s+=2){for(var u=0;u<r.length;u++)r[u].tick();if(i.isDirty){t=i.createCallback();try{n=i.callback=new Function(t[0],t[1])}catch(c){console.error("ERROR WITH CALLBACK : \n\n",n)}i.isDirty=!1,o=i.callbackObjects.slice(0),o.unshift(0)}var l=n.apply(null,o);e[s]=l[0],e[s+1]=l[1]}},clear:function(){this.out.inputs.length=0,this.analysisUgens.length=0,this.sequencers.length=0,this.callbackArgs.length=2,this.callbackObjects.length=1,Gibberish.dirty(this.out)},dirty:function(e){if("undefined"!=typeof e){for(var t=!1,i=0;i<this.dirtied.length;i++)this.dirtied[i].variable===e.variable&&(t=!0);t||(this.isDirty=!0,this.dirtied.push(e))}else this.isDirty=!0},generateSymbol:function(e){return e+"_"+this.id++},AudioDataDestination:function(e,t){var i=new Audio;i.mozSetup(2,e);var n,r=0,o=e/2,s=null;setInterval(function(){var e;if(s){if(e=i.mozWriteAudio(s.subarray(n)),r+=e,n+=e,n<s.length)return;s=null}var a=i.mozCurrentSampleOffset(),u=a+o-r;if(u>0){var c=new Float32Array(u);t(c),e=i.mozWriteAudio(c),a=i.mozCurrentSampleOffset(),e<c.length&&(s=c,n=e),r+=e}},100)},init:function(){var e,t,i="undefined"==typeof arguments[0]?1024:arguments[0];return"undefined"!=typeof webkitAudioContext?e=webkitAudioContext:"undefined"!=typeof AudioContext&&(e=AudioContext),t=function(){if("undefined"!=typeof e){if(document&&document.documentElement&&"ontouchstart"in document.documentElement&&(window.removeEventListener("touchstart",t),"ontouchstart"in document.documentElement)){var i=Gibberish.context.createBufferSource();i.connect(Gibberish.context.destination),i.noteOn(0)}}else alert("Your browser does not support javascript audio synthesis. Please download a modern web browser that is not Internet Explorer.");Gibberish.onstart&&Gibberish.onstart()},Gibberish.context=new e,Gibberish.node=Gibberish.context.createScriptProcessor(i,2,2,Gibberish.context.sampleRate),Gibberish.node.onaudioprocess=Gibberish.audioProcess,Gibberish.node.connect(Gibberish.context.destination),Gibberish.out=new Gibberish.Bus2,Gibberish.out.codegen(),Gibberish.dirty(Gibberish.out),document&&document.documentElement&&"ontouchstart"in document.documentElement?window.addEventListener("touchstart",t):t(),this},makePanner:function(){for(var e=[],t=[],i=Math.sqrt(2)/2,n=0;1024>n;n++){var r=-1+n/1024*2;e[n]=i*(Math.cos(r)-Math.sin(r)),t[n]=i*(Math.cos(r)+Math.sin(r))}return function(i,n,r){var o,s,a,u,c,l,p="object"==typeof i,f=p?i[0]:i,h=p?i[1]:i;return o=1023*(n+1)/2,s=0|o,a=o-s,s=1023&s,u=1023===s?0:s+1,c=e[s],l=e[u],r[0]=(c+a*(l-c))*f,c=t[s],l=t[u],r[1]=(c+a*(l-c))*h,r}},defineUgenProperty:function(e,t,i){var n=i.properties[e]={value:t,binops:[],parent:i,name:e};Object.defineProperty(i,e,{configurable:!0,get:function(){return n.value},set:function(e){n.value=e,Gibberish.dirty(i)}})},polyInit:function(e){e.mod=e.polyMod,e.removeMod=e.removePolyMod,e.voicesClear=function(){if(e.children.length>0){for(var t=0;t<e.children.length;t++)e.children[t].disconnect();e.children.length=0,e.voiceCount=0}};for(var t in e.polyProperties)!function(t){var i=e.polyProperties[t];Object.defineProperty(e,t,{configurable:!0,get:function(){return i},set:function(n){i=n;for(var r=0;r<e.children.length;r++)e.children[r][t]=i}})}(t);var i=e.maxVoices;Object.defineProperty(e,"maxVoices",{get:function(){return i},set:function(e){i=e,this.voicesClear(),this.initVoices()}})},interpolate:function(e,t){var i=0|t,n=i+1>e.length-1?0:i+1;return frac=t-i,e[i]+frac*(e[n]-e[i])},pushUnique:function(e,t){for(var i=e,n=!0,r=0;r<t.length;r++)if(i===t[r]){n=!1;break}n&&t.push(i)},"export":function(e,t){for(var i in Gibberish[e])t[i]=Gibberish[e][i]},ugen:function(){Gibberish.extend(this,{processProperties:function(){if("object"!=typeof arguments[0][0]||"undefined"!=typeof arguments[0][0].type||Array.isArray(arguments[0][0])||"op"===arguments[0][0].name){var e=0;for(var t in this.properties)"object"==typeof this.properties[t]&&"undefined"!=typeof this.properties[t].binops?"undefined"!=typeof arguments[0][e]&&(this.properties[t].value=arguments[0][e++]):"undefined"!=typeof arguments[0][e]&&(this.properties[t]=arguments[0][e++])}else{var i=arguments[0][0];for(var t in i)"undefined"!=typeof i[t]&&("object"==typeof this.properties[t]&&"undefined"!=typeof this.properties[t].binops?this.properties[t].value=i[t]:this[t]=i[t])}return this},valueOf:function(){return this.codegen(),this.variable},codegen:function(){var e="",t=null;if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];t=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=t,this.variable=t,e+="var "+t+" = "+this.symbol+"(";for(var i in this.properties){var n=this.properties[i],r="";if(Array.isArray(n.value)){0===n.value.length&&(r=0);for(var o=0;o<n.value.length;o++){var s=n.value[o];r+="object"==typeof s?null!==s?s.valueOf():"null":"function"==typeof n.value?n.value():n.value,r+=o<n.value.length-1?", ":""}}else"object"==typeof n.value?null!==n.value&&(r=n.value.codegen?n.value.valueOf():n.value):"undefined"!==n.name&&(r="function"==typeof n.value?n.value():n.value);if(0!=n.binops.length){for(var a=0;a<n.binops.length;a++)e+="(";for(var u=0;u<n.binops.length;u++){var c,l=n.binops[u];c="number"==typeof l.ugen?l.ugen:null!==l.ugen?l.ugen.valueOf():"null","="===l.binop?(e=e.replace(r,""),e+=c):"++"===l.binop?e+=" + Math.abs("+c+")":(0===u&&(e+=r),e+=" "+l.binop+" "+c+")")}}else e+=r;e+=", "}return" "===e.charAt(e.length-1)&&(e=e.slice(0,-2)),e+=");\n",this.codeblock=e,-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),-1===Gibberish.callbackArgs.indexOf(this.symbol)&&"op"!==this.name&&Gibberish.callbackArgs.push(this.symbol),-1===Gibberish.callbackObjects.indexOf(this.callback)&&"op"!==this.name&&Gibberish.callbackObjects.push(this.callback),this.dirty=!1,t},init:function(){if(this.initalized||(this.symbol=Gibberish.generateSymbol(this.name),this.codeblock=null,this.variable=null),"undefined"==typeof this.properties&&(this.properties={}),!this.initialized){this.destinations=[];for(var e in this.properties)Gibberish.defineUgenProperty(e,this.properties[e],this)}if(arguments.length>0&&"object"==typeof arguments[0][0]&&"undefined"===arguments[0][0].type){var t=arguments[0][0];for(var e in t)this[e]=t[e]}return this.initialized=!0,this},mod:function(e,t,i){var n=this.properties[e],r={ugen:t,binop:i};n.binops.push(r),Gibberish.dirty(this)},removeMod:function(e,t){if("undefined"==typeof t)this.properties[e].binops.length=0;else if("number"==typeof t)this.properties[e].binops.splice(t,1);else if("object"==typeof t)for(var i=0,n=this.properties[e].binops.length;n>i;i++)this.properties[e].binops[i].ugen===t&&this.properties[e].binops.splice(i,1);Gibberish.dirty(this)},polyMod:function(e,t,i){for(var n=0;n<this.children.length;n++)this.children[n].mod(e,t,i);Gibberish.dirty(this)},removePolyMod:function(){var e=Array.prototype.slice.call(arguments,0);if("amp"!==arguments[0]&&"pan"!==arguments[0])for(var t=0;t<this.children.length;t++)this.children[t].removeMod.apply(this.children[t],e);else this.removeMod.apply(this,e);Gibberish.dirty(this)},smooth:function(e){var t=new Gibberish.OnePole;this.mod(e,t,"=")},connect:function(e,t){return"undefined"==typeof e&&(e=Gibberish.out),-1===this.destinations.indexOf(e)&&(e.addConnection(this,1,t),this.destinations.push(e)),this},send:function(e,t){return-1===this.destinations.indexOf(e)?(e.addConnection(this,t),this.destinations.push(e)):e.adjustSendAmount(this,t),this},disconnect:function(e,t){var i;if(e)i=this.destinations.indexOf(e),i>-1&&this.destinations.splice(i,1),e.removeConnection(this);else{for(var n=0;n<this.destinations.length;n++)this.destinations[n].removeConnection(this);this.destinations=[]}return Gibberish.dirty(this),this}})}};Array2=function(){this.length=0},Array2.prototype=[],Array2.prototype.remove=function(e,t){if(t="undefined"==typeof t?!0:t,"undefined"==typeof e){for(var i=0;i<this.length;i++)delete this[i];this.length=0}else if("number"==typeof e)this.splice(e,1);else if("string"==typeof e){for(var n=[],i=0;i<this.length;i++){var r=this[i];if(r.type===e||r.name===e){if(!t)return void this.splice(i,1);n.push(i)}}for(var i=0;i<n.length;i++)this.splice(n[i],1)}else if("object"==typeof e)for(var o=this.indexOf(e);o>-1;)this.splice(o,1),o=this.indexOf(e);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.get=function(e){if("number"==typeof e)return this[e];if("string"==typeof e)for(var t=0;t<this.length;t++){var i=this[t];if(i.name===e)return i}else if("object"==typeof e){var n=this.indexOf(e);if(n>-1)return this[n]}return null},Array2.prototype.replace=function(e,t){if(t.parent=this,t.input=e.input,"number"!=typeof e){var i=this.indexOf(e);i>-1&&this.splice(i,1,t)}else this.splice(e,1,t);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.insert=function(e,t){if(e.parent=this,this.input=this.parent,Array.isArray(e))for(var i=0;i<e.length;i++)this.splice(t+i,0,e[i]);else this.splice(t,0,e);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.add=function(){for(var e=0;e<arguments.length;e++)arguments[e].parent=this,arguments[e].input=this.parent,this.push(arguments[e]);this.parent&&(console.log("DIRTYING"),Gibberish.dirty(this.parent))};var rnd=Math.random;Gibberish.rndf=function(e,t,i,n){if(n="undefined"==typeof n?!0:n,"undefined"==typeof i&&"object"!=typeof e){1==arguments.length?(t=arguments[0],e=0):2==arguments.length?(e=arguments[0],t=arguments[1]):(e=0,t=1);var r=t-e,o=Math.random(),s=r*o;return e+s}var a=[],u=[];"undefined"==typeof i&&(i=t||e.length);for(var c=0;i>c;c++){var l;if("object"==typeof arguments[0])l=arguments[0][rndi(0,arguments[0].length-1)];else if(n)l=Gibberish.rndf(e,t);else{for(l=Gibberish.rndf(e,t);u.indexOf(l)>-1;)l=Gibberish.rndf(e,t);u.push(l)}a.push(l)}return a},Gibberish.Rndf=function(){{var e,t,i,n;Math.random}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],i=arguments[2]):(e=arguments[0],t=arguments[1],i=arguments[2],n=arguments[3]),function(){var r,o,s;return o="function"==typeof e?e():e,s="function"==typeof t?t():t,r="undefined"==typeof i?Gibberish.rndf(o,s):Gibberish.rndf(o,s,i,n)}},Gibberish.rndi=function(e,t,i,n){var r;if(0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):(e=arguments[0],t=arguments[1],i=arguments[2],n=arguments[3]),r=t-e,i>r&&(n=!0),"undefined"==typeof i)return r=t-e,Math.round(e+Math.random()*r);for(var o=[],s=[],a=0;i>a;a++){var u;if(n)u=Gibberish.rndi(e,t);else{for(u=Gibberish.rndi(e,t);s.indexOf(u)>-1;)u=Gibberish.rndi(e,t);s.push(u)}o.push(u)}return o},Gibberish.Rndi=function(){{var e,t,i,n,r;Math.random,Math.round}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],i=arguments[2]):(e=arguments[0],t=arguments[1],i=arguments[2],n=arguments[3]),r=t-e,"number"==typeof i&&i>r&&(n=!0),function(){var r,o,s;return o="function"==typeof e?e():e,s="function"==typeof t?t():t,r="undefined"==typeof i?Gibberish.rndi(o,s):Gibberish.rndi(o,s,i,n)}},Gibberish.extend=function(e,t){for(var i in t){{i.split(".")}t[i]instanceof Array&&t[i].length<100?(e[i]=t[i].slice(0),"fx"===i&&(e[i].parent=t[i].parent)):"object"!=typeof t[i]||null===t[i]||t[i]instanceof Float32Array?e[i]=t[i]:(e[i]=e[i]||{},arguments.callee(e[i],t[i]))}return e},Function.prototype.clone=function(){return eval("["+this.toString()+"]")[0]},String.prototype.format=function(e,t,i){function n(){var n=this,r=arguments.length+1;for(e=0;r>e;i=arguments[e++])t=i,n=n.replace(RegExp("\\{"+(e-1)+"\\}","g"),t);return n}return n.native=String.prototype.format,n}(),Gibberish.future=function(e,t){var i=new Gibberish.Sequencer({values:[function(){},function(){e(),i.stop(),i.disconnect()}],durations:[t]}).start();return i.cancel=function(){i.stop(),i.disconnect()},i},Gibberish.Proxy=function(){var e=0;Gibberish.extend(this,{name:"proxy",type:"effect",properties:{},callback:function(){return e}}).init(),this.input=arguments[0],e=this.input.parent[this.input.name],delete this.input.parent[this.input.name],this.input.parent.properties[this.input.name].value=this,Object.defineProperty(this.input.parent,this.input.name,{get:function(){return e},set:function(t){e=t}}),Gibberish.dirty(this.input.parent)},Gibberish.Proxy.prototype=new Gibberish.ugen,Gibberish.Proxy2=function(){var e=arguments[0],t=arguments[1];Gibberish.extend(this,{name:"proxy2",type:"effect",properties:{},callback:function(){var i=e[t];return Array.isArray(i)?(i[0]+i[1]+i[2])/3:i}}).init(),this.getInput=function(){return e},this.setInput=function(t){e=t},this.getName=function(){return t},this.setName=function(e){t=e}},Gibberish.Proxy2.prototype=new Gibberish.ugen,Gibberish.Proxy3=function(){var e=arguments[0],t=arguments[1];Gibberish.extend(this,{name:"proxy3",type:"effect",properties:{},callback:function(){var i=e[t];return i||0}}),this.init(),this.codegen=function(){console.log(" CALLED "),this.variable||(this.variable=Gibberish.generateSymbol("v")),Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"("+e.properties[t].codegen()+");\n"}},Gibberish.Proxy3.prototype=new Gibberish.ugen,Gibberish.oscillator=function(){this.type="oscillator",this.oscillatorInit=function(){return this.fx=new Array2,this.fx.parent=this,this}},Gibberish.oscillator.prototype=new Gibberish.ugen,Gibberish._oscillator=new Gibberish.oscillator,Gibberish.Wavetable=function(){var e=0,t=null,i=Gibberish.context.sampleRate/1024;this.properties={frequency:440,amp:.25,sync:0},this.getTable=function(){return t},this.setTable=function(e){t=e,i=Gibberish.context.sampleRate/t.length},this.getTableFreq=function(){return i},this.setTableFreq=function(e){i=e},this.getPhase=function(){return e},this.setPhase=function(t){e=t},this.callback=function(n,r){var o,s,a,u,c;for(e+=n/i;e>=1024;)e-=1024;return o=0|e,s=e-o,o=1023&o,a=1023===o?0:o+1,u=t[o],c=t[a],(u+s*(c-u))*r}},Gibberish.Wavetable.prototype=Gibberish._oscillator,Gibberish.Table=function(e){this.__proto__=new Gibberish.Wavetable,this.name="table";var t=2*Math.PI;if("undefined"==typeof e){e=new Float32Array(1024);for(var i=1024;i--;)e[i]=Math.sin(i/1024*t)}this.setTable(e),this.init(),this.oscillatorInit()},Gibberish.asmSine=function(e,t,i){"use asm";function n(){for(var e=1024,t=1024;e=e-1|0;)t-=1,u[e>>2]=+s(+(t/1024)*6.2848);l=44100/1024}function r(e,t,i){e=+e,t=+t,i=+i;var n=0,r=0,o=0,s=0,p=0,f=0;return a=+(a+e/l),a>=1024&&(a=+(a-1024)),n=+c(a),s=a-n,r=~~n,o=(r|0)==1024?0:r+1|0,p=+u[r>>2],f=+u[o>>2],+((p+s*(f-p))*t)}function o(e){return e|=0,+u[e>>2]}var s=e.Math.sin,a=0,u=new e.Float32Array(i),c=e.Math.floor,l=0;return{init:n,gen:r,get:o}},Gibberish.asmSine2=function(){this.properties={frequency:440,amp:.5,sr:Gibberish.context.sampleRate},this.name="sine";var e=new ArrayBuffer(4096),t=Gibberish.asmSine(window,null,e);return t.init(),this.getTable=function(){return e},this.get=t.get,this.callback=t.gen,this.init(),this.oscillatorInit(),this.processProperties(arguments),this},Gibberish.asmSine2.prototype=Gibberish._oscillator,Gibberish.Sine=function(){this.__proto__=new Gibberish.Wavetable,this.name="sine";for(var e=2*Math.PI,t=new Float32Array(1024),i=1024;i--;)t[i]=Math.sin(i/1024*e);this.setTable(t),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Sine2=function(){this.__proto__=new Gibberish.Sine,this.name="sine2";var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(n,r,o){var s=e(n,r);return i=t(s,o,i)},this.init(),this.oscillatorInit(),Gibberish.defineUgenProperty("pan",0,this),this.processProperties(arguments)},Gibberish.Square=function(){this.__proto__=new Gibberish.Wavetable,this.name="square";for(var e=(2*Math.PI,new Float32Array(1024)),t=1024;t--;)e[t]=t/1024>.5?1:-1;this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw=function(){this.__proto__=new Gibberish.Wavetable,this.name="saw";for(var e=new Float32Array(1024),t=1024;t--;)e[t]=4*((t/1024/2+.25)%.5-.25);this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw2=function(){this.__proto__=new Gibberish.Saw,this.name="saw2";var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(n,r,o){var s=e(n,r);return i=t(s,o,i)},this.init(),Gibberish.defineUgenProperty("pan",0,this)},Gibberish.Triangle=function(){this.__proto__=new Gibberish.Wavetable,this.name="triangle";for(var e=new Float32Array(1024),t=Math.abs,i=1024;i--;)e[i]=1-4*t((i/1024+.25)%1-.5);this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Triangle2=function(){this.__proto__=new Gibberish.Triangle,this.name="triangle2";var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(n,r,o){var s=e(n,r);return t(s,o,i)},this.init(),this.oscillatorInit(),Gibberish.defineUgenProperty("pan",0,this),this.processProperties(arguments)},Gibberish.Saw3=function(){var e=0,t=0,i=2.5,n=-1.5,r=0,o=Math.sin,s=11;pi_2=2*Math.PI,flip=0,signHistory=0,ignore=!1,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"saw",properties:{frequency:440,amp:.15,sync:0,sr:Gibberish.context.sampleRate},callback:function(a){var u=a/sr,c=.5-u,l=s*c*c*c*c,p=.376-.752*u,f=1-2*u,h=0;return t+=u,t-=t>1?2:0,e=.5*(e+o(pi_2*(t+e*l))),h=i*e+n*r,r=e,h+=p,h*=f}}),Object.defineProperty(this,"scale",{get:function(){return s},set:function(e){s=e}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3.prototype=Gibberish._oscillator,Gibberish.PWM=function(){var e=0,t=0,i=0,n=0,r=0,o=2.5,s=-1.5,a=Math.sin,u=11;pi_2=2*Math.PI,test=0,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"pwm",properties:{frequency:440,amp:.15,pulsewidth:.05,sr:Gibberish.context.sampleRate},callback:function(c,l,p){var f=c/sr,h=.5-f,b=u*h*h*h*h,d=1-2*f,m=0;return r+=f,r-=r>1?2:0,e=.5*(e+a(pi_2*(r+e*b))),t=.5*(t+a(pi_2*(r+t*b+p))),m=t-e,m=o*m+s*(i-n),i=e,n=t,m*d*l}}),Object.defineProperty(this,"scale",{get:function(){return u},set:function(e){u=e}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.PWM.prototype=Gibberish._oscillator,Gibberish.Noise=function(){var e=Math.random;Gibberish.extend(this,{name:"noise",properties:{amp:1},callback:function(t){return(2*e()-1)*t}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Noise.prototype=Gibberish._oscillator,Gibberish.KarplusStrong=function(){var e=[0],t=0,i=Math.random,n=Gibberish.makePanner(),r=Gibberish.context.sampleRate,o=[0,0];Gibberish.extend(this,{name:"karplus_strong",frequency:0,properties:{blend:1,damping:0,amp:1,channels:2,pan:0},note:function(t){var n=Math.floor(r/t);e.length=0;for(var o=0;n>o;o++)e[o]=2*i()-1;this.frequency=t},callback:function(r,s,a,u,c){var l=e.shift(),p=i()>r?-1:1;s=s>0?s:0;var f=p*(l+t)*(.5-s/100);return t=f,e.push(f),f*=a,1===u?f:n(f,c,o)}}).init().oscillatorInit().processProperties(arguments)},Gibberish.KarplusStrong.prototype=Gibberish._oscillator,Gibberish.PolyKarplusStrong=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"poly_karplus_strong",maxVoices:5,voiceCount:0,_frequency:0,polyProperties:{blend:1,damping:0},note:function(e,t){var i=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),i.note(e,t),this._frequency=e},initVoices:function(){for(var e=0;e<this.maxVoices;e++){var t={blend:this.blend,damping:this.damping,channels:2,amp:1},i=new Gibberish.KarplusStrong(t).connect(this);this.children.push(i)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),this.initialized=!1,Gibberish._synth.oscillatorInit.call(this),Gibberish.dirty(this)},Gibberish.bus=function(){this.type="bus",this.inputCodegen=function(){var e,t=this.value.valueOf();return e=t+", "+this.amp,this.codeblock=e,e},this.addConnection=function(){var e=arguments[2],t={value:arguments[0],amp:arguments[1],codegen:this.inputCodegen,valueOf:function(){return this.codegen()}};"undefined"!=typeof e?this.inputs.splice(e,0,t):this.inputs.push(t),Gibberish.dirty(this)},this.removeConnection=function(e){for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].value===e){this.inputs.splice(t,1),Gibberish.dirty(this);break}},this.adjustSendAmount=function(e,t){for(var i=0;i<this.inputs.length;i++)if(this.inputs[i].value===e){this.inputs[i].amp=t,Gibberish.dirty(this);break}},this.callback=function(){var e=arguments[arguments.length-2],t=arguments[arguments.length-1];output[0]=output[1]=0;for(var i=0;i<arguments.length-2;i+=2){var n="object"==typeof arguments[i],r=arguments[i+1];output[0]+=n?arguments[i][0]*r:arguments[i]*r,output[1]+=n?arguments[i][1]*r:arguments[i]*r}return output[0]*=e,output[1]*=e,panner(output,t,output)}},Gibberish.bus.prototype=new Gibberish.ugen,Gibberish._bus=new Gibberish.bus,Gibberish.Bus=function(){return Gibberish.extend(this,{name:"bus",properties:{inputs:[],amp:1},callback:function(){for(var e=0,t=arguments.length-1,i=arguments[t],n=0;t>n;n++)e+=arguments[n];return e*=i}}),this.init(),this.processProperties(arguments),this},Gibberish.Bus.prototype=Gibberish._bus,Gibberish.Bus2=function(){this.name="bus2",this.type="bus",this.properties={inputs:[],amp:1,pan:0};var e=[0,0],t=Gibberish.makePanner();this.callback=function(){var i=arguments,n=i.length,r=i[n-2],o=i[n-1];e[0]=e[1]=0;for(var s=0,a=n-2;a>s;s+=2){var u="object"==typeof i[s],c=i[s+1];e[0]+=u?i[s][0]*c||0:i[s]*c||0,e[1]+=u?i[s][1]*c||0:i[s]*c||0}return e[0]*=r,e[1]*=r,t(e,o,e)},this.show=function(){console.log(e,args)},this.getOutput=function(){return e},this.getArgs=function(){return args},this.init(arguments),this.processProperties(arguments)},Gibberish.Bus2.prototype=Gibberish._bus,Gibberish.envelope=function(){this.type="envelope"},Gibberish.envelope.prototype=new Gibberish.ugen,Gibberish._envelope=new Gibberish.envelope,Gibberish.ExponentialDecay=function(){var e=Math.pow,t=0,i=0;Gibberish.extend(this,{name:"ExponentialDecay",properties:{decay:.5,length:11050},callback:function(n,r){return t=e(n,i),i+=1/r,t},trigger:function(){i="number"==typeof arguments[0]?arguments[0]:0}}).init()},Gibberish.ExponentialDecay.prototype=Gibberish._envelope,Gibberish.Line=function(e,t,i,n){var r,o={name:"line",properties:{start:e||0,end:isNaN(t)?1:t,time:i||Gibberish.context.sampleRate,loops:n||!1},retrigger:function(e,t){s=0,this.start=r,this.end=e,this.time=t,a=(e-r)/t},getPhase:function(){return s},getIncr:function(){return a},getOut:function(){return r}},s=0,a=(t-e)/i;return this.callback=function(e,t,i,n){var o=(t-e)/i;return r=i>s?e+s++*o:t,s=r>=t&&n?0:s,r},this.setPhase=function(e){s=e},Gibberish.extend(this,o),this.init(),this},Gibberish.Line.prototype=Gibberish._envelope,Gibberish.AD=function(e,t){var i=0,n=0;Gibberish.extend(this,{name:"AD",properties:{attack:e||1e4,decay:t||1e4},run:function(){return n=0,i=0,this},callback:function(e,t){if(e=0>e?22050:e,t=0>t?22050:t,0===n){var r=1/e;i+=r,i>=1&&n++}else if(1===n){var r=1/t;i-=r,0>=i&&(i=0,n++)}return i},getState:function(){return n}}).init().processProperties(arguments)},Gibberish.AD.prototype=Gibberish._envelope,Gibberish.ADSR=function(e,t,i,n,r,o,s){var a={name:"adsr",type:"envelope",requireReleaseTrigger:"undefined"!=typeof s?s:!1,properties:{attack:isNaN(e)?1e4:e,decay:isNaN(t)?1e4:t,sustain:isNaN(i)?22050:i,release:isNaN(n)?1e4:n,attackLevel:r||1,sustainLevel:o||.5,releaseTrigger:0},run:function(){this.setPhase(0),this.setState(0)},stop:function(){this.releaseTrigger=1}};Gibberish.extend(this,a);var u=0,c=0,l=0,p=this;return this.callback=function(e,t,i,n,r,o,s){var a=0;return l=1===l?1:s,0===c?(a=u/e*r,++u/e>=1&&(c++,u=t)):1===c?(a=u/t*(r-o)+o,--u<=0&&(null!==i?(c+=1,u=i):(c+=2,u=n))):2===c?(a=o,p.requireReleaseTrigger&&l?(c++,u=n,p.releaseTrigger=0,l=0):u--<=0&&!p.requireReleaseTrigger&&(c++,u=n)):3===c&&(u--,a=u/n*o,0>=u&&c++),a},this.call=function(){return this.callback(this.attack,this.decay,this.sustain,this.release,this.attackLevel,this.sustainLevel,this.releaseTrigger)},this.getPhase=function(){return u},this.setPhase=function(e){u=e},this.setState=function(e){c=e,u=0},this.getState=function(){return c},this.init(),this},Gibberish.ADSR.prototype=Gibberish._envelope,Gibberish.ADR=function(e,t,i,n,r){var o={name:"adr",type:"envelope",properties:{attack:isNaN(e)?11025:e,decay:isNaN(t)?11025:t,release:isNaN(i)?22050:i,attackLevel:n||1,releaseLevel:r||.2},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,o);var s=0,a=0;return this.callback=function(e,t,i,n,r){var o=0;return 0===a?(o=s/e*n,++s/e===1&&(a++,s=t)):1===a?(o=s/t*(n-r)+r,--s<=0&&(a+=1,s=i)):2===a&&(s--,o=s/i*r,0>=s&&a++),o},this.setPhase=function(e){s=e},this.setState=function(e){a=e,s=0},this.getState=function(){return a},this.init(),this},Gibberish.ADR.prototype=Gibberish._envelope,Gibberish.analysis=function(){this.type="analysis",this.codegen=function(){if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];var e=this.variable?this.variable:Gibberish.generateSymbol("v");return Gibberish.memo[this.symbol]=e,this.variable=e,Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"();\n",-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),this.variable},this.analysisCodegen=function(){var e=0;this.input.codegen?(e=this.input.codegen(),e.indexOf("op")>-1&&console.log("ANALYSIS BUG")):e=this.input.value?"undefined"!=typeof this.input.value.codegen?this.input.value.codegen():this.input.value:"null";var t=this.analysisSymbol+"("+e+",";for(var i in this.properties)"input"!==i&&(t+=this[i]+",");return t=t.slice(0,-1),t+=");",this.analysisCodeblock=t,-1===Gibberish.analysisCodeblock.indexOf(this.analysisCodeblock)&&Gibberish.analysisCodeblock.push(this.analysisCodeblock),-1===Gibberish.callbackObjects.indexOf(this.analysisCallback)&&Gibberish.callbackObjects.push(this.analysisCallback),t},this.remove=function(){Gibberish.analysisUgens.splice(Gibberish.analysisUgens.indexOf(this),1)},this.analysisInit=function(){this.analysisSymbol=Gibberish.generateSymbol(this.name),Gibberish.analysisUgens.push(this),Gibberish.dirty()}},Gibberish.analysis.prototype=new Gibberish.ugen,Gibberish._analysis=new Gibberish.analysis,Gibberish.Follow=function(){this.name="follow",this.properties={input:0,bufferSize:4410,mult:1,useAbsoluteValue:!0},this.storage=[];var e=Math.abs,t=[0],i=0,n=0,r=0;this.analysisCallback=function(o,s,a,u){"object"==typeof o&&(o=o[0]+o[1]),i+=u?e(o):o,i-=t[n],t[n]=u?e(o):o,n=(n+1)%s,t[n]=t[n]?t[n]:0,r=i/s*a},this.callback=this.getValue=function(){return r},this.init(),this.analysisInit(),this.processProperties(arguments);var o=(this.__lookupSetter__("bufferSize"),this.bufferSize);Object.defineProperty(this,"bufferSize",{get:function(){return o},set:function(e){o=e,i=0,t=[0],n=0}}),this.getStorage=function(){return this.storage}},Gibberish.Follow.prototype=Gibberish._analysis,Gibberish.SingleSampleDelay=function(){this.name="single_sample_delay",this.properties={input:arguments[0]||0,amp:arguments[1]||1};var e=0;this.analysisCallback=function(t){e=t},this.callback=function(){return e},this.getValue=function(){return e},this.init(),this.analysisInit(),this.processProperties(arguments)},Gibberish.SingleSampleDelay.prototype=Gibberish._analysis,Gibberish.Record=function(e,t,i){var n=new Float32Array(t),r=0,o=!1,s=this;Gibberish.extend(this,{name:"record",oncomplete:i,properties:{input:0,size:t||0},analysisCallback:function(e,t){o&&(n[r++]="object"==typeof e?e[0]+e[1]:e,r>=t&&(o=!1,s.remove()))},record:function(){return r=0,o=!0,this},getBuffer:function(){return n},getPhase:function(){return r},remove:function(){"undefined"!=typeof this.oncomplete&&this.oncomplete();for(var e=0;e<Gibberish.analysisUgens.length;e++){var t=Gibberish.analysisUgens[e];if(t===this)return Gibberish.callbackArgs.indexOf(this.analysisSymbol)>-1&&Gibberish.callbackArgs.splice(Gibberish.callbackArgs.indexOf(this.analysisSymbol),1),Gibberish.callbackObjects.indexOf(this.analysisCallback)>-1&&Gibberish.callbackObjects.splice(Gibberish.callbackObjects.indexOf(this.analysisCallback),1),void Gibberish.analysisUgens.splice(e,1)
}}}),this.properties.input=e,this.init(),this.analysisInit(),Gibberish.dirty()},Gibberish.Record.prototype=Gibberish._analysis,Gibberish.effect=function(){this.type="effect"},Gibberish.effect.prototype=new Gibberish.ugen,Gibberish._effect=new Gibberish.effect,Gibberish.Distortion=function(){var e=Math.abs,t=Math.log,i=Math.LN2;Gibberish.extend(this,{name:"distortion",properties:{input:0,amount:50},callback:function(n,r){var o;return r=r>2?r:2,"number"==typeof n?(o=n*r,n=o/(1+e(o))/(t(r)/i)):(o=n[0]*r,n[0]=o/(1+e(o))/(t(r)/i),o=n[1]*r,n[1]=o/(1+e(o))/(t(r)/i)),n}}).init().processProperties(arguments)},Gibberish.Distortion.prototype=Gibberish._effect,Gibberish.Gain=function(){Gibberish.extend(this,{name:"gain",properties:{input:0,amount:1},callback:function(e,t){return"number"==typeof e?e*=t:(e[0]*=t,e[1]*=t),e}}).init().processProperties(arguments)},Gibberish.Gain.prototype=Gibberish._effect,Gibberish.Delay=function(){var e=[],t=0;e.push(new Float32Array(2*Gibberish.context.sampleRate)),e.push(new Float32Array(2*Gibberish.context.sampleRate)),Gibberish.extend(this,{name:"delay",properties:{input:0,time:22050,feedback:.5,wet:1,dry:1},callback:function(i,n,r,o,s){var a="number"==typeof i?1:2,u=t++%88200,c=(u+(0|n))%88200;return 1===a?(e[0][c]=(i+e[0][u])*r,i=i*s+e[0][u]*o):(e[0][c]=(i[0]+e[0][u])*r,i[0]=i[0]*s+e[0][u]*o,e[1][c]=(i[1]+e[1][u])*r,i[1]=i[1]*s+e[1][u]*o),i}});var i=Math.round(this.properties.time);Object.defineProperty(this,"time",{configurable:!0,get:function(){return i},set:function(e){i=Math.round(e),Gibberish.dirty(this)}}),this.init(),this.processProperties(arguments)},Gibberish.Delay.prototype=Gibberish._effect,Gibberish.Decimator=function(){var e=0,t=[],i=Math.pow,n=Math.floor;Gibberish.extend(this,{name:"decimator",properties:{input:0,bitDepth:16,sampleRate:1},callback:function(r,o,s){e+=s;var a="number"==typeof r?1:2;if(1===a){if(e>=1){var u=i(o,2);t[0]=n(r*u)/u,e-=1}r=t[0]}else{if(e>=1){var u=i(o,2);t[0]=n(r[0]*u)/u,t[1]=n(r[1]*u)/u,e-=1}r=t}return r}}).init().processProperties(arguments)},Gibberish.Decimator.prototype=Gibberish._effect,Gibberish.RingModulation=function(){var e=(new Gibberish.Sine).callback,t=[0,0];Gibberish.extend(this,{name:"ringmod",properties:{input:0,frequency:440,amp:.5,mix:.5},callback:function(i,n,r,o){var s="number"==typeof i?1:2,a=1===s?i:i[0],u=e(n,r);if(a=a*(1-o)+a*u*o,2===s){var c=i[1];return c=c*(1-o)+c*u*o,t[0]=a,t[1]=c,t}return a}}).init().processProperties(arguments)},Gibberish.RingModulation.prototype=Gibberish._effect,Gibberish.DCBlock=function(){var e=0,t=0;Gibberish.extend(this,{name:"dcblock",type:"effect",properties:{input:0},reset:function(){e=0,t=0},callback:function(i){var n=i-e+.9997*t;return e=i,t=n,n}}).init().processProperties(arguments)},Gibberish.DCBlock.prototype=Gibberish._effect,Gibberish.Tremolo=function(){var e=(new Gibberish.Sine).callback;Gibberish.extend(this,{name:"tremolo",type:"effect",properties:{input:0,frequency:2.5,amp:.5},callback:function(t,i,n){var r="number"==typeof t?1:2,o=e(i,n);return 1===r?t*=o:(t[0]*=o,t[1]*=o),t}}).init().processProperties(arguments)},Gibberish.Tremolo.prototype=Gibberish._effect,Gibberish.OnePole=function(){var e=0;Gibberish.extend(this,{name:"onepole",type:"effect",properties:{input:0,a0:.15,b1:.85},callback:function(t,i,n){var r=t*i+e*n;return e=r,r},smooth:function(t,i){this.input=i[t],e=this.input,i[t]=this,this.obj=i,this.property=t,this.oldSetter=i.__lookupSetter__(t),this.oldGetter=i.__lookupGetter__(t);var n=this;Object.defineProperty(i,t,{get:function(){return n.input},set:function(e){n.input=e}})},remove:function(){Object.defineProperty(this.obj,this.property,{get:this.oldGetter,set:this.oldSetter}),this.obj[this.property]=this.input}}).init().processProperties(arguments)},Gibberish.OnePole.prototype=Gibberish._effect,Gibberish.Filter24=function(){var e=[0,0,0,0],t=[0,0,0,0],i=[0,0],n=isNaN(arguments[0])?.1:arguments[0],r=isNaN(arguments[1])?3:arguments[1];_isLowPass="undefined"!=typeof arguments[2]?arguments[2]:!0,Gibberish.extend(this,{name:"filter24",properties:{input:0,cutoff:n,resonance:r,isLowPass:_isLowPass},callback:function(n,r,o,s){var a="number"==typeof n?1:2,u=1===a?n:n[0],c=e[3]*o;if(c=c>1?1:c,r=0>r?0:r,r=r>1?1:r,u-=c,e[0]=e[0]+(-e[0]+u)*r,e[1]=e[1]+(-e[1]+e[0])*r,e[2]=e[2]+(-e[2]+e[1])*r,e[3]=e[3]+(-e[3]+e[2])*r,u=s?e[3]:u-e[3],2===a){var l=n[1];return c=t[3]*o,c=c>1?1:c,l-=c,t[0]=t[0]+(-t[0]+l)*r,t[1]=t[1]+(-t[1]+t[0])*r,t[2]=t[2]+(-t[2]+t[1])*r,t[3]=t[3]+(-t[3]+t[2])*r,l=s?t[3]:l-t[3],i[0]=u,i[1]=l,i}return u}}).init().processProperties(arguments)},Gibberish.Filter24.prototype=Gibberish._effect,Gibberish.SVF=function(){var e=[0,0],t=[0,0],i=Math.PI,n=[0,0];Gibberish.extend(this,{name:"SVF",properties:{input:0,cutoff:440,Q:2,mode:0,sr:Gibberish.context.sampleRate},callback:function(r,o,s,a,u){var c="number"==typeof r?1:2,l=1===c?r:r[0],p=2*i*o/u;s=1/s;var f=t[0]+p*e[0],h=l-f-s*e[0],b=p*h+e[0],d=h+f;if(e[0]=b,t[0]=f,l=0===a?f:1===a?h:2===a?b:d,2===c){var m=r[1],f=t[1]+p*e[1],h=m-f-s*e[1],b=p*h+e[1],d=h+f;e[1]=b,t[1]=f,m=0===a?f:1===a?h:2===a?b:d,n[0]=l,n[1]=m}else n=l;return n}}).init().processProperties(arguments)},Gibberish.SVF.prototype=Gibberish._effect,Gibberish.Biquad=function(){var e=0,t=0,i=0,n=0,r=0,o=0,s=0,a=0,u=[0,0],c=.001639,l=.003278,p=.001639,f=-1.955777,h=.960601,b="LP",d=2e3,m=.5,g=Gibberish.context.sampleRate;Gibberish.extend(this,{name:"biquad",properties:{input:null},calculateCoefficients:function(){switch(b){case"LP":var e=2*Math.PI*d/g,t=Math.sin(e),i=Math.cos(e),n=t/(2*m);c=(1-i)/2,l=1-i,p=c,a0=1+n,f=-2*i,h=1-n;break;case"HP":var e=2*Math.PI*d/g,t=Math.sin(e),i=Math.cos(e),n=t/(2*m);c=(1+i)/2,l=-(1+i),p=c,a0=1+n,f=-2*i,h=1-n;break;case"BP":var e=2*Math.PI*d/g,t=Math.sin(e),i=Math.cos(e),r=Math.log(2)/2*m*e/t,n=t*(Math.exp(r)-Math.exp(-r))/2;c=n,l=0,p=-n,a0=1+n,f=-2*i,h=1-n;break;default:return}c/=a0,l/=a0,p/=a0,f/=a0,h/=a0},callback:function(b){var d=isNaN(b)?2:1,m=0,g=0,y=1===d?b:b[0];return m=c*y+l*e+p*t-f*i-h*n,t=e,e=y,n=i,i=m,2===d&&(inR=b[1],g=c*inR+l*r+p*o-f*s-h*a,o=r,r=inR,a=s,s=g,u[0]=m,u[1]=g),1===d?m:u}}).init(),Object.defineProperties(this,{mode:{get:function(){return b},set:function(e){b=e,this.calculateCoefficients()}},cutoff:{get:function(){return d},set:function(e){d=e,this.calculateCoefficients()}},Q:{get:function(){return m},set:function(e){m=e,this.calculateCoefficients()}}}),this.processProperties(arguments),this.calculateCoefficients()},Gibberish.Biquad.prototype=Gibberish._effect,Gibberish.Flanger=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=(new Gibberish.Sine).callback,n=Gibberish.interpolate,r=-100,o=0;Gibberish.extend(this,{name:"flanger",properties:{input:0,rate:.25,feedback:0,amount:125,offset:125},callback:function(s,a,u,c){var l="number"==typeof s?1:2,p=r+i(a,.95*c);p>t?p-=t:0>p&&(p+=t);var f=n(e[0],p);return e[0][o]=1===l?s+f*u:s[0]+f*u,2===l?(s[0]+=f,f=n(e[1],p),e[1][o]=s[1]+f*u,s[1]+=f):s+=f,++o>=t&&(o=0),++r>=t&&(r=0),s}}).init().processProperties(arguments),r=-1*this.offset},Gibberish.Flanger.prototype=Gibberish._effect,Gibberish.Vibrato=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=(new Gibberish.Sine).callback,n=Gibberish.interpolate,r=-100,o=0;Gibberish.extend(this,{name:"vibrato",properties:{input:0,rate:5,amount:.5,offset:125},callback:function(s,a,u,c){var l="number"==typeof s?1:2,p=r+i(a,u*c-1);p>t?p-=t:0>p&&(p+=t);var f=n(e[0],p);return e[0][o]=1===l?s:s[0],2===l?(s[0]=f,f=n(e[1],p),e[1][o]=s[1],s[1]=f):s=f,++o>=t&&(o=0),++r>=t&&(r=0),s}}).init().processProperties(arguments),r=-1*this.offset},Gibberish.Vibrato.prototype=Gibberish._effect,Gibberish.BufferShuffler=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=0,n=0,r=0,o=0,s=0,a=Math.random,u=1,c=!1,l=!1,p=!1,f=Gibberish.interpolate,h=!1,b=1,d=!1,m=Gibberish.rndf,g=[0,0];Gibberish.extend(this,{name:"buffer_shuffler",properties:{input:0,chance:.25,rate:11025,length:22050,reverseChange:.5,pitchChance:.5,pitchMin:.25,pitchMax:2,wet:1,dry:0},callback:function(y,v,x,G,k,_,j,A,w,P){var q="number"==typeof y?1:2;s?++o%(G-400)===0&&(c=!1,l=!0,u=1,o=0):(e[0][n]=1===q?y:y[0],e[1][n]=1===q?y:y[1],n++,n%=t,d=0===n?1:d,r++,r%x==0&&a()<v&&(p=a()<k,s=!0,p||(i=n-G,0>i&&(i=t+i)),h=a()<_,h&&(b=m(j,A)),u=1,c=!0,l=!1)),i+=p?-1*b:b,0>i?i+=t:i>=t&&(i-=t);var S,M,C,O,R=f(e[0],i);return c?(u-=.0025,C=R*(1-u),S=1===q?C+y*u:C+y[0]*u,2===q&&(O=f(e[1],i),C=O*(1-u),M=1===q?S:C+y[1]*u),.0025>=u&&(c=!1)):l?(u-=.0025,C=R*u,S=1===q?C+y*u:C+y[0]*(1-u),2===q&&(O=f(e[1],i),C=O*u,M=C+y[1]*(1-u)),.0025>=u&&(l=!1,s=!1,p=!1,b=1,h=0)):1===q?S=s&&d?R*w+y*P:y:(O=f(e[1],i),S=s&&d?R*w+y[0]*P:y[0],M=s&&d?O*w+y[1]*P:y[1]),g=[S,M],1===q?S:g}}).init().processProperties(arguments)},Gibberish.BufferShuffler.prototype=Gibberish._effect,Gibberish.AllPass=function(e){var t=-1,i=new Float32Array(e||500),n=i.length;Gibberish.extend(this,{name:"allpass",properties:{input:0},callback:function(e){t=++t%n;var r=i[t],o=-1*e+r;return i[t]=e+.5*r,o}})},Gibberish.Comb=function(e){var t=new Float32Array(e||1200),i=t.length,n=0,r=0;Gibberish.extend(this,{name:"comb",properties:{input:0,feedback:.84,damping:.2},callback:function(e,o,s){var a=++n%i,u=t[a];return r=u*(1-s)+r*s,t[a]=e+r*o,u}})},Gibberish.Reverb=function(){var e={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.4,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},t=.84,i=[],n=[],r=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,properties:{input:0,wet:.5,dry:.55,roomSize:.84,damping:.5},callback:function(e,t,o,s,a){for(var u="object"==typeof e?2:1,c=1===u?e:e[0]+e[1],l=.015*c,p=l,f=0;8>f;f++){var h=i[f](l,.98*s,.4*a);p+=h}for(var f=0;4>f;f++)p=n[f](p);return r[0]=r[1]=c*o+p*t,r}}).init().processProperties(arguments),this.setFeedback=function(e){t=e};for(var o=0;8>o;o++)i.push(new Gibberish.Comb(e.combTuning[o]).callback);for(var o=0;4>o;o++)n.push(new Gibberish.AllPass(e.allPassTuning[o],e.allPassFeedback).callback)},Gibberish.Reverb.prototype=Gibberish._effect,Gibberish.StereoReverb=function(){var e={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.4,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},t=.84,i=[],n=[],r=[],o=[],s=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,properties:{input:0,wet:.5,dry:.55,roomSize:.84,damping:.5},callback:function(e,t,a,u,c){for(var l="object"==typeof e?2:1,p=e[0],f=1===l?p:e[1],h=outL=.015*p,b=outR=.015*f,d=0;8>d;d++)outL+=i[d](h,.98*u,.4*c),outR+=n[d](b,.98*u,.4*c);for(var d=0;4>d;d++)outL=r[d](outL),outR=o[d](outR);return s[0]=p*a+outL*t,s[1]=f*a+outR*t,s}}).init().processProperties(arguments),this.setFeedback=function(e){t=e};for(var a=0;8>a;a++)i.push(new Gibberish.Comb(e.combTuning[a]).callback),n.push(new Gibberish.Comb(e.combTuning[a]).callback);for(var a=0;4>a;a++)r.push(new Gibberish.AllPass(e.allPassTuning[a],e.allPassFeedback).callback),o.push(new Gibberish.AllPass(e.allPassTuning[a],e.allPassFeedback).callback)},Gibberish.StereoReverb.prototype=Gibberish._effect,Gibberish.Granulator=function(e){var t=[];buffer=null,interpolate=Gibberish.interpolate,panner=Gibberish.makePanner(),bufferLength=0,debug=0,write=0,self=this,out=[0,0],_out=[0,0],rndf=Gibberish.rndf,numberOfGrains=e.numberOfGrains||20,Gibberish.extend(this,{name:"granulator",bufferLength:88200,reverse:!0,spread:.5,properties:{speed:1,speedMin:-0,speedMax:0,grainSize:1e3,position:.5,positionMin:0,positionMax:0,amp:.2,fade:.1,pan:0,shouldWrite:!1},setBuffer:function(e){buffer=e,bufferLength=e.length},callback:function(e,i,n,r,o,s,a,u,c,l){for(var p=0;numberOfGrains>p;p++){var f=t[p];if(f._speed>0){f.pos>f.end&&(f.pos=(a+rndf(o,s))*buffer.length,f.start=f.pos,f.end=f.start+r,f._speed=e+rndf(i,n),f._speed=f._speed<.1?.1:f._speed,f._speed=f._speed<.1&&f._speed>0?.1:f._speed,f._speed=f._speed>-.1&&f._speed<0?-.1:f._speed,f.fadeAmount=f._speed*c*r,f.pan=rndf(-1*self.spread,self.spread));for(var h=f.pos;h>buffer.length;)h-=buffer.length;for(;0>h;)h+=buffer.length;var b=interpolate(buffer,h);b*=f.pos<f.fadeAmount+f.start?(f.pos-f.start)/f.fadeAmount:1,b*=f.pos>f.end-f.fadeAmount?(f.end-f.pos)/f.fadeAmount:1}else{f.pos<f.end&&(f.pos=(a+rndf(o,s))*buffer.length,f.start=f.pos,f.end=f.start-r,f._speed=e+rndf(i,n),f._speed=f._speed<.1&&f._speed>0?.1:f._speed,f._speed=f._speed>-.1&&f._speed<0?-.1:f._speed,f.fadeAmount=f._speed*c*r);for(var h=f.pos;h>buffer.length;)h-=buffer.length;for(;0>h;)h+=buffer.length;var b=interpolate(buffer,h);b*=f.pos>f.start-f.fadeAmount?(f.start-f.pos)/f.fadeAmount:1,b*=f.pos<f.end+f.fadeAmount?(f.end-f.pos)/f.fadeAmount:1}_out=panner(b*u,f.pan,_out),out[0]+=_out[0],out[1]+=_out[1],f.pos+=f._speed}return panner(out,l,out)}}).init().processProperties(arguments);for(var i=0;numberOfGrains>i;i++)t[i]={pos:self.position+Gibberish.rndf(self.positionMin,self.positionMax),_speed:self.speed+Gibberish.rndf(self.speedMin,self.speedMax)},t[i].start=t[i].pos,t[i].end=t[i].pos+self.grainSize,t[i].fadeAmount=t[i]._speed*self.fade*self.grainSize,t[i].pan=Gibberish.rndf(-1*self.spread,self.spread);"undefined"!=typeof e.buffer&&(buffer=e.buffer,bufferLength=buffer.length)},Gibberish.Granulator.prototype=Gibberish._effect,Gibberish.synth=function(){this.type="oscillator",this.oscillatorInit=function(){this.fx=new Array2,this.fx.parent=this}},Gibberish.synth.prototype=new Gibberish.ugen,Gibberish._synth=new Gibberish.synth,Gibberish.Synth=function(e){this.name="synth",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,glide:.15,amp:.25,channels:2,pan:0,sr:Gibberish.context.sampleRate},this.note=function(n,r){if(0!==r){if("object"!=typeof this.frequency){if(t&&n===l&&e.requireReleaseTrigger)return this.releaseTrigger=1,void(l=null);this.frequency=l=n,this.releaseTrigger=0,"object"==typeof n&&Gibberish.dirty(this)}else this.frequency[0]=l=n,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof r&&(this.amp=r),i.run()}else this.releaseTrigger=1},e=e||{};var t="undefined"==typeof e.useADSR?!1:e.useADSR,i=t?new Gibberish.ADSR:new Gibberish.AD,n=i.getState,r=i.callback,o=new Gibberish.PWM,s=o.callback,a=(new Gibberish.OnePole).callback,u=Gibberish.makePanner(),c=this,l=0,p=[0,0];i.requireReleaseTrigger=e.requireReleaseTrigger||!1,this.callback=function(e,i,o,l,f,h,b,d,m,g,y,v,x,G){g=g>=1?.99999:g,e=a(e,1-g,g);var k,_;return t?(k=r(o,l,f,h,b,d,m),m&&(c.releaseTrigger=0),n()<4?(_=s(e,1,i,G)*k*y,1===v?_:u(_,x,p)):(_=p[0]=p[1]=0,1===v?_:p)):n()<2?(k=r(o,l),_=s(e,1,i,G)*k*y,1===v?_:u(_,x,p)):(_=p[0]=p[1]=0,1===v?_:p)},this.getEnv=function(){return i},this.getOsc=function(){return o},this.setOsc=function(e){o=e,s=o.callback};var f="PWM";Object.defineProperty(this,"waveform",{get:function(){return f},set:function(e){this.setOsc(new Gibberish[e])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth.prototype=Gibberish._synth,Gibberish.PolySynth=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth",maxVoices:5,voiceCount:0,frequencies:[],_frequency:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,pulsewidth:.5,waveform:"PWM"},note:function(e,t){var i=this.frequencies.indexOf(e),n=i>-1?i:this.voiceCount++,r=this.children[n];r.note(e,t),-1===i?(this.frequencies[n]=e,this._frequency=e,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[n]},initVoices:function(){for(var e=0;e<this.maxVoices;e++){var t={waveform:this.waveform,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,pulsewidth:this.pulsewidth,channels:2,amp:1,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1},i=new Gibberish.Synth(t).connect(this);this.children.push(i)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Synth2=function(e){this.name="synth2",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,cutoff:.25,resonance:3.5,useLowPassFilter:!0,glide:.15,amp:.25,channels:1,pan:0,sr:Gibberish.context.sampleRate},this.note=function(n,r){if(0!==r){if("object"!=typeof this.frequency){if(t&&n===p&&e.requireReleaseTrigger)return this.releaseTrigger=1,void(p=null);this.frequency=p=n,this.releaseTrigger=0,"object"==typeof n&&Gibberish.dirty(this)}else this.frequency[0]=p=n,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof r&&(this.amp=r),i.run()}else this.releaseTrigger=1},e=e||{};var t="undefined"==typeof e.useADSR?!1:e.useADSR,i=t?new Gibberish.ADSR:new Gibberish.AD,n=i.getState,r=i.callback,o=new Gibberish.PWM,s=o.callback,a=new Gibberish.Filter24,u=a.callback,c=(new Gibberish.OnePole).callback,l=Gibberish.makePanner(),p=0,f=this,h=[0,0];i.requireReleaseTrigger=e.requireReleaseTrigger||!1,this.callback=function(e,i,o,a,p,b,d,m,g,y,v,x,G,k,_,j,A){G=G>=1?.99999:G,e=c(e,1-G,G);var w,P;return t?(w=r(o,a,p,b,d,m,g),g&&(f.releaseTrigger=0),n()<4?(P=u(s(e,.15,i,A),y*w,v,x)*w*k,1===_?P:l(P,j,h)):(P=h[0]=h[1]=0,1===_?P:h)):n()<2?(w=r(o,a),P=u(s(e,.15,i,A),y*w,v,x)*w*k,1===_?P:l(P,j,h)):(P=h[0]=h[1]=0,1===_?P:h)},this.getUseADSR=function(){return t},this.getEnv=function(){return i},this.getOsc=function(){return o},this.setOsc=function(e){o=e,s=o.callback};var b="PWM";Object.defineProperty(this,"waveform",{get:function(){return b},set:function(e){this.setOsc(new Gibberish[e])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth2.prototype=Gibberish._synth,Gibberish.PolySynth2=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth2",maxVoices:5,voiceCount:0,frequencies:[],_frequency:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,pulsewidth:.5,resonance:3.5,cutoff:.25,useLowPassFilter:!0,waveform:"PWM"},note:function(e,t){var i=this.frequencies.indexOf(e),n=i>-1?i:this.voiceCount++,r=this.children[n];r.note(e,t),-1===i?(this.frequencies[n]=e,this._frequency=e,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[n]},initVoices:function(){this.dirty=!0;for(var e=0;e<this.maxVoices;e++){var t={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,pulsewidth:this.pulsewidth,channels:2,amp:1,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1},i=new Gibberish.Synth2(t).connect(this);this.children.push(i)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.FMSynth=function(e){this.name="fmSynth",this.properties={frequency:0,cmRatio:2,index:5,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,releaseTrigger:0,glide:.15,amp:.25,channels:2,pan:0},this.note=function(n,r){if(0!==r){if("object"!=typeof this.frequency){if(t&&n===p&&e.requireReleaseTrigger)return this.releaseTrigger=1,void(p=null);this.frequency=p=n,this.releaseTrigger=0,"object"==typeof n&&Gibberish.dirty(this)}else this.frequency[0]=p=n,this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof r&&(this.amp=r),i.run()}else this.releaseTrigger=1},e=e||{};var t="undefined"==typeof e.useADSR?!1:e.useADSR,i=t?new Gibberish.ADSR:new Gibberish.AD,n=i.getState,r=i.callback,o=(new Gibberish.Sine).callback,s=(new Gibberish.Sine).callback,a=(new Gibberish.OnePole).callback,u=Gibberish.makePanner(),c=[0,0],l=this,p=0;i.requireReleaseTrigger=e.requireReleaseTrigger||!1,this.callback=function(e,i,p,f,h,b,d,m,g,y,v,x,G,k){var _,j,A;return v>=1&&(v=.9999),e=a(e,1-v,v),t?(_=r(f,h,b,d,m,g,y),y&&(l.releaseTrigger=0),n()<4?(A=s(e*i,e*p)*_,j=o(e+A,1)*_*x,1===G?j:u(j,k,c)):(j=c[0]=c[1]=0,1===G?j:c)):n()<2?(_=r(f,h),A=s(e*i,e*p)*_,j=o(e+A,1)*_*x,1===G?j:u(j,k,c)):(j=c[0]=c[1]=0,1===G?j:c)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.FMSynth.prototype=Gibberish._synth,Gibberish.PolyFM=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polyfm",maxVoices:5,voiceCount:0,children:[],frequencies:[],_frequency:0,polyProperties:{glide:0,attack:22050,decay:22050,sustain:22050,release:22050,attackLevel:1,sustainLevel:.5,index:5,cmRatio:2},note:function(e,t){var i=this.frequencies.indexOf(e),n=i>-1?i:this.voiceCount++,r=this.children[n];r.note(e,t),-1===i?(this.frequencies[n]=e,this._frequency=e,this.voiceCount>=this.maxVoices&&(this.voiceCount=0)):delete this.frequencies[n]},initVoices:function(){for(var e=0;e<this.maxVoices;e++){var t={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release,attackLevel:this.attackLevel,sustainLevel:this.sustainLevel,cmRatio:this.cmRatio,index:this.index,channels:2,useADSR:this.useADSR||!1,requireReleaseTrigger:this.requireReleaseTrigger||!1,amp:1},i=new Gibberish.FMSynth(t);i.connect(this),this.children.push(i)}}}),this.amp=1/this.maxVoices,this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices,this.useADSR="undefined"!=typeof arguments[0].useADSR?arguments[0].useADSR:!1,this.requireReleaseTrigger="undefined"!=typeof arguments[0].requireReleaseTrigger?arguments[0].requireReleaseTrigger:!1),Gibberish.polyInit(this),this.initVoices(),this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Sampler=function(){function e(e){Gibberish.context.decodeAudioData(e,function(e){o=e.getChannelData(0),a.length=t=a.end=s=o.length,a.isPlaying=!0,a.buffers[a.file]=o,console.log("sample loaded | ",a.file," | length | ",s),Gibberish.audioFiles[a.file]=o,a.onload&&a.onload(),0!==a.playOnLoad&&a.note(a.playOnLoad),a.isLoaded=!0},function(e){console.log("Error decoding file",e)})}var t=1,i=Gibberish.interpolate,n=Gibberish.makePanner(),r=[0,0],o=null,s=1,a=this;if(Gibberish.extend(this,{name:"sampler",file:null,isLoaded:!1,playOnLoad:0,buffers:{},properties:{pitch:1,amp:1,isRecording:!1,isPlaying:!0,input:0,length:0,start:0,end:1,loops:0,pan:0},_onload:function(e){o=e.channels[0],s=e.length,a.length=s,a.end=s,a.length=t=s,a.isPlaying=!0,Gibberish.audioFiles[a.file]=o,a.buffers[a.file]=o,a.onload&&a.onload(),0!==a.playOnLoad&&a.note(a.playOnLoad),a.isLoaded=!0},switchBuffer:function(e){if("string"==typeof e)"undefined"!=typeof a.buffers[e]&&(o=a.buffers[e],s=a.end=a.length=o.length);else if("number"==typeof e){var t=Object.keys(a.buffers);if(0===t.length)return;o=a.buffers[t[e]],s=a.end=a.length=o.length}},floatTo16BitPCM:function(e,t,i){for(var n=0;n<i.length-1;n++,t+=2){var r=Math.max(-1,Math.min(1,i[n]));e.setInt16(t,0>r?32768*r:32767*r,!0)}},encodeWAV:function(){function e(e,t,i){for(var n=0;n<i.length;n++)e.setUint8(t+n,i.charCodeAt(n))}var t=this.getBuffer(),i=new ArrayBuffer(44+2*t.length),n=new DataView(i),r=Gibberish.context.sampleRate;return e(n,0,"RIFF"),n.setUint32(4,32+2*t.length,!0),e(n,8,"WAVE"),e(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,1,!0),n.setUint32(24,r,!0),n.setUint32(28,4*r,!0),n.setUint16(32,2,!0),n.setUint16(34,16,!0),e(n,36,"data"),n.setUint32(40,2*t.length,!0),this.floatTo16BitPCM(n,44,t),n},download:function(){var e=this.encodeWAV(),t=new Blob([e]),i=window.webkitURL.createObjectURL(t),n=window.document.createElement("a");n.href=i,n.download="output.wav";var r=document.createEvent("Event");r.initEvent("click",!0,!0),n.dispatchEvent(r)},note:function(e,i){switch(typeof e){case"number":this.pitch=e;break;case"function":this.pitch=e();break;case"object":this.pitch=Array.isArray(e)?e[0]:e}if("number"==typeof i&&(this.amp=i),null!==this.function){this.isPlaying=!0;var n;switch(typeof this.pitch){case"number":n=this.pitch;break;case"function":n=this.pitch.getValue?this.pitch.getValue():this.pitch();break;case"object":n=Array.isArray(this.pitch)?this.pitch[0]:this.pitch.getValue?this.pitch.getValue():this.pitch.input.getValue(),"function"==typeof n&&(n=n())}t=n>0?this.start:this.end,Gibberish.dirty(this)}},getBuffer:function(){return o},setBuffer:function(e){o=e},getPhase:function(){return t},setPhase:function(e){t=e},getNumberOfBuffers:function(){return Object.keys(a.buffers).length-1},callback:function(e,s,a,u,c,l,p,f,h,b){var d=0;return t+=e,f>t&&t>0?(e>0?d=null!==o&&u?i(o,t):0:t>p?d=null!==o&&u?i(o,t):0:t=h?f:t,n(d*s,b,r)):(t=h&&e>0?p:t,t=h&&0>e?f:t,r[0]=r[1]=d,r)}}).init().oscillatorInit().processProperties(arguments),"undefined"!=typeof arguments[0]&&("string"==typeof arguments[0]?(this.file=arguments[0],this.pitch=0):"object"==typeof arguments[0]&&arguments[0].file&&(this.file=arguments[0].file)),"undefined"!=typeof Gibberish.audioFiles[this.file])o=Gibberish.audioFiles[this.file],this.end=this.bufferLength=o.length,this.buffers[this.file]=o,t=this.bufferLength,Gibberish.dirty(this),this.onload&&this.onload();else if(null!==this.file){var e,u=new XMLHttpRequest;u.open("GET",this.file,!0),u.responseType="arraybuffer",u.onload=function(){e(this.response)},u.send(),console.log("now loading sample",a.file),u.onerror=function(e){console.error("Sampler file loading error",e)}}else"undefined"!=typeof this.buffer&&(this.isLoaded=!0,o=this.buffer,this.end=this.bufferLength=o.length||88200,t=this.bufferLength,arguments[0]&&arguments[0].loops&&(this.loops=1),Gibberish.dirty(this),this.onload&&this.onload())},Gibberish.Sampler.prototype=Gibberish._oscillator,Gibberish.Sampler.prototype.record=function(e,t){this.isRecording=!0;var i=this;return this.recorder=new Gibberish.Record(e,t,function(){i.setBuffer(this.getBuffer()),i.end=bufferLength=i.getBuffer().length,i.setPhase(i.end),i.isRecording=!1}).record(),this},Gibberish.MonoSynth=function(){Gibberish.extend(this,{name:"monosynth",properties:{attack:1e4,decay:1e4,cutoff:.2,resonance:2.5,amp1:1,amp2:1,amp3:1,filterMult:.3,isLowPass:!0,pulsewidth:.5,amp:.6,detune2:.01,detune3:-.01,octave2:1,octave3:-1,glide:0,pan:0,frequency:0,channels:2},waveform:"Saw3",note:function(e,n){"undefined"!=typeof n&&0!==n&&(this.amp=n),0!==n&&("object"!=typeof this.frequency?this.frequency=e:(this.frequency[0]=e,Gibberish.dirty(this)),i()>0&&t.run())},_note:function(e,i){if("object"!=typeof this.frequency){if(useADSR&&e===lastFrequency&&0===i)return this.releaseTrigger=1,void(lastFrequency=null);0!==i&&(this.frequency=lastFrequency=e),this.releaseTrigger=0}else 0!==i&&(this.frequency[0]=lastFrequency=e),this.releaseTrigger=0,Gibberish.dirty(this);"undefined"!=typeof i&&0!==i&&(this.amp=i),0!==i&&t.run()}});var e=this.waveform;Object.defineProperty(this,"waveform",{get:function(){return e},set:function(t){e!==t&&(e=t,o=(new Gibberish[t]).callback,s=(new Gibberish[t]).callback,a=(new Gibberish[t]).callback)}});var t=new Gibberish.AD(this.attack,this.decay),i=t.getState,n=t.callback,r=(new Gibberish.Filter24).callback,o=new Gibberish[this.waveform](this.frequency,this.amp1).callback,s=new Gibberish[this.waveform](this.frequency2,this.amp2).callback,a=new Gibberish[this.waveform](this.frequency3,this.amp3).callback,u=(new Gibberish.OnePole).callback,c=Gibberish.makePanner(),l=[0,0];this.envelope=t,this.callback=function(e,t,p,f,h,b,d,m,g,y,v,x,G,k,_,j,A,w,P){if(i()<2){j>=1&&(j=.9999),w=u(w,1-j,j);var q=w;if(k>0)for(var S=0;k>S;S++)q*=2;else if(0>k)for(var S=0;S>k;S--)q/=2;var M=w;if(_>0)for(var S=0;_>S;S++)M*=2;else if(0>_)for(var S=0;S>_;S--)M/=2;q+=x>0?(2*w-w)*x:(w-w/2)*x,M+=G>0?(2*w-w)*G:(w-w/2)*G;var C=o(w,h,y)+s(q,b,y)+a(M,d,y),O=n(e,t),R=r(C,p+m*O,f,g,1)*O;return R*=v,l[0]=l[1]=R,1===P?l:c(R,A,l)}return l[0]=l[1]=0,l},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.MonoSynth.prototype=Gibberish._synth,Gibberish.Binops={"export":function(e){Gibberish.export("Binops",e||window)},operator:function(){var e=new Gibberish.ugen,t=arguments[0],i=Array.prototype.slice.call(arguments,1);e.name="op",e.properties={};for(var n=0;n<i.length;n++)e.properties[n]=i[n];return e.init.apply(e,i),e.codegen=function(){var e,i="( ";if("undefined"!=typeof Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];e=Object.keys(this.properties);for(var n=!1,r=0;r<e.length;r++)if(n)n=!1;else{var o="object"==typeof this[r];i+=o?this[r].codegen():this[r],"*"!==t&&"/"!==t||1!==this[r+1]?r<e.length-1&&(i+=" "+t+" "):n=!0}return i+=" )",this.codeblock=i,i},e.valueOf=function(){return e.codegen()},e},Add:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("+"),Gibberish.Binops.operator.apply(null,e)},Sub:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("-"),Gibberish.Binops.operator.apply(null,e)},Mul:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("*"),Gibberish.Binops.operator.apply(null,e)},Div:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("/"),Gibberish.Binops.operator.apply(null,e)},Mod:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("%"),Gibberish.Binops.operator.apply(null,e)},Abs:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"abs",properties:{},callback:Math.abs.bind(t)};return t.__proto__=new Gibberish.ugen,t.properties[0]=e[0],t.init(),t},Sqrt:function(){var e=(Array.prototype.slice.call(arguments,0),{name:"sqrt",properties:{},callback:Math.sqrt.bind(e)});return e.__proto__=new Gibberish.ugen,e.properties[i]=arguments[0],e.init(),e},Pow:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"pow",properties:{},callback:Math.pow.bind(t)};t.__proto__=new Gibberish.ugen;for(var i=0;i<e.length;i++)t.properties[i]=e[i];return t.init(),console.log(t.callback),t},Clamp:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"clamp",properties:{input:0,min:0,max:1},callback:function(e,t,i){return t>e?e=t:e>i&&(e=i),e}};return t.__proto__=new Gibberish.ugen,t.init(),t.processProperties(e),t},Merge:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"merge",properties:{},callback:function(e){return e[0]+e[1]}};t.__proto__=new Gibberish.ugen;for(var i=0;i<e.length;i++)t.properties[i]=e[i];return t.init(),t},Map:function(e,t,i,n,r,o,s){var a=Math.pow,u=0,c=0,l={name:"map",properties:{input:e,outputMin:t,outputMax:i,inputMin:n,inputMax:r,curve:o||u,wrap:s||!1},callback:function(e,t,i,n,r,o,s){var u,l=i-t,p=r-n,f=(e-n)/p;return f>1?f=s?f%1:1:0>f&&(f=s?1+f%1:0),u=0===o?t+f*l:t+a(f,1.5)*l,c=u,u},getValue:function(){return c},invert:function(){var e=l.outputMin;l.outputMin=l.outputMax,l.outputMax=e}};return l.__proto__=new Gibberish.ugen,l.init(),l}},Gibberish.Time={bpm:120,"export":function(e){Gibberish.export("Time",e||window)},ms:function(e){return e*Gibberish.context.sampleRate/1e3},seconds:function(e){return e*Gibberish.context.sampleRate},beats:function(e){return function(){var t=Gibberish.context.sampleRate/(Gibberish.Time.bpm/60);return t*e}}},Gibberish.Sequencer2=function(){var e=this,t=0;Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},properties:{rate:1,isRunning:!1,nextTime:0},offset:0,name:"seq",callback:function(i,n,r){if(n){if(t>=r){if(null!==e.values){if(e.target){var o=e.values[e.valuesIndex++];
"function"==typeof o&&(o=o()),"function"==typeof e.target[e.key]?e.target[e.key](o):e.target[e.key]=o}else"function"==typeof e.values[e.valuesIndex]&&e.values[e.valuesIndex++]();e.valuesIndex>=e.values.length&&(e.valuesIndex=0)}else if(null!==e.keysAndValues)for(var s in e.keysAndValues){var a=e.counts[s]++,o=e.keysAndValues[s][a];"function"==typeof o&&(o=o()),"function"==typeof e.target[s]?e.target[s](o):e.target[s]=o,e.counts[s]>=e.keysAndValues[s].length&&(e.counts[s]=0),e.chose&&e.chose(s,a)}else"function"==typeof e.target[e.key]&&e.target[e.key]();if(t-=r,Array.isArray(e.durations)){var u=e.durations[e.durationsIndex++];e.nextTime="function"==typeof u?u():u,e.chose&&e.chose("durations",e.durationsIndex-1),e.durationsIndex>=e.durations.length&&(e.durationsIndex=0)}else{var u=e.durations;e.nextTime="function"==typeof u?u():u}return e.repeatTarget&&(e.repeatCount++,e.repeatCount===e.repeatTarget&&(e.isRunning=!1,e.repeatCount=0)),0}t+=i}return 0},start:function(e){return e||(t=0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(e){return this.repeatTarget=e,this},shuffle:function(){for(i in this.keysAndValues)this.shuffleArray(this.keysAndValues[i])},shuffleArray:function(e){for(var t,i,n=e.length;n;t=parseInt(Math.random()*n),i=e[--n],e[n]=e[t],e[t]=i);}}),this.init(arguments),this.processProperties(arguments);for(var i in this.keysAndValues)this.counts[i]=0;this.oscillatorInit(),t+=this.offset,this.connect()},Gibberish.Sequencer2.prototype=Gibberish._oscillator,Gibberish.Sequencer=function(){Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,phase:0,isRunning:!1,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},offset:0,name:"seq",tick:function(){if(this.isRunning){if(this.phase>=this.nextTime){if(null!==this.values){if(this.target){var e=this.values[this.valuesIndex++];if("function"==typeof e)try{e=e()}catch(t){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+e.toString()),this.values.splice(this.valuesIndex-1,1),this.valuesIndex--}"function"==typeof this.target[this.key]?this.target[this.key](e):this.target[this.key]=e}else if("function"==typeof this.values[this.valuesIndex])try{this.values[this.valuesIndex++]()}catch(t){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+this.values[this.valuesIndex-1].toString()),this.values.splice(this.valuesIndex-1,1),this.valuesIndex--}this.valuesIndex>=this.values.length&&(this.valuesIndex=0)}else if(null!==this.keysAndValues)for(var i in this.keysAndValues){var n="function"==typeof this.keysAndValues[i].pick?this.keysAndValues[i].pick():this.counts[i]++,e=this.keysAndValues[i][n];if("function"==typeof e)try{e=e()}catch(t){console.error("ERROR: Can't execute function triggered by Sequencer:\n"+e.toString()),this.keysAndValues[i].splice(n,1),"function"!=typeof this.keysAndValues[i].pick&&this.counts[i]--}"function"==typeof this.target[i]?this.target[i](e):this.target[i]=e,this.counts[i]>=this.keysAndValues[i].length&&(this.counts[i]=0)}else"function"==typeof this.target[this.key]&&this.target[this.key]();if(this.phase-=this.nextTime,Array.isArray(this.durations)){var r="function"==typeof this.durations.pick?this.durations[this.durations.pick()]:this.durations[this.durationsIndex++];this.nextTime="function"==typeof r?r():r,this.durationsIndex>=this.durations.length&&(this.durationsIndex=0)}else{var r=this.durations;this.nextTime="function"==typeof r?r():r}return void(this.repeatTarget&&(this.repeatCount++,this.repeatCount===this.repeatTarget&&(this.isRunning=!1,this.repeatCount=0)))}this.phase++}},start:function(e){return e||(this.phase=this.offset),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(e){return this.repeatTarget=e,this},shuffle:function(){for(e in this.keysAndValues)this.shuffleArray(this.keysAndValues[e])},shuffleArray:function(e){for(var t,i,n=e.length;n;t=parseInt(Math.random()*n),i=e[--n],e[n]=e[t],e[t]=i);},disconnect:function(){var e=Gibberish.sequencers.indexOf(this);Gibberish.sequencers.splice(e,1),this.isConnected=!1},connect:function(){return-1===Gibberish.sequencers.indexOf(this)&&Gibberish.sequencers.push(this),this.isConnected=!0,this}});for(var e in arguments[0])this[e]=arguments[0][e];for(var e in this.keysAndValues)this.counts[e]=0;this.connect(),this.phase+=this.offset},Gibberish.Sequencer.prototype=Gibberish._oscillator,Gibberish.PolySeq=function(){var e=this,t=0,i=function(e,t){return t>e?-1:e>t?1:0};Gibberish.extend(this,{seqs:[],timeline:{},playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!1,properties:{rate:1,isRunning:!1,nextTime:0},offset:0,autofire:[],name:"polyseq",getPhase:function(){return t},setPhase:function(e){t=e},adjustPhase:function(e){t+=e},timeModifier:null,add:function(i){i.valuesIndex=i.durationsIndex=0,null===i.durations?(i.autofire=!0,e.autofire.push(i)):(e.seqs.push(i),"undefined"!=typeof e.timeline[t]?i.priority?e.timeline[t].unshift(i):e.timeline[t].push(i):e.timeline[t]=[i],e.nextTime=t),!e.scale||"frequency"!==i.key&&"note"!==i.key||e.applyScale&&e.applyScale(),i.shouldStop=!1},callback:function(n,r,o){var s;if(r){if(t>=o){var a=e.timeline[o],u=t-o;if("undefined"==typeof a)return;for(var c=0;c<a.length;c++){var l=a[c];if(!l.shouldStop){var p=l.values.pick?l.values.pick():l.valuesIndex++%l.values.length,f="function"==typeof l.values?l.values():l.values[p];if("function"==typeof f&&(f=f()),l.target&&("function"==typeof l.target[l.key]?l.target[l.key](f):l.target[l.key]=f),e.chose&&e.chose(l.key,p),Array.isArray(l.durations)){var p=l.durations.pick?l.durations.pick():l.durationsIndex++,h="function"==typeof l.durations?l.durations():l.durations[p];s="function"==typeof h?h():h,"function"!=typeof l.durations&&l.durationsIndex>=l.durations.length&&(l.durationsIndex=0),e.chose&&e.chose("durations",p)}else{var h="function"==typeof l.durations?l.durations():l.durations;s="function"==typeof h?h():h}var b;b=null!==e.timeModifier?e.timeModifier(s)+t:s+t,b-=u,s-=u,"undefined"==typeof e.timeline[b]?e.timeline[b]=[l]:l.priority?e.timeline[b].unshift(l):e.timeline[b].push(l)}}for(var c=0,d=e.autofire.length;d>c;c++){var l=e.autofire[c];if(!l.shouldStop){var p=l.values.pick?l.values.pick():l.valuesIndex++%l.values.length,f=l.values[p];"function"==typeof f&&(f=f()),l.target&&("function"==typeof l.target[l.key]?l.target[l.key](f):l.target[l.key]=f),e.chose&&e.chose(l.key,p)}}delete e.timeline[o];var m=Object.keys(e.timeline),g=m.length;if(g>1){for(var y=0;g>y;y++)m[y]=parseFloat(m[y]);m=m.sort(i),e.nextTime=m[0]}else e.nextTime=parseFloat(m[0])}t+=n}return 0},start:function(e,i){if(e&&this.offset){t=0,this.nextTime=this.offset;var n=""+this.offset;this.timeline={},this.timeline[n]=[];for(var r=0;r<this.seqs.length;r++){var o=this.seqs[r];o.valuesIndex=o.durationsIndex=o.shouldStop=0,this.timeline[n].push(o)}}else{t=0,this.nextTime=0,this.timeline={0:[]};for(var r=0;r<this.seqs.length;r++){var o=this.seqs[r];o.valuesIndex=o.durationsIndex=o.shouldStop=0,this.timeline[0].push(o)}}return this.isConnected||(this.connect(Gibberish.Master,i),this.isConnected=!0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this.isConnected&&(this.disconnect(),this.isConnected=!1),this},repeat:function(e){return this.repeatTarget=e,this},shuffle:function(e){if("undefined"!=typeof e)for(var t=0;t<this.seqs.length;t++)this.seqs[t].key===e&&this.shuffleArray(this.seqs[t].values);else for(var t=0;t<this.seqs.length;t++)this.shuffleArray(this.seqs[t].values)},shuffleArray:function(e){for(var t,i,n=e.length;n;t=parseInt(Math.random()*n),i=e[--n],e[n]=e[t],e[t]=i);}}),this.init(arguments),this.processProperties(arguments),this.oscillatorInit()},Gibberish.PolySeq.prototype=Gibberish._oscillator;var _hasInput=!1;return"object"==typeof navigator&&(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),Gibberish.Input=function(){var e=[];_hasInput||createInput(),this.type=this.name="input",this.fx=new Array2,this.fx.parent=this,this.properties={input:"input",amp:.5,channels:1},this.callback=function(t,i,n){return 1===n?e=t*i:(e[0]=t[0]*i,e[1]=t[1]*i),e},this.init(arguments),this.processProperties(arguments)},Gibberish.Input.prototype=new Gibberish.ugen,Gibberish.Kick=function(){var e=!1,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,n=.2,r=.8;Gibberish.extend(this,{name:"kick",properties:{pitch:50,__decay:20,__tone:1e3,amp:2,sr:Gibberish.context.sampleRate},callback:function(n,r,o,s,a){var u=e?60:0;return u=t(u,n,r,2,a),u=i(u,o,.5,0,a),u*=s,e=!1,u},note:function(t,i,n,r){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.decay=i),"number"==typeof n&&(this.tone=n),"number"==typeof r&&(this.amp=r),e=!0}}).init().oscillatorInit(),Object.defineProperties(this,{decay:{get:function(){return n},set:function(e){n=e>1?1:e,this.__decay=100*n}},tone:{get:function(){return r},set:function(e){r=e>1?1:e,this.__tone=220+1400*e}}}),this.processProperties(arguments)},Gibberish.Kick.prototype=Gibberish._oscillator,Gibberish.Conga=function(){var e=!1,t=(new Gibberish.SVF).callback;Gibberish.extend(this,{name:"conga",properties:{pitch:190,amp:2,sr:Gibberish.context.sampleRate},callback:function(i,n,r){var o=e?60:0;return o=t(o,i,50,2,r),o*=n,e=!1,o},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),e=!0}}).init().oscillatorInit(),this.processProperties(arguments)},Gibberish.Conga.prototype=Gibberish._oscillator,Gibberish.Clave=function(){var e=!1,t=new Gibberish.SVF,i=t.callback;Gibberish.extend(this,{name:"clave",properties:{pitch:2500,amp:1,sr:Gibberish.context.sampleRate},callback:function(t,n,r){var o=e?2:0;return o=i(o,t,5,2,r),o*=n,e=!1,o},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),e=!0}}).init().oscillatorInit(),this.bpf=t,this.processProperties(arguments)},Gibberish.Clave.prototype=Gibberish._oscillator,Gibberish.Tom=function(){var e=!1,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,n=new Gibberish.ExponentialDecay,r=n.callback,o=Math.random;Gibberish.extend(this,{name:"tom",properties:{pitch:80,amp:.5,sr:Gibberish.context.sampleRate},callback:function(n,s,a){var u,c=e?60:0;return c=t(c,n,30,2,a),u=16*o()-8,u=u>0?u:0,u*=r(.05,11025),u=i(u,120,.5,0,a),c+=u,c*=s,e=!1,c},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),n.trigger(),e=!0}}).init().oscillatorInit(),n.trigger(1),this.processProperties(arguments)},Gibberish.Tom.prototype=Gibberish._oscillator,Gibberish.Clap=function(){var e=new Gibberish.Biquad,t=e.callback,i=new Gibberish.Biquad,n=i.callback,r=new Gibberish.Biquad,o=r.callback,s=new Gibberish.ExponentialDecay,a=s.callback,u=new Gibberish.ExponentialDecay,c=u.callback,l=new Gibberish.Line,p=(l.callback,new Gibberish.Saw),f=p.callback,h=Math.random,b=1e3,d=2.5,m=.025,g=.9,y=1323,v=660,x=100;e.mode=i.mode="BP",r.mode="BP",r.cutoff=2400,e.cutoff=i.cutoff=1e3,e.Q=2,i.Q=1,Gibberish.extend(this,{name:"clap",properties:{amp:.5,sr:Gibberish.context.sampleRate},callback:function(e){var i,r,s=0;return i=4*h()-2,i=i>0?i:0,r=4*h()-2,r=r>0?r:0,s=n(t(i)),s*=c(g,v),r=o(f(x,r)*a(m,y)),s+=r,s*=e},note:function(e){"number"==typeof e&&(this.amp=e),u.trigger(),s.trigger(),l.setPhase(0),p.setPhase(0)}}).init().oscillatorInit(),this.getBPF=function(){return e},this.getBPF2=function(){return i},this.getBPF3=function(){return r},this.getLine=function(){return l},this.setEnvK=function(e,t,i,n){m=e,t&&(g=t),i&&(y=i),n&&(v=n)},this.setFreq=function(e){x=e},this.setRez=function(e){d=e},this.setCutoff=function(e){b=e},this.processProperties(arguments)},Gibberish.Clap.prototype=Gibberish._oscillator,Gibberish.Cowbell=function(){var e=new Gibberish.Square,t=new Gibberish.Square,i=e.callback,n=t.callback,r=new Gibberish.SVF({mode:2}),o=r.callback,s=new Gibberish.ExponentialDecay(.0025,10500),a=s.callback;Gibberish.extend(this,{name:"cowbell",properties:{amp:1,pitch:560,bpfFreq:1e3,bpfRez:3,decay:22050,decayCoeff:1e-4,sr:Gibberish.context.sampleRate},callback:function(e,t,r,s,u,c,l){var p;return p=i(t,1,1,0),p+=n(845,1,1,0),p=o(p,r,s,2,l),p*=a(c,u),p*=e},note:function(e){s.trigger(),e&&(this.decay=e)}}).init().oscillatorInit().processProperties(arguments),this.bpf=r,this.eg=s,s.trigger(1)},Gibberish.Cowbell.prototype=Gibberish._oscillator,Gibberish.Snare=function(){var e=(new Gibberish.SVF).callback,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,n=new Gibberish.ExponentialDecay(.0025,11025),r=n.callback,o=Math.random,s=0;Gibberish.extend(this,{name:"snare",properties:{cutoff:1e3,decay:11025,tune:0,snappy:.5,amp:1,sr:Gibberish.context.sampleRate},callback:function(n,a,u,c,l,p){var f,h,b=0,d=0;return b=r(.0025,a),b>.005&&(d=(2*o()-1)*b,d=i(d,n+1e3*u,.5,1,p),d*=c,d=d>0?d:0,s=b,f=e(s,180*(u+1),15,2,p),h=t(s,330*(u+1),15,2,p),d+=f,d+=.8*h,d*=l),d},note:function(e,t,i,r){"number"==typeof e&&(this.tune=e),"number"==typeof r&&(this.cutoff=r),"number"==typeof i&&(this.snappy=i),"number"==typeof t&&(this.amp=t),n.trigger()}}).init().oscillatorInit().processProperties(arguments),n.trigger(1)},Gibberish.Snare.prototype=Gibberish._oscillator,Gibberish.Hat=function(){{var e=new Gibberish.Square,t=new Gibberish.Square,i=new Gibberish.Square,n=new Gibberish.Square,r=new Gibberish.Square,o=new Gibberish.Square,s=e.callback,a=t.callback,u=i.callback,c=n.callback,l=r.callback,p=o.callback,f=new Gibberish.SVF({mode:2}),h=f.callback,b=new Gibberish.Filter24,d=b.callback,m=new Gibberish.ExponentialDecay(.0025,10500),g=m.callback,y=new Gibberish.ExponentialDecay(.1,7500);y.callback}Gibberish.extend(this,{name:"hat",properties:{amp:1,pitch:325,bpfFreq:7e3,bpfRez:2,hpfFreq:.975,hpfRez:0,decay:3500,decay2:3e3,sr:Gibberish.context.sampleRate},callback:function(e,t,i,n,r,o,f,b,m){var y;return y=s(t,1,.5,0),y+=a(1.4471*t,.75,1,0),y+=u(1.617*t,1,1,0),y+=c(1.9265*t,1,1,0),y+=l(2.5028*t,1,1,0),y+=p(2.6637*t,.75,1,0),y=h(y,i,n,2,m),y*=g(.001,f),y=d(y,r,o,0,1),y*=e},note:function(e,t){m.trigger(),y.trigger(),e&&(this.decay=e),t&&(this.decay2=t)}}).init().oscillatorInit().processProperties(arguments),this.bpf=f,this.hpf=b,m.trigger(1),y.trigger(1)},Gibberish.Hat.prototype=Gibberish._oscillator,function(){var e={Soundfont:{instruments:{}}},t=e.Soundfont;"object"==typeof window?window.GenMIDI=e:global.GenMIDI=e;var i=function(e,t){function i(i){console.log("COMPLETE",e);var n=document.createElement("script");n.innerHTML=i.srcElement?i.srcElement.responseText:i.target.responseText,document.querySelector("head").appendChild(n),t(n)}var n=new XMLHttpRequest;n.addEventListener("load",i,!1),n.addEventListener("error",function(e){console.log("SF load error",e)},!1),n.open("GET",e,!0),n.send()},n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(e){var t=e.length/4*3,i=new ArrayBuffer(t);return this.decode(e,i),i},decode:function(e,t){var i=this._keyStr.indexOf(e.charAt(e.length-1)),n=this._keyStr.indexOf(e.charAt(e.length-2)),r=e.length/4*3;64==i&&r--,64==n&&r--;var o,s,a,u,c,l,p,f,h=0,b=0;for(o=new Uint8Array(t?t:r),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),h=0;r>h;h+=3)c=this._keyStr.indexOf(e.charAt(b++)),l=this._keyStr.indexOf(e.charAt(b++)),p=this._keyStr.indexOf(e.charAt(b++)),f=this._keyStr.indexOf(e.charAt(b++)),s=c<<2|l>>4,a=(15&l)<<4|p>>2,u=(3&p)<<6|f,o[h]=s,64!=p&&(o[h+1]=a),64!=f&&(o[h+2]=u);return o}},r=function(e){var i=0,r=t[e.instrumentFileName];"undefined"==typeof t.instruments[e.instrumentFileName]&&(t.instruments[e.instrumentFileName]={}),e.buffers=t.instruments[e.instrumentFileName];for(var o in r)i++,!function(){var s=o,a=r[s].split(",")[1],u=n.decodeArrayBuffer(a);Gibberish.context.decodeAudioData(u,function(n){t.instruments[e.instrumentFileName][s]=n.getChannelData(0),i--,0>=i&&(console.log("Soundfont "+e.instrumentFileName+" is loaded."),e.isLoaded=!0,e.onload&&e.onload())},function(e){console.log("ERROR",e.err,arguments,s)})}()};Gibberish.SoundFont=function(e,n){return Gibberish.extend(this,{instrumentFileName:e,name:"soundfont",properties:{amp:1,pan:0},playing:[],buffers:{},onload:null,out:[0,0],isLoaded:!1,resourcePath:n||"./resources/soundfonts/",callback:function(e,t){for(var i=0,n=this.playing.length-1;n>=0;n--){var r=this.playing[n];i+=this.interpolate(r.buffer,r.phase),r.phase+=r.increment,r.phase>r.length&&this.playing.splice(this.playing.indexOf(r),1)}return this.panner(i*e,t,this.out)}.bind(this),note:function(e,t,i){this.isLoaded&&this.playing.push({buffer:this.buffers[e],phase:0,increment:isNaN(i)?1:1+i,length:this.buffers[e].length,amp:isNaN(t)?1:t})},interpolate:Gibberish.interpolate.bind(this),panner:Gibberish.makePanner()}).init().oscillatorInit(),"object"==typeof arguments[0]&&arguments[0].instrumentFileName&&(this.instrumentFileName=arguments[0].instrumentFileName),t.instruments[this.instrumentFileName]||"object"==typeof n?"object"==typeof n?(t[this.instrumentFileName]=n,r(this)):(this.buffers=t.instruments[this.instrumentFileName],this.isLoaded=!0,setTimeout(function(){this.onload&&this.onload()}.bind(this),0)):(console.log("DOWNLOADING SOUNDFONT"),i("resources/soundfonts/"+this.instrumentFileName+"-mp3.js",r.bind(null,this))),this},Gibberish.SoundFont.storage=t,Gibberish.SoundFont.prototype=Gibberish._oscillator}(),Gibberish.Vocoder=function(){var e=[],t=[],i=Math.abs,n=(Math.sqrt,[0,0]),r=[],o=[],s=128,a=[],u=[],c=[],l=0,p=arguments[3]||330,f=arguments[4]||3200,h=arguments[2]||16,b=arguments[5]||.15;this.name="vocoder",this.properties={carrier:arguments[0]||null,modulator:arguments[1]||null,amp:1,pan:0};for(var d=1200*Math.log(f/p)/Math.LN2,m=d/h,g=Math.pow(2,m/1200),y=p,v=0;h>v;v++)r[v]=new Gibberish.Biquad({mode:"BP",Q:b,cutoff:y}),e[v]=r[v].callback,o[v]=new Gibberish.Biquad({mode:"BP",Q:b,cutoff:y}),t[v]=o[v].callback,a[v]=[0],u[v]=0,c[v]=0,y*=g;this.callback=function(r,o,p){for(var f,b=(l+1)%s,d="number"!=typeof o?o[0]+o[1]:o,m="number"!=typeof r?r[0]+r[1]:r,g=0,y=0;h>y;y++)f=i(e[y](d)),u[y]+=f,u[y]-=a[y][l],a[y][l]=f,a[y][b]=a[y][b]?a[y][b]:0,c[y]=u[y]/s,g+=t[y](m)*c[y];return l=b,n[0]=n[1]=g*p*16,n},this.getEncoders=function(){return r},this.getDecoders=function(){return o},this.init(),this.oscillatorInit()},Gibberish.Vocoder.prototype=Gibberish._synth,Gibberish})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(require,module,exports){!function(){var freesound=module.exports={BASE_URI:"http://www.freesound.org/api",apiKey:"",debug:!1,_URI_SOUND:"/sounds/<sound_id>/",_URI_SOUND_ANALYSIS:"/sounds/<sound_id>/analysis/",_URI_SOUND_ANALYSIS_FILTER:"/sounds/<sound_id>/analysis/<filter>",_URI_SIMILAR_SOUNDS:"/sounds/<sound_id>/similar/",_URI_SEARCH:"/sounds/search/",_URI_CONTENT_SEARCH:"/sounds/content_search/",_URI_GEOTAG:"/sounds/geotag",_URI_USER:"/people/<user_name>/",_URI_USER_SOUNDS:"/people/<user_name>/sounds/",_URI_USER_PACKS:"/people/<user_name>/packs/",_URI_USER_BOOKMARKS:"/people/<username>/bookmark_categories",_URI_BOOKMARK_CATEGORY_SOUNDS:"/people/<username>/bookmark_categories/<category_id>/sounds",_URI_PACK:"/packs/<pack_id>/",_URI_PACK_SOUNDS:"/packs/<pack_id>/sounds/",_make_uri:function(e,t){for(var i in t)e=e.replace(/<[\w_]+>/,t[i]);return this.BASE_URI+e},_make_request:function(uri,success,error,params,wrapper){var fs=this;-1==uri.indexOf("?")&&(uri+="?"),uri=uri+"&api_key="+this.apiKey;for(var p in params)uri=uri+"&"+p+"="+params[p];var xhr;try{xhr=new XMLHttpRequest}catch(e){xhr=new ActiveXObject("Microsoft.XMLHTTP")}xhr.onreadystatechange=function(){if(4==xhr.readyState&&200==xhr.status){var data=eval("("+xhr.responseText+")");success(wrapper?wrapper(data):data)}else 4==xhr.readyState&&200!=xhr.status&&error()},freesound.debug&&console.log(uri),xhr.open("GET",uri),xhr.send(null)},_make_sound_object:function(e){return e.get_analysis=function(t,i,n,r){var o=i?freesound._URI_SOUND_ANALYSIS_FILTER:freesound._URI_SOUND_ANALYSIS;freesound._make_request(freesound._make_uri(o,[e.id,i?i:""]),n,r)},e.get_similar_sounds=function(t,i){freesound._make_request(freesound._make_uri(freesound._URI_SIMILAR_SOUNDS,[e.id]),t,i,{},this._make_sound_collection_object)},e},_make_sound_collection_object:function(e){var t=function(e,t,i){freesound._make_request(e,t,i,{},this._make_sound_collection_object)};return e.next_page=function(e,i){t(this.next,e,i)},e.previous_page=function(e,i){t(this.previous,e,i)},e},_make_user_object:function(e){return e.get_sounds=function(t,i){freesound._make_request(freesound._make_uri(freesound._URI_USER_SOUNDS,[e.username]),t,i,{},this._make_sound_collection_object)},e.get_packs=function(t,i){freesound._make_request(freesound._make_uri(freesound._URI_USER_PACKS,[e.username]),t,i,{},this._make_pack_collection_object)},e.get_bookmark_categories=function(t,i){freesound._make_request(freesound._make_uri(freesound._URI_USER_BOOKMARKS,[e.username]),t,i)},e.get_bookmark_category_sounds=function(e,t,i){freesound._make_request(e,t,i)},e},_make_pack_object:function(e){return e.get_sounds=function(t,i){freesound._make_request(freesound._make_uri(freesound._URI_PACK_SOUNDS,[e.id]),t,i,{},this._make_sound_collection_object)},e},_make_pack_collection_object:function(e){var t=function(e,t,i){freesound._make_request(e,t,i,{},this._make_pack_collection_object)};return e.next_page=function(e,i){t(this.next,e,i)},e.previous_page=function(e,i){t(this.previous,e,i)},e},get_from_ref:function(e,t,i){this._make_request(e,t,i,{})},get_sound:function(e,t,i){this._make_request(this._make_uri(this._URI_SOUND,[e]),t,i,{},this._make_sound_object)},get_user:function(e,t,i){this._make_request(this._make_uri(this._URI_USER,[e]),t,i,{},this._make_user_object)},get_pack:function(e,t,i){this._make_request(this._make_uri(this._URI_PACK,[e]),t,i,{},this._make_pack_object)},quick_search:function(e,t,i){this.search(e,0,null,null,t,i)},search:function(e,t,i,n,r,o,s,a,u){var c={q:e?e:" "};t&&(c.p=t),i&&(c.f=i),n&&(c.s=n),r&&(c.num_results=r),s&&(c.sounds_per_page=s),o&&(c.fields=o),this._make_request(this._make_uri(this._URI_SEARCH),a,u,c,this._make_sound_collection_object)},content_based_search:function(e,t,i,n,r,o,s,a){var u={};r&&(u.p=r),t&&(u.f=t),e&&(u.t=e),i&&(u.max_results=i),o&&(u.sounds_per_page=o),n&&(u.fields=n),this._make_request(this._make_uri(this._URI_CONTENT_SEARCH),s,a,u,this._make_sound_collection_object)},geotag:function(e,t,i,n,r,o,s,a,u){var c={};e&&(c.min_lat=e),t&&(c.max_lat=t),i&&(c.min_lon=i),n&&(c.max_lon=n),r&&(c.p=r),s&&(c.sounds_per_page=s),o&&(c.fields=o),this._make_request(this._make_uri(this._URI_GEOTAG),a,u,c,this._make_sound_collection_object)}}}()},{}],4:[function(e,t){!function(){function e(e,t){return e=s[e],t=s[t],e.distance>t.distance?t.distance+12-e.distance:t.distance-e.distance}function i(e,t,i){for(;i>0;i--)e+=t;return e}function n(e,t){if("string"!=typeof e)return null;this.name=e,this.duration=t||4,this.accidental={value:0,sign:""};var i=e.match(/^([abcdefgh])(x|#|bb|b?)(-?\d*)/i);if(i&&e===i[0]&&0!==i[3].length)this.name=i[1].toLowerCase(),this.octave=parseFloat(i[3]),0!==i[2].length&&(this.accidental.sign=i[2].toLowerCase(),this.accidental.value=y[i[2]]);else{e=e.replace(/\u2032/g,"'").replace(/\u0375/g,",");var n=e.match(/^(,*)([abcdefgh])(x|#|bb|b?)([,\']*)$/i);if(!n||5!==n.length||e!==n[0])throw Error("Invalid note format");if(""===n[1]&&""===n[4])this.octave=n[2]===n[2].toLowerCase()?3:2;else if(""!==n[1]&&""===n[4]){if(n[2]===n[2].toLowerCase())throw Error("Invalid note format. Format must respect the Helmholtz notation.");this.octave=2-n[1].length}else{if(""!==n[1]||""===n[4])throw Error("Invalid note format");if(n[4].match(/^'+$/)){if(n[2]===n[2].toUpperCase())throw Error("Invalid note format. Format must respect the Helmholtz notation");this.octave=3+n[4].length}else{if(!n[4].match(/^,+$/))throw Error("Invalid characters after note name.");if(n[2]===n[2].toLowerCase())throw Error("Invalid note format. Format must respect the Helmholtz notation");this.octave=2-n[4].length}}this.name=n[2].toLowerCase(),0!==n[3].length&&(this.accidental.sign=n[3].toLowerCase(),this.accidental.value=y[n[3]])}}function r(e,t){if(!(e instanceof n))return null;t=t||"",this.name=e.name.toUpperCase()+e.accidental.sign+t,this.root=e,this.notes=[e],this.quality="major",this.type="major";var i,r,s,a,u,c=[],l=!1,f="quality",h=!1,b=!1,m=null;for(a=0,u=t.length;u>a;a++){for(i=t[a];" "===i||"("===i||")"===i;)i=t[++a];if(!i)break;if(r=i.charCodeAt(0),s=u>=a+3?t.substr(a,3):"","quality"===f)"M"===i||("maj"===s||916===r?(this.type="major",c.push("M7"),l=!0,(t[a+3]&&"7"===t[a+3]||916===r&&"7"===t[a+1])&&a++):"m"===i||"-"===i||"min"===s?this.quality=this.type="minor":111===r||176===r||"dim"===s?(this.quality="minor",this.type="diminished"):"+"===i||"aug"===s?(this.quality="major",this.type="augmented"):216===r||248===r?(this.quality="minor",this.type="diminished",c.push("m7"),l=!0):"sus"===s?(this.quality="sus",this.type=t[a+3]&&"2"===t[a+3]?"sus2":"sus4"):"5"===i?(this.quality="power",this.type="power"):a-=1),s in p&&(a+=2),f="";else if("#"===i)h=!0;else if("b"===i)b=!0;else if("5"===i)h?(m="A5","major"===this.quality&&(this.type="augmented")):b&&(m="d5","minor"===this.quality&&(this.type="diminished")),b=h=!1;else if("6"===i)c.push("M6"),b=h=!1;else if("7"===i)c.push("diminished"===this.type?"d7":"m7"),l=!0,b=h=!1;else if("9"===i)l||c.push("m7"),c.push(b?"m9":h?"A9":"M9"),b=h=!1;else{if("1"!==i)throw Error("Unexpected character: '"+i+"' in chord name");i=t[++a],"1"===i?c.push(b?"d11":h?"A11":"P11"):"3"===i&&c.push(b?"m13":h?"A13":"M13"),b=h=!1}}for(var g=0,y=d[this.type].length;y>g;g++)this.notes.push("5"===d[this.type][g][1]&&m?o.interval(this.root,m):o.interval(this.root,d[this.type][g]));for(g=0,y=c.length;y>g;g++)this.notes.push(o.interval(this.root,c[g]))}var o={},s={c:{name:"c",distance:0,index:0},d:{name:"d",distance:2,index:1},e:{name:"e",distance:4,index:2},f:{name:"f",distance:5,index:3},g:{name:"g",distance:7,index:4},a:{name:"a",distance:9,index:5},b:{name:"b",distance:11,index:6},h:{name:"h",distance:11,index:6}},a=["c","d","e","f","g","a","b"],u={.25:"longa",.5:"breve",1:"whole",2:"half",4:"quarter",8:"eighth",16:"sixteenth",32:"thirty-second",64:"sixty-fourth",128:"hundred-twenty-eighth"},c=[{name:"unison",quality:"perfect",size:0},{name:"second",quality:"minor",size:1},{name:"third",quality:"minor",size:3},{name:"fourth",quality:"perfect",size:5},{name:"fifth",quality:"perfect",size:7},{name:"sixth",quality:"minor",size:8},{name:"seventh",quality:"minor",size:10},{name:"octave",quality:"perfect",size:12},{name:"ninth",quality:"minor",size:13},{name:"tenth",quality:"minor",size:15},{name:"eleventh",quality:"perfect",size:17},{name:"twelfth",quality:"perfect",size:19},{name:"thirteenth",quality:"minor",size:20},{name:"fourteenth",quality:"minor",size:22},{name:"fifteenth",quality:"perfect",size:24}],l={unison:0,second:1,third:2,fourth:3,fifth:4,sixth:5,seventh:6,octave:7,ninth:8,tenth:9,eleventh:10,twelfth:11,thirteenth:12,fourteenth:13,fifteenth:14},p={P:"perfect",M:"major",m:"minor",A:"augmented",d:"diminished",perf:"perfect",maj:"major",min:"minor",aug:"augmented",dim:"diminished"},f={perfect:"P",major:"M",minor:"m",augmented:"A",diminished:"d"},h={P:"P",M:"m",m:"M",A:"d",d:"A"},b={perfect:["diminished","perfect","augmented"],minor:["diminished","minor","major","augmented"]},d={major:["M3","P5"],minor:["m3","P5"],augmented:["M3","A5"],diminished:["m3","d5"],sus2:["M2","P5"],sus4:["P4","P5"],power:["P5"]},m={major:"M",minor:"m",augmented:"aug",diminished:"dim",power:"5"},g={"-2":"bb","-1":"b",0:"",1:"#",2:"x"},y={bb:-2,b:-1,"#":1,x:2};n.prototype={key:function(e){return e?7*(this.octave-1)+3+Math.ceil(s[this.name].distance/2):12*(this.octave-1)+4+s[this.name].distance+this.accidental.value},fq:function(e){return e=e||440,e*Math.pow(2,(this.key()-49)/12)},scale:function(e,t){return o.scale.list(this,e,t)},interval:function(e,t){return o.interval(this,e,t)},chord:function(e){return e=e||"major",e in m&&(e=m[e]),new r(this,e)},helmholtz:function(){var e,t=3>this.octave?this.name.toUpperCase():this.name.toLowerCase();return 2>=this.octave?(e=i("",",",2-this.octave),e+t+this.accidental.sign):(e=i("","'",this.octave-3),t+this.accidental.sign+e)},scientific:function(){return this.name.toUpperCase()+this.accidental.sign+("number"==typeof this.octave?this.octave:"")},enharmonics:function(){var e=[],t=this.key(),i=this.interval("m2","up"),n=this.interval("m2","down"),r=i.key()-i.accidental.value,o=n.key()-n.accidental.value,s=t-r;return 3>s&&s>-3&&(i.accidental={value:s,sign:g[s]},e.push(i)),s=t-o,3>s&&s>-3&&(n.accidental={value:s,sign:g[s]},e.push(n)),e},valueName:function(){return u[this.duration]},toString:function(e){return e="boolean"==typeof e?e:"number"==typeof this.octave?!1:!0,this.name.toLowerCase()+this.accidental.sign+(e?"":this.octave)}},r.prototype.dominant=function(e){return e=e||"",new r(this.root.interval("P5"),e)},r.prototype.subdominant=function(e){return e=e||"",new r(this.root.interval("P4"),e)},r.prototype.parallel=function(e){if(e=e||"","triad"!==this.chordType()||"diminished"===this.quality||"augmented"===this.quality)throw Error("Only major/minor triads have parallel chords");return"major"===this.quality?new r(this.root.interval("m3","down"),"m"):new r(this.root.interval("m3","up"))},r.prototype.chordType=function(){var e,t,i;if(2===this.notes.length)return"dyad";if(3===this.notes.length){t={unison:!1,third:!1,fifth:!1};for(var n=0,r=this.notes.length;r>n;n++)e=this.root.interval(this.notes[n]),i=c[parseFloat(o.interval.invert(e.simple)[1])-1],e.name in t?t[e.name]=!0:i.name in t&&(t[i.name]=!0);return t.unison&&t.third&&t.fifth?"triad":"trichord"}if(4===this.notes.length){t={unison:!1,third:!1,fifth:!1,seventh:!1};for(var n=0,r=this.notes.length;r>n;n++)e=this.root.interval(this.notes[n]),i=c[parseFloat(o.interval.invert(e.simple)[1])-1],e.name in t?t[e.name]=!0:i.name in t&&(t[i.name]=!0);if(t.unison&&t.third&&t.fifth&&t.seventh)return"tetrad"}return"unknown"},r.prototype.toString=function(){return this.name},o.note=function(e,t){return new n(e,t)},o.note.fromKey=function(e){var t=440*Math.pow(2,(e-49)/12);return o.frequency.note(t).note},o.chord=function(e){var t;if(t=e.match(/^([abcdefgh])(x|#|bb|b?)/i),t&&t[0])return new r(new n(t[0].toLowerCase()),e.substr(t[0].length));throw Error("Invalid Chord. Couldn't find note name")},o.frequency={note:function(e,t){t=t||440;var i,r,o,u,c,l,p;return i=Math.round(49+12*((Math.log(e)-Math.log(t))/Math.log(2))),p=t*Math.pow(2,(i-49)/12),l=1200*(Math.log(e/p)/Math.log(2)),r=Math.floor((i-4)/12),o=i-12*r-4,u=s[a[Math.round(o/2)]],c=u.name,o>u.distance?c+="#":u.distance>o&&(c+="b"),{note:new n(c+(r+1)),cents:l}}},o.interval=function(e,t,i){if("string"==typeof t){"down"===i&&(t=o.interval.invert(t));var r=p[t[0]],s=parseFloat(t.substr(1));if(!r||isNaN(s)||1>s)throw Error("Invalid string-interval format");return o.interval.from(e,{quality:r,interval:c[s-1].name},i)}if(t instanceof n&&e instanceof n)return o.interval.between(e,t);throw Error("Invalid parameters")},o.interval.from=function(t,i,r){i.direction=r||i.direction||"up";var o,u,p,f,h,d;if(h=l[i.interval],d=c[h],h>7&&(h-=7),h=s[t.name].index+h,h>a.length-1&&(h-=a.length),o=a[h],-1===b[d.quality].indexOf(i.quality)||-1===b[d.quality].indexOf(d.quality))throw Error("Invalid interval quality");return u=b[d.quality].indexOf(i.quality)-b[d.quality].indexOf(d.quality),p=d.size+u-e(t.name,o),t.octave&&(f=Math.floor((t.key()-t.accidental.value+e(t.name,o)-4)/12)+1+Math.floor(l[i.interval]/7)),p+=t.accidental.value,p>=11&&(p-=12),p>-3&&3>p&&(o+=g[p]),"down"===r&&f--,new n(o+(f||""))},o.interval.between=function(e,t){var i,n,r,o,a,u,l=e.key(),p=t.key();if(i=p-l,i>24||-25>i)throw Error("Too big interval. Highest interval is a augmented fifteenth (25 semitones)");return 0>i&&(o=e,e=t,t=o),r=s[t.name].index-s[e.name].index+7*(t.octave-e.octave),n=c[r],u=b[n.quality][Math.abs(i)-n.size+1],a=f[u]+(""+Number(r+1)),{name:n.name,quality:u,direction:i>0?"up":"down",simple:a}
},o.interval.invert=function(e){if(2!==e.length&&3!==e.length)return!1;var t=h[e[0]],i=parseFloat(2===e.length?e[1]:e.substr(1));return i>8&&(i-=7),8!==i&&1!==i&&(i=9-i),t+(""+i)},o.scale={list:function(e,t,i){var r,s,a=[],u=[];if(!(e instanceof n))return!1;if("string"==typeof t&&(t=o.scale.scales[t],!t))return!1;for(a.push(e),i&&u.push(e.name+(e.accidental.sign||"")),r=0,s=t.length;s>r;r++)a.push(o.interval(e,t[r])),i&&u.push(a[r+1].name+(a[r+1].accidental.sign||""));return i?u:a},scales:{major:["M2","M3","P4","P5","M6","M7"],ionian:["M2","M3","P4","P5","M6","M7"],dorian:["M2","m3","P4","P5","M6","m7"],phrygian:["m2","m3","P4","P5","m6","m7"],lydian:["M2","M3","A4","P5","M6","M7"],mixolydian:["M2","M3","P4","P5","M6","m7"],minor:["M2","m3","P4","P5","m6","m7"],aeolian:["M2","m3","P4","P5","m6","m7"],locrian:["m2","m3","P4","d5","m6","m7"],majorpentatonic:["M2","M3","P5","M6"],minorpentatonic:["m3","P4","P5","m7"],chromatic:["m2","M2","m3","M3","P4","A4","P5","m6","M6","m7","M7"],harmonicchromatic:["m2","M2","m3","M3","P4","A4","P5","m6","M6","m7","M7"]}},t.exports=o}()},{}],5:[function(e,t){t.exports=function(t){"use strict";{var i,n=t.dollar;e("gibberish-dsp")}return i={"export":function(e){n.extend(e,i.Busses),n.extend(e,i.Oscillators),n.extend(e,i.Synths),n.extend(e,i.Percussion),n.extend(e,i.Envelopes),n.extend(e,i.FX),n.extend(e,i.Seqs),n.extend(e,i.Samplers),n.extend(e,i.PostProcessing),n.extend(e,i.Vocoder),e.Theory=i.Theory,n.extend(e,i.Analysis),e.Score=i.Score,e.Clock=i.Clock,e.Seq=i.Seqs.Seq,e.Arp=i.Arp,e.ScaleSeq=i.Seqs.ScaleSeq,e.SoundFont=i.SoundFont,e.Speak=i.Speak,e.Rndi=i.Core.Rndi,e.Rndf=i.Core.Rndf,e.rndi=i.Core.rndi,e.rndf=i.Core.rndf,e.Input=i.Input,e.Freesound=i.Freesound,e.Scale=i.Theory.Scale,e.module=t.import,i.Core.Time.export(e),i.Clock.export(e),i.Core.Binops.export(e)},init:function(){var e=null;i.onstart&&(e=i.onstart),i.context||(i.context={sampleRate:44100}),i.Core.onstart=function(){i.Clock.start(!0),null!==e&&e()},i.Score=i.Score(t),t.Clock=i.Clock,t.Theory=i.Theory,t.Theory.scale=t.scale=t.Audio.Theory.Scale("c4","Minor"),i.Core._init(),n.extend(t.Binops,i.Binops),i.Master=i.Busses.Bus().connect(i.Core.out),i.Master.type="Bus",i.Master.name="Master",n.extend(!0,i.Master,i.ugenTemplate),i.Master.fx.ugen=i.Master,i.ugenTemplate.connect=i.Core._oscillator.connect=i.Core._synth.connect=i.Core._effect.connect=i.Core._bus.connect=i.connect,i.Core.defineUgenProperty=i.defineUgenProperty,n.extend(t.Presets,i.Synths.Presets),n.extend(t.Presets,i.Percussion.Presets),n.extend(t.Presets,i.FX.Presets)},Time:{ms:function(e){return{mode:"absolute",value:t.Audio.Core.context.sampleRate/1e3*e,valueOf:function(){return this.value}}},seconds:function(e){return{mode:"absolute",value:t.Audio.Core.context.sampleRate*e,valueOf:function(){return this.value}}},minutes:function(e){return{mode:"absolute",value:60*t.Audio.Core.context.sampleRate*e,valueOf:function(){return this.value}}}},defineUgenProperty:function(e,t,n){var r=i.Clock.timeProperties.indexOf(e)>-1,o=n.properties[e]={value:r?i.Clock.time(t):t,binops:[],parent:n,name:e},s=e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(n,e,{configurable:!0,get:function(){return o.value},set:function(e){return n[s]&&n[s].mapping&&n[s].mapping.remove&&n[s].mapping.remove(!0),o.value=r?i.Clock.time(e):e,i.Core.dirty(n),o.value}}),n[e]=o.value},polyInit:function(e){e.mod=e.polyMod,e.removeMod=e.removePolyMod;for(var t in e.polyProperties)!function(t){var n=e.polyProperties[t],r=i.Clock.timeProperties.indexOf(t)>-1;Object.defineProperty(e,t,{get:function(){return n},set:function(n){for(var o=0;o<e.children.length;o++)e.children[o][t]=r?i.Clock.time(n):n}})}(t)},connect:function(e,t){return"undefined"==typeof e&&(e=i.Master),-1===this.destinations.indexOf(e)&&(e.addConnection(this,1,t),0!==t&&this.destinations.push(e)),this},clear:function(){for(var e=Array.prototype.slice.call(arguments,0),t=0;t<i.Master.inputs.length;t++)-1===e.indexOf(i.Master.inputs[t].value)&&i.Master.inputs[t].value.disconnect();i.Master.inputs.length=arguments.length,i.Clock.shouldResetOnClear!==!1&&i.Clock.reset(),i.Master.fx.remove(),i.Master.amp=1,i.Core.clear(),i.Clock.seq.connect(),i.Core.out.addConnection(i.Master,1),i.Master.destinations.push(i.Core.out),console.log("Audio stopped.")},ugenTemplate:{sequencers:[],mappings:[],fx:n.extend([],{add:function(){var e=0===this.length?this.ugen:this[this.length-1];e.disconnect();for(var t=0;t<arguments.length;t++){var n=arguments[t];n.input=e,e=n,this.push(n)}return this.ugen!==i.Master?e.connect():e.connect(i.Core.out),this.ugen},remove:function(){if(arguments.length>0)for(var e=0;e<arguments.length;e++){var t=arguments[e];if("string"!=typeof t)if("object"!=typeof t){if("number"==typeof t){var n=this[t];if(n.disconnect(),this.splice(t,1),"undefined"!=typeof this[t]){var r=t-1;this[t].input=-1!==r?this[r]:this.ugen,"undefined"!=typeof this[t+1]?this[t+1].input=0===t?this.ugen:this[t]:this.ugen.connect(this.ugen!==i.Master?i.Master:i.Core.out)}else this.length>0?this[t-1].connect(i.Master):this.ugen.connect(this.ugen!==i.Master?i.Master:i.Core.out)}}else for(var o=0;o<this.length;o++)this[o]===t&&this.remove(o);else for(var o=0;o<this.length;o++)this[o].name===t&&this.remove(o)}else this.length>0?(this[this.length-1].disconnect(),this.ugen.connect(this.ugen!==i.Master?i.Master:i.Core.out),this.ugen.codegen(),this.length=0):console.log(this.ugen.name+" does not have any fx to remove. ")}}),replaceWith:function(e){if(e.connect){for(var t=0;t<this.destinations.length;t++)e.connect(this.destinations[t]);for(var t=0;t<this.sequencers.length;t++)this.sequencers[t].target=e,e.sequencers.push(this.sequencers[t]);for(var t=0;t<this.mappingObjects.length;t++){var i=this.mappingObjects[t];if(i.targets.length>0)for(var n=0;n<i.targets.length;n++){var r=i.targets[n];e.mappingProperties[i.name]?r[0].mapping.replace(e,i.name,i.Name):r[0].mapping.remove()}}}this.kill()},kill:function(){var e=0!==this.fx.length?this.fx[this.fx.length-1]:this;this.seq.isRunning&&this.seq.disconnect(),e.disconnect();for(var t=0;t<this.fx.length;t++){var i=this.fx[t];i.seq.isRunning&&i.seq.disconnect()}this.disconnect();for(var t=0;t<this.mappings.length;t++)this.mappings[t].remove();this.clearMarks&&this.clearMarks(),console.log(this.name+" has been terminated.")},play:function(e,t){return this.note?this.note.seq(e,t):this.frequency&&this.frequency.seq(e,t),this},fadeIn:function(e,t){isNaN(t)&&(t=1);var n=i.Clock.time(e),r=(new i.Core.ExponentialDecay({decayCoefficient:.05,length:n}),new i.Core.Line(0,t,n));return this.amp=r,future(function(){this.amp=t}.bind(this),n),this},fadeOut:function(e){var t=i.Clock.time(e),n=(new i.Core.ExponentialDecay({decayCoefficient:5e-5,length:t}),new i.Core.Line(this.amp.value,0,i.Clock.time(t)));return this.amp(n),future(function(){this.amp=0}.bind(this),t),this}}},i.Core=e("gibberish-dsp"),i.Core._init=i.Core.init.bind(i.Core),delete i.Core.init,i.Clock=e("./audio/clock")(t),i.Freesoundjs=e("../external/freesound"),i.Freesound=e("./audio/gibber_freesound")(i.Freesoundjs),i.Seqs=e("./audio/seq")(t),i.Theory=e("./audio/theory")(t),i.FX=e("./audio/fx")(t),i.Oscillators=e("./audio/oscillators")(t),i.Synths=e("./audio/synths")(t),i.Busses=e("./audio/bus")(t),i.Analysis=e("./audio/analysis")(t),i.Envelopes=e("./audio/envelopes")(t),i.Percussion=e("./audio/drums")(t),i.Input=e("./audio/audio_input")(t),i.Samplers=e("./audio/sampler")(t),i.Vocoder=e("./audio/vocoder")(t),i.PostProcessing=e("./audio/postprocessing")(t),i.Arp=e("./audio/arp")(t),i.SoundFont=e("./audio/soundfont")(t),i.Score=e("./audio/score"),i}},{"../external/freesound":3,"./audio/analysis":6,"./audio/arp":7,"./audio/audio_input":8,"./audio/bus":9,"./audio/clock":10,"./audio/drums":11,"./audio/envelopes":12,"./audio/fx":13,"./audio/gibber_freesound":14,"./audio/oscillators":15,"./audio/postprocessing":16,"./audio/sampler":17,"./audio/score":18,"./audio/seq":19,"./audio/soundfont":20,"./audio/synths":21,"./audio/theory":22,"./audio/vocoder":23,"gibberish-dsp":2}],6:[function(e,t){t.exports=function(t){"use strict";var i,n={value:{min:0,max:255,output:a,wrap:!1,timescale:"graphics"}},r=e("gibberish-dsp"),o=t.dollar,s=t.outputCurves,a=(s.LINEAR,s.LOGARITHMIC),u={FFT:function(e,s){if("undefined"==typeof i){i=r.context.createAnalyser(),r.node.connect(i),i.fftSize=e||32,i.updateRate=s||40,i.values=new Uint8Array(i.frequencyBinCount),i.children=[];for(var a=0;a<i.frequencyBinCount;a++)!function(){var e=a,r={},s=0;Object.defineProperties(r,{value:{configurable:!0,get:function(){return s},set:function(e){s=e}}}),t.createProxyProperties(r,o.extend({},n),!1),i[e]=r,i.children.push(r),r.type="mapping",r.index=e,r.min=0,r.max=255,r.valueOf=function(){return this.value.value}}();setInterval(function(){i.getByteFrequencyData(i.values);for(var e=0;e<i.values.length;e++)i[e].value=i.values[e]},i.updateRate)}else e&&(i.fftSize=e),s&&(i.updateRate=s);return i},Follow:function(e,i){var n=new r.Follow(e,i),o={value:{min:0,max:1,output:a,timescale:"audio"}};return t.createProxyProperties(n,o),n}};return u}},{"gibberish-dsp":2}],7:[function(e,t){t.exports=function(t){var i,n=e("../../external/teoria.min"),r=t.dollar,o=(t.outputCurves,e("./seq")(t).Seq);return i=function(e,i,s,a,u){var c=o();r.extend(c,{name:"Arp",notes:[],pattern:s||"up",notation:e||"C4m7",mult:a||1,init:!1,speed:isNaN(i)?_4:i,scale:u||null,chord:function(e){var i=[];if(this.notation=e,"undefined"==typeof this.scale||null===this.scale&&"string"==typeof e)for(var r=0;r<this.mult;r++){var o,s,a=[],u=this.notation.slice(0,1);isNaN(this.notation.charAt(1))?(u+=this.notation.charAt(1),o=parseInt(this.notation.slice(2,3)),s=this.notation.slice(3)):(o=parseInt(this.notation.slice(1,2)),s=this.notation.slice(2)),o+=r;for(var e=n.note(u+o).chord(s),c=0;c<e.notes.length;c++){var l=e.notes[c].fq();a[c]=l}i=i.concat(a)}else for(var r=0;r<this.mult;r++){for(var a=[],c=0;c<this.notation.length;c++)a[c]=this.notation[c]+7*r;i=i.concat(a)}this.notes=t.construct(t.Pattern,this.patterns[this.pattern](i)),this.seqs[0]&&(this.seqs[0].values=[this.notes])},set:function(e,t,i,n,r){this.speed=t||this.speed,this.pattern=i||this.pattern,this.mult=n||this.mult,this.chord(e,r)},shuffle:function(){this.notes.shuffle()},reset:function(){this.notes.reset()},patterns:{up:function(e){return e},down:function(e){return e.reverse()},updown:function(e){var t=e.slice(0);return t.reverse(),e.concat(t)},updown2:function(e){var t=e.slice(0);return t.pop(),t.reverse(),t.pop(),e.concat(t)}}}),c.seq=c,t.createProxyMethods(c,["shuffle","reset","chord"]),c.chord(c.notation);var l=null;Object.defineProperty(c,"target",{get:function(){return l},set:function(e){l=e;var n={key:"note",target:l,values:c.notes,durations:t.Clock.time(i)};c.add(n),c.start()}});var p=i;return Object.defineProperty(c,"speed",{get:function(){return p},set:function(e){p=e;for(var i=0;i<c.seqs.length;i++)c.seqs[0].durations=t.Clock.time(p)}}),c}}},{"../../external/teoria.min":4,"./seq":19}],8:[function(e,t){t.exports=function(t){"use strict";var i={},n=e("gibberish-dsp"),r=t.outputCurves,o=r.LINEAR,s=r.LOGARITHMIC,a={amp:{min:0,max:1,hardMax:2,output:s,timescale:"audio",dimensions:1},out:{min:0,max:1,output:o,timescale:"audio",dimensions:1}},u="Input";return i=function(){var e=(new n.Input).connect(t.Master),i=Array.prototype.slice.call(arguments,0);return e.type="Gen",$.extend(!0,e,t.Audio.ugenTemplate),e.fx.ugen=e,Object.defineProperty(e,"_",{get:function(){return e.kill(),e},set:function(){}}),t.createProxyProperties(e,a),t.processArguments2(e,i,u),e.toString=function(){return"> "+u},e}}},{"gibberish-dsp":2}],9:[function(e,t){t.exports=function(t){"use strict";for(var i=t.dollar,n=e("gibberish-dsp"),r=t.outputCurves,o=r.LINEAR,s=(r.LOGARITHMIC,[["Bus2","Bus"]]),a={amp:{min:0,max:1,output:o,timescale:"audio"},pan:{min:-.75,max:.75,output:o,timescale:"audio"},out:{min:0,max:1,output:o,timescale:"audio",dimensions:1}},u=!1,c={mappingProperties:a,Presets:{}},l=0;l<s.length;l++)!function(){var e=Array.isArray(s[l])?s[l][0]:s[l],r=Array.isArray(s[l])?s[l][1]:s[l];c[r]=function(){var o=t.processArguments(arguments,r);return Array.isArray(o)?(o.unshift(0),o=t.construct(n[e],o)):o=new n[e](o),u?o.connect(Master):u=!0,o.type="Gen",Object.defineProperty(o,"_",{get:function(){return o.kill(),o},set:function(){}}),i.extend(!0,o,t.Audio.ugenTemplate),o.fx.ugen=o,t.createProxyProperties(o,a),o}}();return c.Group=function(){var e=t.processArguments(arguments,"Bus2");e=new n.Bus2,u?e.connect(Master):u=!0,e.type="FX",i.extend(!0,e,t.Audio.ugenTemplate),e.fx.ugen=e,t.createProxyProperties(e,a),i.extend(e,{add:function(){for(var t=0;t<arguments.length;t++)arguments[t].disconnect(),arguments[t].connect(e)},remove:function(){for(var t=0;t<arguments.length;t++)arguments[t].disconnect(e)},free:function(){for(var t=0;t<arguments.length;t++)arguments[t].disconnect(e),arguments[t].connect()}});for(var r=0;r<arguments.length;r++)e.add(arguments[r]);return e},c}},{"gibberish-dsp":2}],10:[function(require,module,exports){!function(){var times=[],$=null,curves=null,LINEAR=null,LOGARITHMIC=null,Gibberish=require("gibberish-dsp"),Gibber,Clock={seq:null,bpm:null,maxMeasures:44,baseBPM:120,metronome:null,currentBeat:0,beatsPerMeasure:4,codeToExecute:[],signature:{lower:4,upper:4},sequencers:[],shouldResetOnClear:!0,timeProperties:["attack","decay","sustain","release","offset","time"],phase:0,"export":function(e){e.beats=Clock.beats,e.Beats=Clock.Beats,e.measures=Clock.measures,e.Measures=Clock.Measures},processBeat:function(){if(Clock.currentBeat=Clock.currentBeat>=Clock.signature.upper?1:Clock.currentBeat+1,1===Clock.currentBeat&&Clock.codeToExecute.length>0){for(var i=0;i<Clock.codeToExecute.length;i++)try{"function"==typeof Clock.codeToExecute[i].function?Clock.codeToExecute[i].function():Gibber.Environment?Gibber.Environment.modes[Clock.codeToExecute[i].cm.doc.mode.name].run(Clock.codeToExecute[i].cm.column,Clock.codeToExecute[i].code,Clock.codeToExecute[i].pos,Clock.codeToExecute[i].cm,!1):eval(Clock.codeToExecute[i].code)}catch(e){console.error("FAILED TO EXECUTE CODE:",Clock.codeToExecute[i].code,e)}Clock.codeToExecute.length=0}null!==Clock.metronome&&Clock.metronome.draw(Clock.currentBeat,Clock.signature.upper),Clock.phase+=Clock.beats(1)},getTimeSinceStart:function(){return Clock.phase+Clock.seq.phase},reset:function(){this.phase=0,this.currentBeat=0,this.rate=1,this.start(!1)},tap:function(){var e=Gibber.Clock.getTimeSinceStart();for(times[2]&&e-times[2]>88200&&(times.length=0),times.unshift(e);times.length>3;)times.pop();if(3===times.length){var t=(times[0]+times[1]-2*times[2])/3,i=44100/t,n=60*i;Gibber.Clock.bpm=n}},start:function(e){var t=0;if(e){$.extend(this,{properties:{rate:1},name:"master_clock",callback:function(e){return t++,e}}),this.__proto__=new Gibberish.ugen,this.__proto__.init.call(this);var i=this.baseBPM;Object.defineProperty(Clock,"bpm",{get:function(){return i},set:function(e){i=e,Clock.rate=i/Clock.baseBPM}}),Object.defineProperty(this,"timeSignature",{get:function(){return Clock.signature.upper+"/"+Clock.signature.lower},set:function(e){var t=e.split("/");2!==t.length||t[0]===Clock.signature.upper&&t[1]===Clock.signature.lower||(Clock.signature.upper=parseInt(t[0]),Clock.signature.lower=parseInt(t[1]),Clock.currentBeat=1!=Clock.currentBeat?0:1)}}),Gibber.createProxyProperties(this,{rate:{min:.1,max:2,output:LINEAR,timescale:"audio"},bpm:{min:20,max:200,output:LINEAR,timescale:"audio"}}),this.setPhase=function(e){t=e},this.getPhase=function(){return t},Clock.seq=new Gibberish.PolySeq({seqs:[{target:Clock,values:[Clock.processBeat.bind(Clock)],durations:[.25]}],rate:Clock}),Clock.seq.connect().start(),Clock.seq.timeModifier=Clock.time.bind(Clock)}else Clock.seq.setPhase(0),Clock.seq.connect().start()},addMetronome:function(e){this.metronome=e,this.metronome.init()},time:function(e){var t;return t=e<Clock.maxMeasures?Clock.beats(e*Clock.signature.lower):e},Time:function(e){var t;return t=Clock.Beats(e<this.maxMeasures?e*Clock.signature.lower:e)},beats:function(e){var t="undefined"!=typeof Gibberish.context?Gibberish.context.sampleRate:44100,i=Clock.bpm/60,n=t/i;return n*e},Beats:function(e){return Gibber.clock.beats.bind(null,e)},measures:function(e){return Clock.beats(e*Clock.signature.upper)},Measures:function(e){return Clock.Beats(e*Clock.signature.upper)}};module.exports=function(e){"use strict";return Gibber=e,$=Gibber.dollar,curves=Gibber.outputCurves,LINEAR=curves.LINEAR,LOGARITHMIC=curves.LOGARITHMIC,Clock}}()},{"gibberish-dsp":2}],11:[function(require,module,exports){module.exports=function(Gibber){"use strict";for(var Percussion={Presets:{}},Gibberish=require("gibberish-dsp"),$=Gibber.dollar,Clock=Gibber.Clock,curves=Gibber.outputCurves,LINEAR=curves.LINEAR,LOGARITHMIC=curves.LOGARITHMIC,types=["Kick","Snare","Hat","Conga","Cowbell","Clave","Tom","Clap"],_mappingProperties={Drums:{pitch:{min:.25,max:4,output:LINEAR,timescale:"audio"},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},pan:{min:0,max:1,output:LINEAR,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},XOX:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},pan:{min:0,max:1,output:LINEAR,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Kick:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Snare:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},snappy:{min:.25,max:1.5,output:LOGARITHMIC,timescale:"audio"},tune:{min:0,max:2,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Hat:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Conga:{amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"},out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1}},Cowbell:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}},Clave:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}},Tom:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}},Clap:{out:{min:0,max:1,output:LINEAR,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:LOGARITHMIC,timescale:"audio"}}},i=0;i<types.length;i++)!function(){var e=Array.isArray(types[i])?types[i][0]:types[i],t=Array.isArray(types[i])?types[i][1]:types[i];Percussion[t]=function(){var i,n=Array.prototype.slice.call(arguments);return"object"==typeof n[0]&&"undefined"==typeof n[0].maxVoices?n[0].maxVoices=1:"undefined"==typeof n[0]&&(n[0]={maxVoices:1}),i=Gibber.processArguments(n,t),i=Array.isArray(i)?Gibber.construct(Gibberish[e],i).connect(Gibber.Master):new Gibberish[e](i).connect(Gibber.Master),i.type="Gen",$.extend(!0,i,Gibber.Audio.ugenTemplate),i.fx.ugen=i,i._note=i.note.bind(i),i.note=function(){var e=Array.prototype.splice.call(arguments,0);"string"==typeof e[0]&&(e[0]=Gibber.Theory.Teoria.note(e[0]).fq()),this._note.apply(this,e)},Gibber.createProxyProperties(i,_mappingProperties[t]),Gibber.createProxyMethods(i,["note","send"]),i.toString=function(){return"> "+t},Object.defineProperty(i,"_",{get:function(){return i.kill(),i},set:function(){}}),i}}();return Percussion.Drums=function(_sequence,_timeValue,_amp,_freq){var args=Array.prototype.slice.call(arguments),obj={},props=Gibber.processArguments(args,"Drums");$.extend(!0,obj,props),obj=Array.isArray(obj)?Gibber.construct(Gibberish.Bus2,obj).connect(Gibber.Master):new Gibberish.Bus2(obj).connect(Gibber.Master),obj.name="Drums",obj.type="Gen",obj.children=[],$.extend(!0,obj,Gibber.Audio.ugenTemplate),obj.fx.ugen=obj,Object.defineProperty(obj,"_",{get:function(){return obj.kill(),obj},set:function(){}}),obj.kit=Percussion.Drums.kits["default"],"object"==typeof arguments[0]&&arguments[0].kit&&(obj.kit=Percussion.Drums.kits[arguments[0].kit],arguments[0].kit=obj.kit);for(var key in obj.kit){var drum=obj.kit[key];obj[key]={sampler:new Gibberish.Sampler({file:drum.file,pitch:1,amp:drum.amp}),pitch:drum.pitch,amp:drum.amp},obj[key].sampler.pan=drum.pan,obj[key].sampler.connect(obj),obj[key].fx=obj[key].sampler.fx,obj.children.push(obj[key].sampler)}if(obj.mod=obj.polyMod,obj.removeMod=obj.removePolyMod,obj.connect(),Gibber.createProxyProperties(obj,_mappingProperties.Drums),obj.note=function(e){var t=obj.pitch.value;if($.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];if("string"==typeof n){for(var r in obj.kit)if(n===obj.kit[r].symbol){obj[r].sampler.note(t,obj[r].amp);break}}else{var o=obj[Object.keys(obj.kit)[n]];o.sampler.note(t.value,o.sampler.amp)}}else if("string"==typeof e){for(var r in obj.kit)if(e===obj.kit[r].symbol){obj[r].sampler.note(t,obj[r].amp),obj[r].sampler.pitch=t;break}}else{var s=Object.keys(obj.kit),a=Math.abs(e),r=s[a%s.length],o=obj[r];o.sampler.note(t,o.sampler.amp)}},obj.pitch=1,"undefined"!=typeof props)switch($.type(props[0])){case"string":for(var notes=props[0],_seqs=[],_durations=[],__durations=[],seqs=notes.split("|"),timeline={},i=0;i<seqs.length;i++){var seq=seqs[i],duration,hasTime=!1,idx=seq.indexOf(",");if(idx>-1){var _value=seq.substr(0,idx),duration=seq.substr(idx+1);duration=eval(duration),hasTime=!0,seq=_value.trim().split("")}else seq=seq.trim().split(""),duration=1/seq.length;if(seq.indexOf(".rnd(")>-1&&(seq=seq.split(".rnd")[0],seq=seq.split("").rnd()),"undefined"!=typeof props[1]){duration=props[1],Array.isArray(duration)||(duration=[duration]);var durationsPattern=Gibber.construct(Gibber.Pattern,duration);if(duration.randomFlag){durationsPattern.filters.push(function(){return[durationsPattern.values[rndi(0,durationsPattern.values.length-1)],1]});for(var i=0;i<duration.randomArgs.length;i+=2)durationsPattern.repeat(duration.randomArgs[i],duration.randomArgs[i+1])}duration=durationsPattern}obj.seq.add({key:"note",values:Gibber.construct(Gibber.Pattern,seq),durations:Gibber.construct(Gibber.Pattern,[duration]),target:obj});var seqNumber=obj.seq.seqs.length-1;Object.defineProperties(obj.note,{values:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].values},set:function(e){var t=Gibber.construct(Gibber.Pattern,e);Array.isArray(t)||(t=[t]),obj.seq.seqs[seqNumber].values=t}},durations:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].durations},set:function(e){Array.isArray(e)||(e=[e]),obj.seq.seqs[seqNumber].durations=e}}})}break;case"object":"string"==typeof props[0].note&&(props[0].note=props[0].note.split("")),props[0].target=obj,props[0].durations=Gibber.Clock.Time(props[0].durations?props[0].durations:1/props[0].note.length),props[0].offset=props[0].offset?Gibber.Clock.time(props[0].offset):0;break;case"function":case"array":var length=props[0].length||props[0].values.length,durations="undefined"!=typeof arguments[1]?arguments[1]:Gibber.Clock.Time(1/length);"function"!=typeof durations&&(durations=Gibber.Clock.Time(durations)),obj.seq.add({key:"note",values:[props[0]],durations:durations,target:obj}),obj.pattern=obj.seq.seqs[obj.seq.seqs.length-1].values[0]}return"undefined"==typeof props&&(props={}),props.pitch&&(obj.pitch=props.pitch),"undefined"!=typeof props.snare&&($.extend(obj.snare.sampler,props.snare),$.extend(obj.snare,props.snare)),"undefined"!=typeof props.kick&&($.extend(obj.kick.sampler,props.kick),$.extend(obj.kick,props.kick)),"undefined"!=typeof props.hat&&($.extend(obj.hat.sampler,props.hat),$.extend(obj.hat,props.hat)),"undefined"!=typeof props.openHat&&($.extend(obj.openHat.sampler,props.openHat),$.extend(obj.openHat,props.openHat)),obj.amp=isNaN(_amp)?1:_amp,obj.seq&&obj.seq.tick&&Gibberish.future(obj.seq.tick,1),obj.start=function(){obj.seq.start(!0)},obj.stop=function(){obj.seq.stop()},obj.shuffle=function(){obj.note.values.shuffle()},obj.reset=function(){obj.seq.reset()},Gibber.createProxyMethods(obj,["play","stop","shuffle","reset","start","send","note"]),obj.seq.start(!0),Object.defineProperties(obj,{offset:{get:function(){return obj.seq.offset},set:function(e){obj.seq.offset=Gibber.Clock.time(e)}}}),obj},Percussion.EDrums=function(_sequence,_timeValue,_amp,_freq){var args=Array.prototype.slice.call(arguments),obj={},props=Gibber.processArguments(args,"Drums");$.extend(!0,obj,props),obj=Array.isArray(obj)?Gibber.construct(Gibberish.Bus2,obj).connect(Gibber.Master):new Gibberish.Bus2(obj).connect(Gibber.Master),obj.name="XOX",obj.type="Gen",obj.children=[],$.extend(!0,obj,Gibber.Audio.ugenTemplate),obj.fx.ugen=obj,Object.defineProperty(obj,"_",{get:function(){return obj.kill(),obj},set:function(){}}),obj.pitch=1,obj.kick=Gibber.Audio.Percussion.Kick().disconnect(),obj.snare=Gibber.Audio.Percussion.Snare().disconnect(),obj.hat=Gibber.Audio.Percussion.Hat().disconnect(),obj.kick.connect(obj),obj.snare.connect(obj),obj.hat.connect(obj),obj.children.push(obj.kick,obj.snare,obj.hat),obj.mod=obj.polyMod,obj.removeMod=obj.removePolyMod,obj.set=function(e){obj.seq.note=e.split("")},Gibber.createProxyProperties(obj,_mappingProperties.XOX),obj.start=function(){obj.seq.start(!0)},obj.stop=function(){obj.seq.stop()},obj.shuffle=function(){obj.seq.shuffle()},obj.reset=function(){obj.seq.reset()};var kcd=1,scd=1,hcd=1,kf=null,sf=null,hf=null;if(obj.note=function(e){switch(e){case"x":1===kcd&&(kcd=0),obj.kick.note(),null!==kf&&(kf(),kf=null),kf=Gibber.Utilities.future(function(){kcd=1,kf=null},11e4*obj.kick.decay);break;case"o":1===scd&&(scd=0),obj.snare.note(),null!==sf&&(sf(),sf=null),sf=Gibber.Utilities.future(function(){scd=1,sf=null},obj.snare.decay);break;case"*":1===hcd&&(hcd=0),obj.hat.note(5e3),null!==hf&&(hf(),hf=null),hf=Gibber.Utilities.future(function(){hcd=1,hf=null},5500);break;case"-":1===hcd&&(hcd=0),obj.hat.note(3e4),null!==hf&&(hf(),hf=null),hf=Gibber.Utilities.future(function(){hcd=1,hf=null},30500)}},Gibber.createProxyMethods(obj,["play","stop","shuffle","reset","start","send"]),"undefined"!=typeof props)switch($.type(props[0])){case"string":for(var notes=props[0],_seqs=[],_durations=[],__durations=[],seqs=notes.split("|"),timeline={},i=0;i<seqs.length;i++)!function(num){var seq=seqs[num],duration,hasTime=!1,idx=seq.indexOf(",");if(idx>-1){var _value=seq.substr(0,idx),duration=seq.substr(idx+1);duration=eval(duration),hasTime=!0,seq=_value.trim().split("")}else seq=seq.trim().split(""),duration=1/seq.length;if(seq.indexOf(".rnd(")>-1&&(seq=seq.split(".rnd")[0],seq=seq.split("").rnd()),"undefined"!=typeof props[1]){duration=props[1],Array.isArray(duration)||(duration=[duration]);var durationsPattern=Gibber.construct(Gibber.Pattern,duration);if(duration.randomFlag){durationsPattern.filters.push(function(){return[durationsPattern.values[rndi(0,durationsPattern.values.length-1)],1]});for(var i=0;i<duration.randomArgs.length;i+=2)durationsPattern.repeat(duration.randomArgs[i],duration.randomArgs[i+1])}duration=durationsPattern}obj.seq.add({key:"note",values:Gibber.construct(Gibber.Pattern,seq),durations:Gibber.construct(Gibber.Pattern,[duration]),target:obj});var seqNumber=obj.seq.seqs.length-1;Object.defineProperties(obj.note,{values:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].values},set:function(e){var t=Gibber.construct(Gibber.Pattern,e);Array.isArray(t)||(t=[t]),obj.seq.seqs[seqNumber].values=t}},durations:{configurable:!0,get:function(){return obj.seq.seqs[seqNumber].durations},set:function(e){Array.isArray(e)||(e=[e]),obj.seq.seqs[seqNumber].durations=e}}})}(i);break;case"object":"string"==typeof props[0].note&&(props[0].note=props[0].note.split("")),props[0].target=obj,props[0].durations=Gibber.Clock.Time(props[0].durations?props[0].durations:1/props[0].note.length),props[0].offset=props[0].offset?Gibber.Clock.time(props[0].offset):0,obj.seq=Seq(props[0])}return"undefined"==typeof props&&(props={}),props.pitch&&(obj.pitch=props.pitch),"undefined"!=typeof props.snare&&($.extend(obj.snare.sampler,props.snare),$.extend(obj.snare,props.snare)),"undefined"!=typeof props.kick&&($.extend(obj.kick.sampler,props.kick),$.extend(obj.kick,props.kick)),"undefined"!=typeof props.hat&&($.extend(obj.hat.sampler,props.hat),$.extend(obj.hat,props.hat)),"undefined"!=typeof props.openHat&&($.extend(obj.openHat.sampler,props.openHat),$.extend(obj.openHat,props.openHat)),obj.amp=isNaN(_amp)?1:_amp,obj.seq.tick&&Gibberish.future(obj.seq.tick,1),obj.seq.start(!0),obj.toString=function(){return"EDrums : "+obj.seq.seqs[0].values.join("")},obj},Percussion.XOX=Percussion.EDrums,Percussion.Drums.kits={original:{kick:{file:"resources/audiofiles/kick.wav",symbol:"x",amp:1,pitch:1,pan:0},snare:{file:"resources/audiofiles/snare.wav",symbol:"o",amp:1,pitch:1,pan:.15},hat:{file:"resources/audiofiles/hat.wav",symbol:"*",amp:1,pitch:1,pan:-.1},openHat:{file:"resources/audiofiles/openHat.wav",symbol:"-",amp:1,pitch:1,pan:-.2}},electronic:{kick:{file:"resources/audiofiles/electronic/kick.wav",symbol:"x",amp:1.5,pitch:1,pan:0},snare:{file:"resources/audiofiles/electronic/snare.wav",symbol:"o",amp:1.5,pitch:1,pan:.15},hat:{file:"resources/audiofiles/electronic/hat.wav",symbol:"*",amp:1.5,pitch:1,pan:-.1},openHat:{file:"resources/audiofiles/electronic/openhat.wav",symbol:"-",amp:1.5,pitch:1,pan:-.2}},beatbox:{in_tss:{file:"resources/audiofiles/beatbox/^tss.wav",symbol:"T",amp:1,pitch:1,pan:.1},f:{file:"resources/audiofiles/beatbox/f.wav",symbol:"f",amp:1,pitch:1,pan:-.1},h:{file:"resources/audiofiles/beatbox/h.wav",symbol:"h",amp:1,pitch:1,pan:.1},s:{file:"resources/audiofiles/beatbox/s.wav",symbol:"s",amp:1,pitch:1,pan:-.1},d:{file:"resources/audiofiles/beatbox/d.wav",symbol:"d",amp:1,pitch:1,pan:.8},t:{file:"resources/audiofiles/beatbox/t.wav",symbol:"t",amp:1,pitch:1,pan:.4},k:{file:"resources/audiofiles/beatbox/k.wav",symbol:"k",amp:1,pitch:1,pan:-.1},in_k:{file:"resources/audiofiles/beatbox/^k.wav",symbol:"K",amp:1,pitch:1,pan:-.4},eight:{file:"resources/audiofiles/beatbox/8.wav",symbol:"8",amp:1,pitch:1,pan:-.8},psh:{file:"resources/audiofiles/beatbox/psh.wav",symbol:"p",amp:1,pitch:1,pan:.1},in_p:{file:"resources/audiofiles/beatbox/^p.wav",symbol:"P",amp:1,pitch:1,pan:-.1},pf:{file:"resources/audiofiles/beatbox/pf.wav",symbol:"F",amp:1,pitch:1,pan:.2},phs:{file:"resources/audiofiles/beatbox/phs.wav",symbol:"H",amp:1,pitch:1,pan:-.2},b:{file:"resources/audiofiles/beatbox/b.wav",symbol:"b",amp:1,pitch:1,pan:.3},dot:{file:"resources/audiofiles/beatbox/dot.wav",symbol:".",amp:1,pitch:1,pan:0},duf:{file:"resources/audiofiles/beatbox/duf.wav",symbol:"D",amp:1,pitch:1,pan:-.3},o:{file:"resources/audiofiles/beatbox/o.wav",symbol:"o",amp:1,pitch:1,pan:.6},a:{file:"resources/audiofiles/beatbox/a.wav",symbol:"a",amp:1,pitch:1,pan:.8},u:{file:"resources/audiofiles/beatbox/u.wav",symbol:"u",amp:1,pitch:1,pan:-.8},m:{file:"resources/audiofiles/beatbox/m.wav",symbol:"m",amp:1,pitch:1,pan:-.6},n:{file:"resources/audiofiles/beatbox/n.wav",symbol:"n",amp:1,pitch:1,pan:0}}},Percussion.Drums.kits.default=Percussion.Drums.kits.electronic,Percussion.Presets.Kick={"short":{decay:.1,amp:.75}},Percussion.Presets.Snare={crack:{snappy:1,offset:.25}},Percussion}},{"gibberish-dsp":2}],12:[function(e,t){t.exports=function(t){"use strict";for(var i={},n=e("gibberish-dsp"),r=t.dollar,o=(t.Clock,t.outputCurves),s=o.LINEAR,a=(o.LOGARITHMIC,["Line","AD","ADSR"]),u={Line:{start:{min:0,max:1,output:s,timescale:"audio"},end:{min:0,max:1,output:s,timescale:"audio"},time:{min:0,max:8,output:s,timescale:"audio"}},AD:{attack:{min:0,max:8,output:s,timescale:"audio"},decay:{min:0,max:8,output:s,timescale:"audio"},ADSR:{attack:{min:0,max:8,output:s,timescale:"audio"},decay:{min:0,max:8,output:s,timescale:"audio"},sustain:{min:0,max:8,output:s,timescale:"audio"},release:{min:0,max:8,output:s,timescale:"audio"}}}},c=0;c<a.length;c++)!function(){var e=Array.isArray(a[c])?a[c][0]:a[c],o=Array.isArray(a[c])?a[c][1]:a[c];i[o]=function(){var i,s=Array.prototype.slice.call(arguments,0);return i="object"!=typeof s[0]?new n[e](s[0],s[1],t.Clock.time(s[2]),s[3]):t.construct(n[e],s[0]),i.name=o,r.extend(!0,i,t.Audio.ugenTemplate),t.createProxyProperties(i,u[o]),t.processArguments2(i,s,i.name),("AD"===o||"ADSR"===o)&&t.createProxyMethods(i,["run"]),console.log(o+" is created."),i
}}();return i}},{"gibberish-dsp":2}],13:[function(e,t){t.exports=function(t){"use strict";var i={Presets:{}},n=e("gibberish-dsp"),r=t.dollar,o=t.outputCurves,s=o.LINEAR,a=o.LOGARITHMIC;n.Gain=function(){n.extend(this,{name:"gain",type:"effect",properties:{input:0,amount:1},callback:function(e,t){return"object"==typeof e?(e[0]*=t,e[1]*=t):e*=t,e}}).init().processProperties(arguments)},n.Gain.prototype=n._effect;for(var u=["Reverb",["StereoReverb","StereoVerb"],"Delay","Flanger","Vibrato","Distortion","Biquad","Gain","Filter24",["RingModulation","RingMod"],["BufferShuffler","Schizo"],["Decimator","Crush"],"Tremolo"],c={Reverb:{roomSize:{min:.5,max:.995,output:s,timescale:"audio"},damping:{min:0,max:1,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},StereoReverb:{roomSize:{min:.5,max:.995,output:s,timescale:"audio"},damping:{min:0,max:1,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Delay:{feedback:{min:0,max:1,output:s,timescale:"audio"},time:{min:50,max:88200,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},RingMod:{frequency:{min:20,max:3e3,output:s,timescale:"audio"},amp:{min:0,max:1,output:s,timescale:"audio"},mix:{min:0,max:1,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Flanger:{rate:{min:.01,max:20,output:a,timescale:"audio"},feedback:{min:0,max:.99,output:s,timescale:"audio"},amount:{min:25,max:300,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Gain:{amount:{min:0,max:1,output:s,timescale:"audio"}},Vibrato:{rate:{min:.2,max:8,output:a,timescale:"audio"},amount:{min:25,max:300,output:s,timescale:"audio"},feedback:{min:.45,max:.55,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Filter24:{cutoff:{min:0,max:.7,output:s,timescale:"audio"},resonance:{min:0,max:5.5,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},LPF:{cutoff:{min:.05,max:.7,output:s,timescale:"audio"},resonance:{min:0,max:5.5,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},HPF:{cutoff:{min:0,max:.7,output:s,timescale:"audio"},resonance:{min:0,max:5.5,output:s,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Crush:{bitDepth:{min:1,max:16,output:s,timescale:"audio"},sampleRate:{min:0,max:1,output:s,timescale:"audio"},amp:{min:0,max:1,output:a,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Schizo:{amp:{min:0,max:1,output:a,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}},Tremolo:{amp:{min:0,max:1,output:a,timescale:"audio"},frequency:{min:.05,max:20,output:a,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}}},l=0;l<u.length;l++)!function(){var e=Array.isArray(u[l])?u[l][0]:u[l],o=Array.isArray(u[l])?u[l][1]:u[l];i[o]=function(){var i,s=Array.prototype.slice.call(arguments,0);return i=new n[e],i.type="FX",i.name=o,r.extend(!0,i,t.Audio.ugenTemplate),t.createProxyProperties(i,c[o]),t.createProxyMethods(i,["send"]),t.processArguments2(i,s,i.name),s.input=0,i.toString=function(){return"> "+o},i.presetInit&&i.presetInit(),i}}();return i.Chorus=function(e,t,i){var n=e||1,r=i||ms(1),o=t||0,s=Flanger(n,o,r,30*ms(1));return s.name="Chorus",s.type="FX",s},i.LPF=function(e,t){var i=isNaN(e)?.2:e,n=isNaN(t)?3.5:t,r=Filter24(i,n,!0);return r.name="LPF",r.type="FX",r},i.HPF=function(e,t){var i=isNaN(e)?.25:e,n=isNaN(t)?3.5:t,r=Filter24(i,n,!0);return r.isLowPass=!1,r.name="HPF",r.type="FX",r},i.Presets.Schizo={sane:{chance:.1,reverseChance:0,pitchChance:.5,mix:.5},borderline:{chance:.1,pitchChance:.25,reverseChance:.5,mix:1},paranoid:{chance:.2,reverseChance:.5,pitchChance:.5,mix:1}},i.Presets.Reverb={space:{roomSize:.99,damping:.23,wet:.75,dry:.25},small:{roomSize:.6,damping:.75,wet:.15,dry:.85},medium:{roomSize:.8,damping:.5,wet:.35,dry:.65},large:{roomSize:.85,damping:.3,wet:.55,dry:.45}},i.Presets.StereoVerb={space:{roomSize:.99,damping:.23,wet:.75,dry:.25},small:{roomSize:.6,damping:.75,wet:.15,dry:.85},medium:{roomSize:.8,damping:.5,wet:.35,dry:.65},large:{roomSize:.85,damping:.3,wet:.55,dry:.45}},i.Presets.Crush={clean:{sampleRate:1,bitDepth:16},dirty:{sampleRate:.25,bitDepth:4},filthy:{sampleRate:.1,bitDepth:2.5}},i}},{"gibberish-dsp":2}],14:[function(e,t){t.exports=function(e){e.apiKey="4287s0onpqpp492n8snr27sp3o228nns".replace(/[a-zA-Z]/g,function(e){return String.fromCharCode(("Z">=e?90:122)>=(e=e.charCodeAt(0)+13)?e:e-26)});var t=function(){var i,n,r=Sampler(),o=arguments[0]||96541,s=null;r.done=function(e){s=e};var a=function(e){Gibber.log(i+" loaded."),Gibber.Audio.Core.context.decodeAudioData(e.response,function(e){t.loaded[i]=e.getChannelData(0),r.buffer=t.loaded[i],r.bufferLength=r.buffer.length,r.isLoaded=!0,r.end=r.bufferLength,r.setBuffer(r.buffer),r.setPhase(r.bufferLength),r.filename=i,r.send(Master,1),s&&s()},function(e){console.log("Error with decoding audio data"+e.err)})};if("string"==typeof o){var u=o;Gibber.log("searching freesound for "+u),e.search(u,0,"duration:[0.0 TO 10.0]","rating_desc",null,null,null,function(n){if(i=n.sounds[0].original_filename,"undefined"==typeof t.loaded[i]){var o=new XMLHttpRequest;Gibber.log("now downloading "+i+", "+n.sounds[0].duration+" seconds in length"),o.open("GET",n.sounds[0].serve+"?&api_key="+e.apiKey,!0),o.responseType="arraybuffer",o.onload=function(){a(o)},o.send()}else r.buffer=t.loaded[i],r.filename=i,r.bufferLength=r.buffer.length,r.isLoaded=!0,r.end=r.bufferLength,r.setBuffer(r.buffer),r.setPhase(r.bufferLength),r.send(Master,1),s&&s()},function(){displayError("Error while searching...")})}else if("object"==typeof o){var u=o.query,c=o.filter||"",l=o.sort||"rating_desc",p=o.page||0;pick=o.pick||0,Gibber.log("searching freesound for "+u),c+=" duration:[0.0 TO 10.0]",e.search(u,p,c,l,null,null,null,function(u){if(u.num_results>0){var c=0;"number"==typeof o.pick?c=o.pick:"function"==typeof o.pick?c=o.pick():"random"===o.pick&&(c=rndi(0,u.sounds.length)),i=u.sounds[c].original_filename,"undefined"==typeof t.loaded[i]?(n=new XMLHttpRequest,Gibber.log("now downloading "+i+", "+u.sounds[c].duration+" seconds in length"),n.open("GET",u.sounds[c].serve+"?&api_key="+e.apiKey,!0),n.responseType="arraybuffer",n.onload=function(){a(n)},n.send()):(Gibber.log("using exising loaded sample "+i),r.buffer=t.loaded[i],r.bufferLength=r.buffer.length,r.isLoaded=!0,r.end=r.bufferLength,r.setBuffer(r.buffer),r.setPhase(r.bufferLength),r.send(Master,1),s&&s())}else Gibber.log("No Freesound files matched your query.")},function(){console.log("Error while searching...")})}else"number"==typeof o&&(Gibber.log("downloading sound #"+o+" from freesound.org"),e.get_sound(o,function(t){n=new XMLHttpRequest,i=t.original_filename,n.open("GET",t.serve+"?api_key="+e.apiKey,!0),n.responseType="arraybuffer",n.onload=function(){a(n)},n.send()}));return r};return t.loaded={},t}},{}],15:[function(e,t){t.exports=function(t){"use strict";for(var i=t.dollar,n={Presets:{}},r=e("gibberish-dsp"),o=t.outputCurves,s=o.LINEAR,a=o.LOGARITHMIC,u=["Sine","Triangle","Saw","Square","Noise","PWM"],c={frequency:{min:50,max:3200,hardMin:.01,hardMax:22050,output:a,timescale:"audio",dimensions:1},amp:{min:0,max:1,hardMax:2,output:a,timescale:"audio",dimensions:1},pulsewidth:{min:.01,max:.99,output:s,timescale:"audio",dimensions:1},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1},pan:{min:-1,max:1,output:a,timescale:"audio"},note:{min:50,max:3200,hardMin:.01,hardMax:22050,output:a,timescale:"audio",doNotProxy:!0}},l=0;l<u.length;l++)!function(){var e=Array.isArray(u[l])?u[l][0]:u[l],o=Array.isArray(u[l])?u[l][1]:u[l];n[o]=function(){var n=(new r[e]).connect(t.Master),s=Array.prototype.slice.call(arguments,0);n.type="Gen",i.extend(!0,n,t.Audio.ugenTemplate),n.fx.ugen=n,Object.defineProperty(n,"_",{get:function(){return n.kill(),n},set:function(){}}),"undefined"==typeof n.note&&(n.note=function(e){var t=this.frequency();"number"==typeof t||"function"==typeof t?this.frequency="function"==typeof e?e():e:t[0]=e}),n.name=o,t.createProxyProperties(n,c);var a=["note","send"];return"Sampler"===o&&a.push("pickBuffer"),t.createProxyMethods(n,a),t.processArguments2(n,s,o),n.toString=function(){return"> "+o},n}}();return n.Wavetable=function(e){var n=(new r.Table).connect(t.Master);return e&&n.setTable(e),n.type="Gen",i.extend(!0,n,t.Audio.ugenTemplate),n.fx.ugen=n,Object.defineProperty(n,"_",{get:function(){return n.kill(),n},set:function(){}}),"undefined"==typeof n.note&&(n.note=function(e){var t=this.frequency();"number"==typeof t||"function"==typeof t?this.frequency="function"==typeof e?e():e:t[0]=e}),t.createProxyProperties(n,{frequency:{min:50,max:3200,output:a,timescale:"audio",dimensions:1},amp:{min:0,max:1,output:a,timescale:"audio",dimensions:1},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}}),t.createProxyMethods(n,["note"]),obj.toString=function(){return"> Wavetable"},n},n.Grains=function(){var e,n="object"==typeof arguments[0]?arguments[0]:arguments[1],o=n.bufferLength||88200,s=Sampler().record(n.input,o);if("string"==typeof arguments[0]){var a=t.Presets.Grains[arguments[0]];"undefined"!=typeof n&&i.extend(a,n),e=new r.Granulator(a)}else e=new r.Granulator(n);return e.loop=function(e,i,n,o){var s=this.position;e=isNaN(e)?.25:e,i=isNaN(i)?.75:i,n=t.Clock.time(isNaN(n)?1:n),o="undefined"==typeof o?!0:o,this.position=new r.Line(e,i,n,o);var a=this;o===!1&&future(function(){a.position=s},t.Clock.time(n))},future(function(){e.setBuffer(s.getBuffer()),e.connect(),e.loop(0,1,o),s.disconnect()},o+1),e.type="Gen",i.extend(!0,e,t.Audio.ugenTemplate),e.fx.ugen=e,Object.defineProperty(e,"_",{get:function(){return e.disconnect(),e},set:function(){}}),e.toString=function(){return"Grains"},e},n.Presets.Grains={tight:{numberOfGrains:10,grainSize:1100,positionMin:-.05,positionMax:.05,speedMin:-.1,speedMax:.1,shouldReverse:!1},cloudy:{numberOfGrains:20,positionMin:-.25,positionMax:.25,speedMin:-.1,speedMax:4,grainSize:4400,shouldReverse:!0},flurry:{speed:2,speedMin:-2,speedMax:2,position:0,positionMin:0,positionMax:0,numberOfGrains:20,grainSize:1100}},n}},{"gibberish-dsp":2}],16:[function(e,t){t.exports=function(){"use strict";var t,i=e("gibberish-dsp"),n=null,r=null,o=null,s=t={Compressor:function(e){if(null===n){n=i.context.createDynamicsCompressor();var t=n.threshold,r=n.ratio,o=n.attack,a=n.release;Object.defineProperties(n,{threshold:{get:function(){return t.value},set:function(e){t.value=e}},ratio:{get:function(){return r.value},set:function(e){r.value=e}},attack:{get:function(){return o.value},set:function(e){o.value=e}},release:{get:function(){return a.value},set:function(e){a.value=e}}}),s.insert(n,e)}return n},LowShelf:function(e){if(null===o){o=i.context.createBiquadFilter(),o.type=3,o.frequency.value=220,o.Q.value=0,o.gain.value=6;var t=o.gain,n=o.frequency,r=o.Q;Object.defineProperties(o,{frequency:{get:function(){return n.value},set:function(e){n.value=e}},gain:{get:function(){return t.value},set:function(e){t.value=e}},Q:{get:function(){return r.value},set:function(e){r.value=e}}}),s.insert(o,e)}return o},HiShelf:function(e){if(null===r){r=i.context.createBiquadFilter(),r.type=4,r.frequency.value=880,r.Q.value=0,r.gain.value=6;var t=r.gain,n=r.frequency,o=r.Q;Object.defineProperties(r,{frequency:{get:function(){return n.value},set:function(e){n.value=e}},gain:{get:function(){return t.value},set:function(e){t.value=e}},Q:{get:function(){return o.value},set:function(e){o.value=e}}}),s.insert(r,e)}return r}};return t}},{"gibberish-dsp":2}],17:[function(e,t){t.exports=function(t){"use strict";var i={Presets:{}},n=e("gibberish-dsp"),r=t.dollar,o=e("./clock")(t),s=t.outputCurves,a=s.LINEAR,u=s.LOGARITHMIC,c={amp:{min:0,max:1,hardMax:2,output:u,timescale:"audio",dimensions:1},start:{min:0,max:1,output:a,timescale:"audio",dimensions:1},end:{min:0,max:1,output:a,timescale:"audio",dimensions:1},pitch:{min:1,max:4,hardMin:.01,hardMax:20,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1},pan:{min:-1,max:1,output:u,timescale:"audio"},note:{min:.1,max:4,output:u,timescale:"audio",doNotProxy:!0}};return i.Sampler=function(){var e=Array.prototype.slice.call(arguments,0),i=e[0]&&e[0].file?e[0].file:void 0,o=new n.Sampler(i).connect(t.Master);name="Sampler",o.type="Gen",r.extend(!0,o,t.Audio.ugenTemplate),o.fx.ugen=o,Object.defineProperty(o,"_",{get:function(){return o.kill(),o},set:function(){}}),"undefined"==typeof o.note&&(o.note=function(e){var t=this.frequency();"number"==typeof t||"function"==typeof t?this.frequency="object"==typeof e?e.value:e:t[0]=e});var s=o.__lookupSetter__("start").bind(o),a=0;Object.defineProperty(o,"start",{configurable:!0,get:function(){return a},set:function(e){return a=1>=e?e*o.bufferLength:e,s(a),a}});var u=o.__lookupSetter__("end").bind(o),l=1;Object.defineProperty(o,"end",{configurable:!0,get:function(){return l},set:function(e){return l=1>=e?e*o.bufferLength:e,u(l),l}}),t.createProxyProperties(o,c);var p=["note","pickBuffer"];return t.createProxyMethods(o,p),t.processArguments2(o,e,name),o.toString=function(){return name},o},n.Sampler.prototype.readFile=function(e){var t=this;if(e.isFile)return void e.file(function(e){t.readFile(e)});var i=new FileReader;i.readAsArrayBuffer(e),i.onload=function(){n.context.decodeAudioData(i.result,function(i){var r=i.getChannelData(0);t.setBuffer(r),t.length=t.end=r.length,t.buffers[e.name]=r,t.isPlaying=!0,console.log("LOADED",e.name,r.length),n.audioFiles[e.name]=r,t.onload&&t.onload(),0!==t.playOnLoad&&t.note(t.playOnLoad),t.isLoaded=!0})}},n.Sampler.prototype.ondrop=function(e){for(var t=0;t<e.length;t++)!function(i){{var n,r=e[t];new FileReader}if(n=r.webkitGetAsEntry(),n.isDirectory){var o=n.createReader();o.readEntries(function(e){for(var t=e.length;t--;)i.readFile(e[t])})}else i.readFile(n)}(this)},n.Sampler.prototype.pickBuffer=function(){this.switchBuffer(rndi(0,this.getNumberOfBuffers()))},n.Sampler.prototype.record=function(e,i){this.isRecording=!0,console.log("starting recording");var r=this;return this.recorder=new n.Record(e,t.Clock.time(i),function(){console.log("recording finished"),r.setBuffer(this.getBuffer()),r.length=r.end=r.getBuffer().length,r.setPhase(r.length),r.isRecording=!1}).record(),this},i.Looper=function(e,i,n){var s=Bus();r.extend(s,{children:[],input:e,length:o.time(i),numberOfLoops:n,pitch:1,currentLoop:0,loop:function(){s.children[s.currentLoop].record(s.input,s.length);var e={target:s.children[s.currentLoop],durations:s.length,key:"note",values:[null]};return s.seq.add(e),s.seq.start(),future(s.nextLoop,i),s},nextLoop:function(){s.children[++s.currentLoop].record(s.input,s.length),s.currentLoop<s.numberOfLoops-1&&future(s.nextLoop,i);var e={target:s.children[s.currentLoop],durations:s.length,key:"note",values:[null]};s.seq.add(e)}});var a=1;Object.defineProperty(s,"pitch",{configurable:!0,get:function(){return a},set:function(e){a=e;for(var t=0;t<s.children.length;t++)s.children[t].pitch=a}});for(var u=0;n>u;u++)s.children.push(Sampler({pitch:s.pitch})._),s.children[u].send(s,1);return t.createProxyProperties(s,{pitch:c.pitch}),s.stop=function(){s.seq.stop()},s.play=function(){s.seq.play()},s},i}},{"./clock":10,"gibberish-dsp":2}],18:[function(e,t){t.exports=function(t){"use strict";var i=e("gibberish-dsp"),n=t.dollar,r={start:function(){return this.codeblock||this.connect(),this.isPaused=!1,this},stop:function(){return this.isPaused=!0,this},loop:function(e){return this.loopPause=e||0,this.shouldLoop=!this.shouldLoop,this},pause:function(){return this.isPaused=!0,this},next:function(){return this.codeblock||this.connect(),this.isPaused=!1,this}},o=new i.ugen;n.extend(o,r);var s=function(e,i){if(!(this instanceof s)){var r=Array.prototype.slice.call(arguments,0);return t.construct(s,r)}"undefined"==typeof i&&(i={}),this.timeline=[],this.schedule=[],this.shouldLoop=!1,this.loopPause=0;for(var o=0;o<e.length;o+=2)this.schedule.push(e[o]),this.timeline.push(e[o+1]);var a=0,u=0,c=this.timeline,l=this.schedule,p=this,f=function(){p.nextTime=a=0,u=-1,p.timeline.pop()};n.extend(this,{properties:{rate:1,isPaused:!0,nextTime:0},name:"score",getIndex:function(){return u},callback:function(e,t,i){if(!t){if(a>=i&&u<c.length){var n=c[u],r=!0;if(u++,u<=c.length-1){var o=l[u];"number"==typeof o&&o!==s.wait?p.nextTime=a+o:o===s.wait?p.isPaused=!0:o.owner instanceof s&&(p.isPaused=!0,o.owner.oncomplete.listeners.push(p))}else p.shouldLoop?(c[c.length-1]!==f&&c.push(f),p.nextTime=a+p.loopPause):p.isPaused=!0,p.oncomplete();r&&n&&(n instanceof s?n.codeblock?n.rewind().next():n.start():n())}a+=e}return 0},rewind:function(){return a=u=0,this.nextTime=this.schedule[0],this},oncomplete:function(){for(var e=this.oncomplete.listeners,t=e.length-1;t>=0;t--){var i=e[t];i instanceof s&&i.next()}}}),this.oncomplete.listeners=[],this.oncomplete.owner=this,this.init(),this.nextTime=this.schedule[0];var h=this.rate,b=this.__lookupSetter__("rate");Object.defineProperty(this,"rate",{get:function(){return h},set:function(e){h=Mul(t.Clock,e),b.call(this,h)}}),this.rate=this.rate,t.createProxyProperties(this,{rate:{min:.1,max:2,output:0,timescale:"audio"}})};return s.wait=-987654321,s.combine=function(){for(var e=[0,arguments[0]],t=1;t<arguments.length;t++){var i=2*t,n=i+1,r=i-1;e[i]=e[r].oncomplete,e[n]=arguments[t]}return s(e)},s.prototype=o,s}},{"gibberish-dsp":2}],19:[function(e,t){t.exports=function(t){var i=e("gibberish-dsp"),n=t.dollar,r=["durations","target","scale","offset","doNotStart","priority"],o=function(){var e,s={},a=[];if("object"!=typeof arguments[0]||Array.isArray(arguments[0]))("function"==typeof arguments[0]||Array.isArray(arguments[0]))&&(s.seqs=[{key:"functions",values:Array.isArray(arguments[0])?arguments[0]:[arguments[0]],durations:t.Clock.time(arguments[1])}],("function"==typeof arguments[1]||Array.isArray(arguments[1]))&&(s.seqs[0].durations=arguments[1]),a.push("functions"));else{var u=arguments[0],c=(typeof u.durations,typeof u.target,u.priority);if(s.target=u.target,"object"==typeof u.scale&&(s.scale=u.scale),"number"==typeof u.offset&&(s.offset=t.Clock.time(u.offset)),s.durations=u.durations,s.keysAndValues={},s.seqs=[],s.autofire=[],s.durations){Array.isArray(s.durations)||(s.durations=[s.durations]);var l=t.construct(t.Pattern,s.durations);if(s.durations.randomFlag){l.filters.push(function(){var e=t.Utilities.rndi(0,l.values.length-1);return[l.values[e],1,e]});for(var p=0;p<s.durations.randomArgs.length;p+=2)l.repeat(s.durations.randomArgs[p],s.durations.randomArgs[p+1])}}for(var f in u)!function(){var i=f;if(-1===r.indexOf(i)){var n,o=Array.isArray(u[i]),p={key:i,target:s.target,durations:l};if(o?n=t.construct(t.Pattern,u[i]):"undefined"!=typeof u[i]&&(n=t.construct(t.Pattern,[u[i]])),u[i].randomFlag){n.filters.push(function(){var e=t.Utilities.rndi(0,n.values.length-1);return[n.values[e],1,e]});for(var h=0;h<u[i].randomArgs.length;h+=2)n.repeat(u[i].randomArgs[h],u[i].randomArgs[h+1])}"note"===i&&n.filters.push(function(){var e=arguments[0][0];return e<t.minNoteFrequency&&(e=s.scale?s.scale.notes[e]:t.scale.notes[e]),[e,arguments[0][1],arguments[0][2]]}),p.values=n,p.stop=function(){p.shouldStop=!0},p.start=function(){p.shouldStop=!1,e.timeline[0]=[p],e.nextTime=0,e.isRunning||e.start(!1,c)},p.repeat=function(e){var t=0,i=function(i,n){return i[2]%(n.getLength()-1)===0&&0!==i[2]&&(t++,t===e&&n.seq.stop()),i};n.filters.push(i)},n.seq=p,s.seqs.push(p),a.push(i)}}();if("scale"in s){var h=(a.indexOf("note"),a.indexOf("chord"));if(h>-1){var b=n.extend([],s.seqs[h]),d=0;s.seqs[h]=[function(){var e,t=[];return e="function"==typeof b.pick?b[b.pick()]:"function"==typeof b[d]?b[d]():b[d++],t=s.scale.chord(e),d>=b.length&&(d=0),t}]}}}e=new i.PolySeq(s),e.timeModifier=t.Clock.time.bind(t.Clock),e.name="Seq",e.save={},e.oldShuffle=e.shuffle,delete e.shuffle,e.rate=t.Clock;var m=e.__lookupSetter__("rate"),g=e.rate;Object.defineProperty(e,"rate",{get:function(){return g},set:function(i){g=Mul(t.Clock,i),m.call(e,g)}});var y=e.nextTime,v=e.__lookupSetter__("nextTime");Object.defineProperty(e,"nextTime",{get:function(){return y},set:function(e){y=t.Clock.time(e),v(y)}});var x=e.offset;Object.defineProperty(e,"offset",{get:function(){return x},set:function(t){x=t,e.nextTime+=x}}),e.nextTime+=e.offset;for(var p=0;p<a.length;p++)!function(e){var t=a[p],i=p;Object.defineProperty(e,t,{get:function(){return e.seqs[i].values},set:function(t){e.seqs[i].values=t}})}(e);var G=l;return Object.defineProperty(e,"durations",{get:function(){return G},set:function(t){G=t;for(var i=0;i<e.seqs.length;i++){var n=e.seqs[i];n.durations=G}}}),arguments[0]&&!arguments[0].doNotStart&&e.start(!0),e.toString=function(){return"> Seq"},e.gibber=!0,n.extend(e,{constructor:o,replaceWith:function(){this.kill()},kill:function(){this.target&&this.target.sequencers&&this.target.sequencers.splice(this.target.sequencers.indexOf(this),1),console.log("SEQ KILL",this),this.stop().disconnect(),o.children.splice(o.children.indexOf(this),1)},applyScale:function(){},once:function(){return this.repeat(1),this},reset:function(){for(var e=0;e<this.seqs.length;e++)this.seqs[e].values[0].reset()},shuffle:function(){for(var e=0;e<this.seqs.length;e++)this.seqs[e].values[0].shuffle()}}),o.children.push(e),e};o.children=[];var s=function(){var e,i=arguments[0];return i.root=i.root||"c4",i.mode=i.mode||"aeolian",e=t.Theory.Scale(i.root,i.mode),delete i.root,delete i.mode,i.scale=e,o(i)},a={Seq:o,ScaleSeq:s};return a}},{"gibberish-dsp":2}],20:[function(e,t){t.exports=function(t,i){var n,r=e("gibberish-dsp"),o=t.outputCurves,s=e("./theory")(t).Teoria,a=(o.LINEAR,o.LOGARITHMIC),u={amp:{min:0,max:1,hardMax:2,output:a,timescale:"audio",dimensions:1}},c=function(e,t){return e*Math.pow(2,t/1200)};n={piano:"acoustic_grand_piano",guitar:"electric_guitar_clean",bass:"acoustic_bass",organ:"rock_organ",brass:"synth_brass_1",strings:"synth_strings_1",choir:"choir_aahs"};var l=function(e){var i,o=l.path;return t.Environment&&t.Environment.Storage.values.soundfonts&&t.Environment.Storage.values.soundfonts[e]&&(o=t.Environment.Storage.values.soundfonts[e]),n[e]&&(e=n[e]),i=new r.SoundFont(arguments[0],o).connect(t.Master),$.extend(!0,i,t.Audio.ugenTemplate),i.fx.ugen=i,i.chord=t.Theory.chord,Object.defineProperty(i,"_",{get:function(){return i.kill(),i},set:function(){}}),i.onload=function(){if(t.Environment&&t.Environment.Storage.values.saveSoundFonts){if(t.Environment.Storage.values.soundfonts){if(t.Environment.Storage.values.soundfonts[e])return}else t.Environment.Storage.values.soundfonts={};t.Environment.Storage.values.soundfonts[e]=t.Audio.Core.SoundFont.storage[e];try{t.Environment.Storage.save()}catch(i){console.log("STORAGE ERROR",i),"QuotaExceededError"===i.name&&console.log("Your localStorage for Gibber has been exceeded; we can't save the soundfile. It is still usable.")}}},i._note=i.note.bind(i),i.note=function(e,n){if("number"==typeof e){if(e<t.minNoteFrequency){var r=this.scale||t.scale,o=r.notes[e];if(this.octave&&0!==this.octave)for(var a=this.octave>0?1:0,u=Math.abs(this.octave),l=0;u>l;l++)o*=a?2:.5;e=o}var p,f=s.frequency.note(e),h=0;if(1===f.note.accidental.value&&"b"!==f.note.accidental.sign)for(var b=f.note.enharmonics(),l=0;l<b.length;l++){var d=b[l];if("b"===d.accidental.sign){f.note=d;break}}h=f.cents,p=f.note.name.toUpperCase(),0!==f.note.accidental.value&&(p+=f.note.accidental.sign),p+=f.note.octave,e=p}i._note(e,isNaN(n)?1:n,c(1,h))},t.createProxyProperties(i,u),t.createProxyMethods(i,["note","chord","send"]),i};return l.path=i||"../../../resources/soundfonts/",l}},{"./theory":22,"gibberish-dsp":2}],21:[function(e,t){t.exports=function(t){"use strict";for(var i={Presets:{}},n=e("gibberish-dsp"),r=t.dollar,o=e("./clock")(t),s=t.outputCurves,a=s.LINEAR,u=s.LOGARITHMIC,c=[["PolySynth","Synth"],["PolyFM","FM"],["PolySynth2","Synth2"],["MonoSynth","Mono"],["PolyKarplusStrong","Pluck"]],l={Synth:{note:{min:50,max:3200,output:u,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:u,timescale:"audio"},amp:{min:0,max:1,output:u,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:a,timescale:"audio"},attack:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},decay:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},sustain:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},release:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},pan:{min:-1,max:1,output:u,timescale:"audio"},sustainLevel:{min:.01,max:1,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1}},Synth2:{note:{min:50,max:3200,output:u,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:a,timescale:"audio"},amp:{min:0,max:1,output:u,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:a,timescale:"audio"},attack:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},decay:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},sustain:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},release:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},sustainLevel:{min:.01,max:1,output:u,timescale:"audio"},cutoff:{min:0,max:.7,output:a,timescale:"audio"},resonance:{min:0,max:5.5,output:a,timescale:"audio"},pan:{min:-1,max:1,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1}},Mono:{note:{min:50,max:3200,output:u,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:a,timescale:"audio"},amp:{min:0,max:1,output:u,timescale:"audio"},pulsewidth:{min:.01,max:.99,output:a,timescale:"audio"},attack:{min:o.maxMeasures+1,max:176400,output:u,timescale:"audio"},decay:{min:o.maxMeasures+1,max:176400,output:u,timescale:"audio"},cutoff:{min:0,max:.7,output:a,timescale:"audio"},detune2:{min:0,max:.15,output:a,timescale:"audio"},detune3:{min:0,max:.15,output:a,timescale:"audio"},glide:{min:.99,max:.999995,output:a,timescale:"audio"},resonance:{min:0,max:5.5,output:a,timescale:"audio"},pan:{min:-1,max:1,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1}},FM:{note:{min:50,max:3200,output:u,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:a,timescale:"audio"},amp:{min:0,max:1,output:u,timescale:"audio"},attack:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},decay:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},sustain:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},release:{min:o.maxMeasures+1,max:176400,output:a,timescale:"audio"},sustainLevel:{min:.01,max:1,output:u,timescale:"audio"},cmRatio:{min:.1,max:50,output:a,timescale:"audio"},index:{min:.1,max:50,output:a,timescale:"audio"},pan:{min:-1,max:1,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1}},Pluck:{note:{min:50,max:3200,output:u,timescale:"audio",doNotProxy:!0},frequency:{min:50,max:3200,output:a,timescale:"audio"},amp:{min:0,max:1,output:u,timescale:"audio"},blend:{min:0,max:1,output:a,timescale:"audio"},damping:{min:0,max:1,output:a,timescale:"audio"},pan:{min:-1,max:1,output:u,timescale:"audio"},out:{min:0,max:1,output:a,timescale:"audio",dimensions:1}}},p=0;p<c.length;p++)!function(){var e=Array.isArray(c[p])?c[p][0]:c[p],o=Array.isArray(c[p])?c[p][1]:c[p];i[o]=function(){{var i,s=Array.prototype.slice.call(arguments,0),a={};"string"==typeof s[0]?1:0}t.processArguments2(a,s,o);for(var u in a)t.Audio.Clock.timeProperties.indexOf(u)>-1&&(a[u]=t.Clock.time(a[u]));if(i=new n[e](a).connect(t.Master),i.type="Gen",r.extend(!0,i,t.Audio.ugenTemplate),i.fx.ugen=i,"Vocoder"===o)return i;if("Mono"===o&&(i.note=function(e,t){"undefined"!=typeof t&&0!==t&&(this.amp=t),0!==t&&("object"!=typeof this.frequency?this.frequency=e:"property"!==this.frequency.type?(this.frequency[0]=e,n.dirty(this)):this.frequency=e,this.lastFrequency=this.frequency,i.envelope.getState()>0&&i.envelope.run())}),i._note=i.note.bind(i),i.note=function(){var e=Array.prototype.splice.call(arguments,0);if("string"==typeof e[0])e[0]=t.Theory.Teoria.note(e[0]).fq();else if(e[0]<t.minNoteFrequency){var n=i.scale||t.scale,r=n.notes[e[0]];if(i.octave&&0!==i.octave)for(var o=i.octave>0?1:0,s=Math.abs(i.octave),a=0;s>a;a++)r*=o?2:.5;e[0]=r}return this._note.apply(this,e),this},i.chord=t.Theory.chord,Object.defineProperty(i,"_",{get:function(){return i.kill(),i},set:function(){}}),t.createProxyProperties(i,l[o]),i.trig=function(){this.note(this.lastFrequency)},t.createProxyMethods(i,["note","chord","send","trig"]),i.name=o,i.toString=function(){return o},"Mono"!==o){var c=i._frequency;Object.defineProperty(i,"frequency",{configurable:!0,get:function(){return this._frequency},set:function(e){if(c=e,this.children)for(var t=0;t<this.children.length;t++)"number"==typeof this.children[t].frequency?this.children[t].frequency=c:this.children[t].frequency[0]=c}})}var p=i.scale;return i.scale&&(i.seq.scale=p),Object.defineProperty(i,"scale",{get:function(){return p},set:function(e){p=e,i.seq.scale=p}}),i.presetInit&&i.presetInit(),i}}();return i.Presets.Synth={"short":{attack:44,decay:1/16},bleep:{waveform:"Sine",attack:44,decay:1/16},bleepEcho:{waveform:"Sine",attack:44,decay:1/16,presetInit:function(){this.fx.add(Delay(1/6,.85))}},cascade:{waveform:"Sine",maxVoices:10,attack:o.maxMeasures,decay:o.beats(1/32),presetInit:function(){this.fx.add(t.Audio.FX.Delay(1/9,.2),t.Audio.FX.Flanger()),this.pan=Sine(.25,1)._}},rhodes:{waveform:"Sine",maxVoices:4,attack:44,decay:1,presetInit:function(){this.fx.add(t.Audio.FX.Tremolo(2,.2))}},calvin:{waveform:"PWM",maxVoices:4,amp:.075,attack:o.maxMeasures,decay:.25,presetInit:function(){this.fx.add(t.Audio.FX.Delay(1/6,.5),t.Audio.FX.Vibrato())}},warble:{waveform:"Sine",attack:o.maxMeasures,presetInit:function(){this.fx.add(t.Audio.FX.Vibrato(2),t.Audio.FX.Delay(1/6,.75))}}},i.Presets.Synth2={pad2:{waveform:"Saw",maxVoices:4,attack:1.5,decay:.5,cutoff:.3,filterMult:.35,resonance:4.5,amp:.2,presetInit:function(){this.fx.add(t.Audio.FX.Delay(1/9,.75))}},pad4:{waveform:"Saw",maxVoices:4,attack:2,decay:2,cutoff:.3,filterMult:.35,resonance:4.5,amp:.2,presetInit:function(){this.fx.add(t.Audio.FX.Delay(1/9,.75))}}},i.Presets.Mono={"short":{attack:44,decay:1/16},lead:{presetInit:function(){this.fx.add(t.Audio.FX.Delay(.25,.35),t.Audio.FX.Reverb())},attack:1/8,decay:.5,octave3:0,cutoff:.2,filterMult:.5,resonance:5,isLowPass:!1},winsome:{presetInit:function(){this.lfo=t.Audio.Oscillators.Sine(.234375)._,this.lfo.amp=.075,this.lfo.frequency=2,this.cutoff=this.lfo,this.detune2=this.lfo},attack:o.maxMeasures,decay:1,cutoff:.2},bass:{attack:o.maxMeasures,decay:1/8-o.maxMeasures,octave:-2,octave2:-1,cutoff:.5,filterMult:.2,resonance:1},bass2:{attack:o.maxMeasures,decay:1/6,octave:-2,octave2:0,octave3:0,cutoff:.5,filterMult:.2,resonance:1,amp:.65},easy:{attack:o.maxMeasures,decay:2,octave2:0,octave3:0,cutoff:.3,glide:.9995},easyfx:{attack:o.maxMeasures,decay:2,presetInit:function(){this.fx.add(t.Audio.FX.Delay(o.time(1/6),.3))},amp:.3,octave2:0,octave3:0,cutoff:.3,glide:.9995},dark:{resonance:0,attack:44,cutoff:.075,amp:.35,filterMult:0},dark2:{filterMult:.1,attack:o.maxMeasures,octave2:0,octave3:0,decay:.25,amp:.45},noise:{resonance:20,decay:.5,cutoff:.3,glide:.99995,detune3:0,detune2:0,filterMult:0,presetInit:function(){this.fx.add(t.Audio.FX.Gain(.1),t.Audio.FX.Delay(1/6,.35))}}},i.Presets.FM={stabs:{maxVoices:4,cmRatio:1/1.0007,index:5,attack:o.maxMeasures,decay:1/8,amp:.1,presetInit:function(){this.bus=t.Audio.Busses.Bus().fx.add(t.Audio.FX.Delay(1/8,.75),t.Audio.FX.LPF({resonance:4})),this.bus.fx[1].cutoff=t.Audio.Core.Binops.Add(.25,t.Audio.Oscillators.Sine(.1,.2)._),this.send(this.bus,.65)}},bass:{cmRatio:1,index:3,presetInit:function(){this.attack=ms(1)},decay:1/16,octave:-2},glockenspiel:{cmRatio:3.5307,index:1,attack:44,decay:44100},radio:{cmRatio:1,index:40,attack:13230,decay:22050},noise:{cmRatio:.04,index:1e3,attack:44.1,decay:4410},frog:{cmRatio:.1,index:2,attack:13230,decay:220.5},gong:{cmRatio:1.4,index:.95,attack:44.1,decay:220500},drum:{cmRatio:1.40007,index:2,attack:44,decay:44100},drum2:{cmRatio:1+Math.sqrt(2),index:.2,attack:44,decay:882},brass:{maxVoices:4,cmRatio:1/1.0007,index:5,attack:4100,decay:1},clarinet:{cmRatio:1.5,index:1.5,attack:2205,decay:8820}},i
}},{"./clock":10,"gibberish-dsp":2}],22:[function(e,t){t.exports=function(t){"use strict";var i=e("../../external/teoria.min"),n=t.dollar,r={Teoria:i,Scale:function(e,o){var s={root:"string"==typeof e?i.note(e):e,notes:[],degree:1,chord:function(e,t){var i=[];t=t||0;for(var n=0;n<e.length;n++)i.push(this.notes[e[n]+t]);return i},create:function(){var e="number"!=typeof u?i.note(u).fq():u,n=a;if(this.notes.length=0,t.Theory.Scales[n]){var r=t.Theory.Scales[n](e);r.create(e),this.notes=r.notes}else console.log("No scale for the mode "+a+" exists.")},set:function(e,t){Array.isArray(arguments[0])?(this.root=arguments[0][0],this.mode=arguments[0][1]):(this.root=e,this.mode=t)}},a=o||"aeolian";Object.defineProperty(s,"mode",{configurable:!0,get:function(){return a},set:function(e){a=e,s.create()}});var u=e||440;return Object.defineProperty(s,"root",{get:function(){return u},set:function(e){"number"==typeof e?u=e:"string"==typeof e?u=r.Teoria.note(e).fq():"object"==typeof e&&(u=e.accidental?e.fq():r.Teoria.note(e.value).fq()),s.create()}}),s.gibber=!0,t.createProxyProperty(s,"root",!0,!1,null,!1,1),t.createProxyProperty(s,"mode",!0,!1,null,!1,1),n.subscribe("/gibber/clear",function(){s.seq.isConnected=!1,s.seq.isRunning=!1,s.seq.destinations.length=0}),s.create(u),s},CustomScale:function(e,t){var n={notes:[],degree:1,ratios:t||[1,1.1,1.25,1.3333,1.5,1.666,1.75],create:function(e){this.notes=[];for(var t="number"==typeof e?e:i.note(e).fq(),n=0;8>n;n++){for(var r=0;r<this.ratios.length;r++){var o=r,s=t*(1+Math.floor(o/this.ratios.length));this.notes.push(s*this.ratios[o%this.ratios.length])}t*=2}t="number"==typeof e?e:i.note(e).fq();for(var n=-1;n>=-8;n--){t/=2;for(var r=0;r<this.ratios.length;r++){var a=n*this.ratios.length+r,o=r,s=t*(1+Math.floor(o/this.ratios.length));this.notes[a]=s*this.ratios[o%this.ratios.length]}}},chord:function(e,t){var i=[];t=t||0;for(var n=0;n<e.length;n++)i.push(this.notes[e[n]+t]);return i}};return n.create(e),n},Scales:{Major:function(e){return r.CustomScale(e,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Ionian:function(e){return r.CustomScale(e,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Dorian:function(e){return r.CustomScale(e,[1,9/8,1.2,4/3,1.5,5/3,1.8])},Phrygian:function(e){return r.CustomScale(e,[1,16/15,1.2,4/3,1.5,1.6,1.8])},Lydian:function(e){return r.CustomScale(e,[1,9/8,5/4,45/32,1.5,5/3,15/8])},Mixolydian:function(e){return r.CustomScale(e,[1,9/8,5/4,4/3,1.5,1.6,1.8])},Minor:function(e){return r.CustomScale(e,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Aeolian:function(e){return r.CustomScale(e,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Locrian:function(e){return r.CustomScale(e,[1,16/15,1.2,4/3,62/45,1.6,15/8])},MajorPentatonic:function(e){return r.CustomScale(e,[1,9/8,5/4,1.5,5/3])},MinorPentatonic:function(e){return r.CustomScale(e,[1,1.2,4/3,1.5,15/8])},Chromatic:function(e){return r.CustomScale(e,[1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,7/4,15/8])},HalfWhole:function(e){return r.CustomScale(e,[1,1.059463,1.189207,1.259921,1.414214,1.498307,1.681793,1.781797])},WholeHalf:function(e){return r.CustomScale(e,[1,1.122462,1.189207,1.33484,1.414214,1.587401,1.681793,1.887749])},Pythagorean:function(e){return r.CustomScale(e,[1,256/243,9/8,32/27,81/64,4/3,729/512,1.5,128/81,27/16,16/9,243/128])},PythagoreanMajor:function(e){return r.CustomScale(e,[1,9/8,81/64,4/3,1.5,27/16,243/128])},PythagoreanMinor:function(e){return r.CustomScale(e,[1,9/8,32/27,4/3,1.5,128/81,16/9])},Limit5:function(e){return r.CustomScale(e,[1,16/15,9/8,1.2,5/4,4/3,45/32,1.5,1.6,5/3,1.8,15/8])},Limit5Major:function(e){return r.CustomScale(e,[1,9/8,5/4,4/3,1.5,5/3,15/8])},Limit5Minor:function(e){return r.CustomScale(e,[1,9/8,1.2,4/3,1.5,1.6,1.8])},Mess3:function(e){return r.CustomScale(e,[1,1.122462,1.189207,1.259921,1.414214,1.498307,1.587401,1.781797,1.887749])},Mess4:function(e){return r.CustomScale(e,[1,1.059463,1.122462,1.33484,1.414214,1.498307,1.587401,1.887749])},Mess5:function(e){return r.CustomScale(e,[1,1.059463,1.33484,1.414214,1.498307,1.887749])},Mess6:function(e){return r.CustomScale(e,[1,1.122462,1.259921,1.33484,1.414214,1.587401,1.781797,1.887749])},Mess7:function(e){return r.CustomScale(e,[1,1.059463,1.122462,1.189207,1.33484,1.414214,1.498307,1.587401,1.681793,1.887749])},Adams:function(e){return r.CustomScale(e,[1,1.122462,1.259921,1.414214,1.498307,1.681793,1.781797])},Equal5Tone:function(e){return r.CustomScale(e,[1,1.15,1.32,1.35,1.52,1.74])},Equal7Tone:function(e){return r.CustomScale(e,[1,1.1,1.22,1.35,1.49,1.64,1.81])},Just:function(e){return r.CustomScale(e,[1,1.0417,1.125,1.2,1.25,1.3333,1.4063,1.5,1.6,1.6667,1.8,1.875])},Shruti:function(e){return r.CustomScale(e,[1,256/243,16/15,10/9,9/8,32/27,1.2,5/4,81/64,4/3,1.35,45/32,729/512,1.5,128/81,1.6,5/3,27/16,16/9,1.8,15/8,243/128,2])}},chord:function(e){if(this.notation=e,"string"==typeof this.notation){var t,n,o=this.notation.slice(0,1);isNaN(this.notation.charAt(1))?(o+=this.notation.charAt(1),t=parseInt(this.notation.slice(2,3)),n=this.notation.slice(3)):(t=parseInt(this.notation.slice(1,2)),n=this.notation.slice(2));for(var s=i.note(o+t).chord(n),a=0;a<s.notes.length;a++){var u=s.notes[a];this.note("number"==typeof l?l:u.fq())}}else for(var c=0;c<this.notation.length;c++){var l,p=this.scale?this.scale.notes[this.notation[c]]:this.notation[c];switch(typeof p){case"number":l=p;break;case"object":l=p.fq?p.fq():p;break;case"string":l=r.Teoria.note(p).fq()}this.note(l)}return"undefined"!=typeof arguments[1]&&(this.amp=arguments[1]),this}};return r}},{"../../external/teoria.min":4}],23:[function(e,t){t.exports=function(t){"use strict";var i={Presets:{}},n=e("gibberish-dsp"),r=t.dollar,o=(e("./clock")(t),t.outputCurves),s=o.LINEAR,a=o.LOGARITHMIC,u={amp:{min:0,max:1,output:a,timescale:"audio"},pan:{min:-1,max:1,output:a,timescale:"audio"},out:{min:0,max:1,output:s,timescale:"audio",dimensions:1}};return i.Vocoder=function(e,i,o,s,a,u){var c=new n.Vocoder(e,i,o,s,a,u).connect(t.Master);return c.type="Gen",r.extend(!0,c,t.Audio.ugenTemplate),c.fx.ugen=c,c},i.Robot=function(e){function i(){n.modulator=Speak(o),n.modulator._,n.say=n.modulator.say.bind(n),t.defineSequencedProperty(n,"say"),c&&(n.say.values=s,n.say.durations=a),n.connect()}var n,o=e||{};n=t.Audio.Vocoder.Vocoder(null,null,o.numBands||16),n.disconnect(),isNaN(o.maxVoices)&&(o.maxVoices=1),isNaN(o.resonance)&&(o.resonance=4),isNaN(o.attack)&&(o.attack=ms(1)),isNaN(o.decay)&&(o.decay=measures(8)),isNaN(o.pulsewidth)&&(o.pulsewidth=.05),n.carrier=t.Audio.Synths.Synth2(o),n.note=n.carrier.note.bind(n),n._note=n.carrier._note.bind(n),n.chord=n.carrier.chord.bind(n),n.carrier._;var s,a,c=!1;return n.say=function(e,t){c===!1&&(s=e,a=t,c=!0)},t.Modules["gibber/publications/SpeakLib"]?i():t.import("gibber/publications/SpeakLib").done(function(){var e=setInterval(function(){"undefined"!=typeof Speak&&(i(),clearInterval(e))},250)}),t.defineSequencedProperty(n,"say"),t.defineSequencedProperty(n,"chord"),t.defineSequencedProperty(n,"note"),r.extend(!0,n,t.Audio.ugenTemplate),t.createProxyProperties(n,u),n},i}},{"./clock":10,"gibberish-dsp":2}],24:[function(e,t){(function(e){!function(){"use strict";function i(e,t,n){for(var r in t)n&&(l(t[r])||u(t[r]))?(l(t[r])&&!l(e[r])&&(e[r]={}),u(t[r])&&!u(e[r])&&(e[r]=[]),i(e[r],t[r],n)):void 0!==t[r]&&(e[r]=t[r])}var n="function"==typeof Zepto,r="function"==typeof jQuery,o="object"==typeof e.$||"function"==typeof e.$,s=null,a=n||r||o,u=Array.isArray,c=function(e){return"object"==typeof e},l=function(e){return c(e)&&Object.getPrototypeOf(e)==Object.prototype};s=a?r?jQuery:n?Zepto:o?e.$:{}:{},a||(s.extend=function(e){var t,n=Array.prototype.slice.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){i(e,n,t)}),e},s.isArray=Array.isArray,s.isPlainObject=l,s.type=function(e){return typeof e});var p={};s.subscribe=function(e,t){"undefined"==typeof p[e]&&(p[e]=[]),p[e].push(t)},s.unsubscribe=function(e,t){if("undefined"!=typeof p[e]){var i=p[e];i.splice(i.indexOf(t),1)}},s.publish=function(e,t){if("undefined"!=typeof p[e])for(var i=p[e],n=0;n<i.length;n++)i[n](t)},t.exports=s}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t){t.exports=function(){"use strict";var e=function(){for(var t=[],i=0,n=this.length;n>i;i++){var r=Object.prototype.toString.call(this[i]).split(" ").pop().split("]").shift().toLowerCase();r&&(t=t.concat(/^(array|collection|arguments|object)$/.test(r)?e.call(this[i]):this[i]))}return t},t=function(e,t){for(var i=[],n=0;t>n;n++)i.push([1]);for(var r=n;e>r;r++)i.push(0);return i},i=function(e){for(var t=0,i=0,n=0;n<e.length;n++)Array.isArray(e[n])&&(e[n].length>t?(t=e[n].length,i=1):e[n].length===t&&i++);return i},n=function(n,o,s){function a(t,n){var r=0===u++?n:i(c),o=c.length-r,s=r>=o?o:r;if(s>1||1===u)for(var l=0;s>l;l++){var p=c.pop(),f=Array.isArray(p);c[l].push(p),f&&e.call(c[l])}return t%n!==0?a(n,t%n):e.call(c)}var u=0,c=t(o,n);return r(a(o,n),s)},r=function(e,t){var i=[];console.log(e,t),"undefined"==typeof t&&(t=1/e.length);for(var n=0,r=0;n<e.length;)n++,r+=t,(1==e[n]||n===e.length)&&(i.push(r),r=0);return i},o={"1,4":"1000","2,3":"101","2,5":"10100","3,4":"1011","3,5":"10101","3,7":"1010100","3,8":"10010010","4,7":"1010101","4,9":"101010100","4,11":"10010010010","5,6":"101111","5,7":"1011011","5,8":"10110110","5,9":"101010101","5,11":"10101010100","5,12":"100101001010","5,16":"1001001001001000","7,8":"10111111","11,24":"100101010101001010101010"};return n.test=function(t){var i=0,r=0;if("string"!=typeof t){for(var s in o){var a=o[s],u=e.call(n.apply(null,s.split(","))).join("");console.log(u,a),u===a?(console.log("TEST PASSED",s),r++):(console.log("TEST FAILED",s),i++)}console.log("*****************************TEST RESULTS - Passed: "+r+", Failed: "+i)}else{var a=o[t],u=e.call(n.apply(null,t.split(","))).join("");console.log(u,a),u==a?console.log("TEST PASSED FOR",t):console.log("TEST FAILED FOR",t)}},n}},{}],26:[function(require,module,exports){!function(){var $=require("./dollar"),Gibber={dollar:$,Presets:{},scale:null,minNoteFrequency:50,started:!1,outputCurves:{LINEAR:0,LOGARITHMIC:1},Pattern:require("./pattern"),"export":function(e){Gibber.Utilities.export(e),e.Pattern=Gibber.Pattern,e.Score=Gibber.Score,e.Euclid=Gibber.Euclid,Gibber.Audio&&Gibber.Audio.export(e),Gibber.Graphics&&Gibber.Graphics.export(e),Gibber.Interface&&Gibber.Interface.export(e),Gibber.Communication&&Gibber.Communication.export(e)},init:function(e){"undefined"==typeof window?(window=GLOBAL,document=GLOBAL.document=!1):"undefined"!=typeof GLOBAL&&(GLOBAL.document||(document=GLOBAL.document=!1));var t={globalize:!0,canvas:null,target:window,graphicsMode:"3d"};if("object"==typeof e&&$.extend(t,e),Gibber.Audio)if(Gibber.Audio.init(),t.globalize)t.target.Master=Gibber.Audio.Master;else{var i=Gibber.export.bind(Gibber);$.extend(Gibber,Gibber.Audio),Gibber.export=i}Gibber.Graphics,Gibber.Interface,t.globalize&&Gibber.export(t.target),t.target.$=$,Gibber.Utilities.init()},Modules:{},"import":function(e,t){var i=null;if(console.log("Loading module "+e+"..."),-1===e.indexOf("http:"))console.log("loading via post",e),$.post(Gibber.Environment.SERVER_URL+"/gibber/"+e,{},function(n){n=JSON.parse(n);var r=new Function("return "+n.text);return Gibber.Modules[e]=r(),t&&Gibber.Modules[e]&&$.extend(t,Gibber.Modules[e]),Gibber.Modules[e]?("function"==typeof Gibber.Modules[e].init&&Gibber.Modules[e].init(),"object"==typeof Gibber.Modules[e]&&(Gibber.Modules[e].moduleText=n.text),console.log("Module "+e+" is now loaded.")):console.log("Publication "+e+" is loaded. It may not be a valid module."),null!==i&&i(Gibber.Modules[e]),!1});else{var n=document.createElement("script");n.src=e,n.onload=function(){console.log("Module "+e+" is now loaded."),null!==i&&i()},document.head.appendChild(n)}return{done:function(e){i=e}}},scriptCallbacks:[],run:function(script,pos,cm){var _start=pos.start?pos.start.line:pos.line,tree;try{tree=Gibber.Esprima.parse(script,{loc:!0,range:!0})}catch(e){return void console.error("Parse error on line "+(_start+e.lineNumber)+" : "+e.message.split(":")[1])}for(var __i__=0;__i__<tree.body.length;__i__++){var obj=tree.body[__i__],start={line:_start+obj.loc.start.line-1,ch:obj.loc.start.column},end={line:_start+obj.loc.end.line-1,ch:obj.loc.end.column},src=cm.getRange(start,end),result=null;try{result=eval(src),log("function"!=typeof result?result:"Function")}catch(e){console.error("Error evaluating expression beginning on line "+(start.line+1)+"\n"+e.message)}if(this.scriptCallbacks.length>0)for(var ___i___=0;___i___<this.scriptCallbacks.length;___i___++)this.scriptCallbacks[___i___](obj,cm,pos,start,end,src,_start)}},processArguments:function(e,t){var i;return e.length?"string"==typeof e[0]&&"Drums"!==t&&"XOX"!==t?(i=Gibber.getPreset(e[0],t),"object"==typeof e[1]&&$.extend(i,e[1]),i):Array.prototype.slice.call(e,0):i},processArguments2:function(e,t,i){if(t.length){var n=t[0];if("string"==typeof n&&"Drums"!==i&&"XOX"!==i&&"Shader"!==i)preset=Gibber.getPreset(t[0],i),"object"==typeof t[1]&&$.extend(preset,t[1]),$.extend(e,preset);else if($.isPlainObject(n)&&"undefined"==typeof n.type)$.extend(e,n);else{var r=Object.keys(e.properties);if("FX"===e.type)for(var o=0;o<t.length;o++)e[r[o+1]]=t[o];else for(var o=0;o<t.length;o++)e[r[o]]=t[o]}}},getPreset:function(e,t){var i={};return Gibber.Presets[t]&&Gibber.Presets[t][e]?i=Gibber.Presets[t][e]:Gibber.log(t+" does not have a preset named "+e+"."),i},clear:function(){var e=Array.prototype.slice.call(arguments,0);Gibber.Audio&&Gibber.Audio.clear.apply(Gibber.Audio,e),Gibber.Graphics&&Gibber.Graphics.clear(Gibber.Graphics,e),Gibber.proxy(window,[a]),$.publish("/gibber/clear",{}),console.log("Gibber has been cleared.")},proxy:function(e){for(var t="abcdefghijklmnopqrstuvwxyz",i=0;i<t.length;i++){var n=t.charAt(i);"undefined"!=typeof window[n]&&-1===arguments[1].indexOf(window[n])&&(delete window[n],delete window["___"+n]),function(){var t=n;Object.defineProperty(e,t,{configurable:!0,get:function(){return e["___"+t]},set:function(i){if(i)e["___"+t]&&"function"==typeof e["___"+t].replaceWith&&(e["___"+t].replaceWith(i),console.log(e["___"+t].name+" was replaced with "+i.name)),e["___"+t]=i;else if(e["___"+t]){var n=e["___"+t];n&&"function"==typeof n.kill&&n.kill()}}})}()}},construct:function(e,t){function i(){return e.apply(this,t)}return i.prototype=e.prototype,new i},createMappingObject:function(e,t){var i="function"==typeof e.min?e.min():e.min,n="function"==typeof e.max?e.max():e.max,r="function"==typeof t.min?t.min():t.min,o="function"==typeof t.max?t.max():t.max;if("undefined"==typeof t.object&&t.Value&&(t=t.Value),"undefined"!=typeof e.object[e.Name].mapping)return void e.object[e.Name].mapping.replace(t.object,t.propertyName,t.Name);"undefined"!=typeof t.targets&&-1===t.targets.indexOf(e)&&t.targets.push([e,e.Name]);var s="Out"!==t.Name?t.timescale:"audioOut";return mapping=Gibber.mappings[e.timescale][s](e,t),Object.defineProperties(e.object[e.Name],{min:{configurable:!0,get:function(){return i},set:function(t){i=t,e.object[e.Name].mapping.outputMin=i}},max:{configurable:!0,get:function(){return n},set:function(t){n=t,e.object[e.Name].mapping.outputMax=n}}}),e.object[e.Name].mappingObjects=[],Gibber.createProxyProperty(e.object[e.Name],"min",1,0,{min:i,max:n,output:e.output,timescale:e.timescale,dimensions:1}),Gibber.createProxyProperty(e.object[e.Name],"max",1,0,{min:i,max:n,output:e.output,timescale:e.timescale,dimensions:1}),Object.defineProperties(t.object[t.Name],{min:{configurable:!0,get:function(){return r},set:function(t){r=t,e.object[e.Name].mapping.inputMin=r}},max:{configurable:!0,get:function(){return o},set:function(t){o=t,e.object[e.Name].mapping.inputMax=o}}}),e.object[e.Name].invert=function(){e.object[e.Name].mapping.invert()},"undefined"==typeof e.object.mappings&&(e.object.mappings=[]),e.object.mappings.push(mapping),"undefined"==typeof t.object.mappings&&(t.object.mappings=[]),t.object.mappings.push(mapping),Gibber.defineSequencedProperty(e.object[e.Name],"invert"),mapping},defineSequencedProperty:function(e,t,i){var n,r,o=e[t];!e.seq&&Gibber.Audio&&(e.seq=Gibber.Audio.Seqs.Seq({doNotStart:!0,scale:e.scale,priority:i,target:e})),o.seq=function(s,a){var u=$.isArray(s)?s:[s],c=$.isArray(a)?a:"undefined"!=typeof a?[a]:null,l={key:t,values:[Gibber.construct(Gibber.Pattern,u)],durations:null!==c?[Gibber.construct(Gibber.Pattern,c)]:null,target:e,priority:i};"undefined"!=typeof n&&(n.shouldStop=!0,e.seq.seqs.splice(r,1));var p=l.values[0];if(u.randomFlag){p.filters.push(function(){var e=Gibber.Utilities.rndi(0,p.values.length-1);return[p.values[e],1,e]});for(var f=0;f<u.randomArgs.length;f+=2)p.repeat(u.randomArgs[f],u.randomArgs[f+1])}if(null!==c){var h=l.durations[0];if(c.randomFlag){h.filters.push(function(){var e=Gibber.Utilities.rndi(0,h.values.length-1);return[h.values[e],1,e]});for(var f=0;f<c.randomArgs.length;f+=2)h.repeat(c.randomArgs[f],c.randomArgs[f+1])}h.seq=e.seq}return p.seq=e.seq,e.seq.add(l),r=null!==c?e.seq.seqs.length-1:e.seq.autofire.length-1,n=null!==c?e.seq.seqs[r]:e.seq.autofire[r],Object.defineProperties(o,{values:{configurable:!0,get:function(){return null!==c?e.seq.seqs[r].values[0]:e.seq.autofire[r].values[0]},set:function(t){var i=Gibber.construct(Gibber.Pattern,t);Array.isArray(i)||(i=[i]),null!==c?e.seq.seqs[r].values=i:e.seq.autofire[r].values=i}},durations:{configurable:!0,get:function(){return null!==c?e.seq.seqs[r].durations[0]:null},set:function(t){Array.isArray(t)||(t=[t]),e.seq.seqs[r].durations=t}}}),e.seq.isRunning||(e.seq.offset=Gibber.Clock.time(e.offset),e.seq.start(!0,i)),e},o.seq.stop=function(){n.shouldStop=!0},o.seq.start=function(){n.shouldStop=!1,e.seq.timeline[0]=[n],e.seq.nextTime=0,e.seq.isRunning||e.seq.start(!1,i)},o.seq.repeat=function(e){var t=0,i=function(i,n){return i[2]%(n.getLength()-1)===0&&0!==i[2]&&(t++,t===e&&n.seq.stop()),i};o.values.filters.push(i)},o.score=function(e,t){return o.seq.bind(null,e,t)}},defineRampedProperty:function(e,t){var i,n=e[t],r=t.slice(1);n.ramp=function(t,n,o){return arguments.length<2?void console.err("ramp requires at least two arguments: target and time."):("undefined"==typeof o&&(o=n,n=t,t=e[r]()),i&&i(),"object"!=typeof t?e[r]=Line(t,n,o):t.retrigger(n,Gibber.Clock.time(o)),i=future(function(){e[r]=n},o),e)}},createProxyMethods:function(e,t,i){for(var n=0;n<t.length;n++)Gibber.defineSequencedProperty(e,t[n],i)},defineProperty:function(e,t,i,n,r,o,s){var a="object"==typeof e[t]?e[t].valueOf():e[t],u=t.charAt(0).toUpperCase()+t.slice(1),c=function(i){var n=c;return"undefined"!=typeof i&&(c.oldSetter?c.oldSetter.call(e,i):e[t]=i,n=e),n};r=o?r||e.mappingProperties[t]:null,$.extend(c,r),$.extend(c,{propertyName:t,Name:u,value:a,type:"property",object:e,targets:[],valueOf:function(){return c.value},toString:function(){var e="";return e="object"==typeof c.value?c.value.toString():c.value},oldSetter:e.__lookupSetter__(t),oldGetter:e.__lookupGetter__(t),oldMappingObjectGetter:e.__lookupGetter__(u),oldMappingObjectSetter:e.__lookupSetter__(u)}),Object.defineProperty(e,t,{configurable:!0,get:function(){return c},set:function(t){if("function"!=typeof t&&("object"!=typeof t||"mapping"!==t.type)||"property"!==t.type&&"mapping"!==t.type){o&&e[c.Name]&&"undefined"!=typeof e[c.Name].mapping&&e[c.Name].mapping.remove&&e[c.Name].mapping.remove(!0);var i=t;if(c.oldSetter){var n=c.oldSetter.call(e,t);"undefined"!=typeof n&&(i=n)}c.value=i}else Gibber.createMappingObject(c,t);return e}}),i&&Gibber.defineSequencedProperty(e,t,s),n&&Gibber.defineRampedProperty(e,t),o&&Object.defineProperty(e,c.Name,{configurable:!0,get:function(){return"function"==typeof c.oldMappingObjectGetter&&c.oldMappingObjectGetter(),c},set:function(t){e[c.Name]=t,"function"==typeof mapping.oldMappingObjectSetter&&mapping.oldMappingObjectSetter(t)}})},createProxyProperty:function(e,t,i,n,r,o,s){o=o===!1?!1:!0,Gibber.defineProperty(e,t,i,n,r,o,s)},createProxyProperties:function(e,t,i,n){var r="undefined"==typeof i?!0:i,o="undefined"==typeof n?!0:n;e.gibber=!0,e.mappingProperties=t,e.mappingObjects=[];for(var s in t)t[s].doNotProxy||Gibber.createProxyProperty(e,s,r,o,t[s])}};Gibber.Utilities=require("./utilities")(Gibber),Gibber.mappings=require("./mappings")(Gibber),Gibber.Euclid=require("./euclidean")(Gibber),module.exports=Gibber}()},{"./dollar":24,"./euclidean":25,"./mappings":27,"./pattern":28,"./utilities":29}],27:[function(e,t){t.exports=function(e){var t={audio:{graphics:function(t,i){"undefined"==typeof i.object.track&&(i.object.track={});var n,r="undefined"!=typeof i.object.track[i.propertyName]?i.object.track[i.propertyName]:new e.Audio.Core.Proxy2(i.object,i.propertyName),o=new e.Audio.Core.OnePole({a0:.005,b1:.995});return i.object.track=r,n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(r,t.min,t.max,i.min,i.max,t.output,i.wrap),o.input=n,t.object[t.propertyName]=o,n.proxy=r,n.op=o,n.remove=function(e){e||(t.object[t.propertyName]=t.object[t.Name].mapping.getValue()),delete t.object[t.Name].mapping},n},"interface":function(t,i){var n,r="undefined"!=typeof i.track?i.track:new e.Audio.Core.Proxy2(i.object,i.propertyName),o=new e.Audio.Core.OnePole({a0:.005,b1:.995}),s=t.max-t.min,a=(t.object[t.propertyName]-t.min)/s,u=i.min+(i.max-i.min)*a;if(i.object.setValue&&i.object.setValue(u),i.track=r,n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(r,t.min,t.max,i.min,i.max,t.output,i.wrap),o.input=n,t.object[t.propertyName]=o,n.proxy=r,n.op=o,n.remove=function(e){e||(t.object[t.propertyName]=n.getValue()),delete n},"undefined"!=typeof i.object.label){for(var c="",l=0;l<i.targets.length;l++){var p=i.targets[l];c+=p[0].object.name+"."+p[1],l!==i.targets.length-1&&(c+=" & ")}i.object.label=c}return n.replace=function(e,i,n){r.setInput(e),-1===e[n].targets.indexOf(t)&&e[n].targets.push([t,t.Name])},n},audio:function(t,i){var n,r;return"undefined"!=typeof i.object.track?(n=i.object.track,n.count++):(n=new e.Audio.Core.Proxy2(i.object,i.propertyName),n.count=1),i.object.track=n,t.object[t.propertyName]=e.Audio.Core.Binops.Map(n,t.min,t.max,i.min,i.max),r=t.object[t.Name].mapping=t.object[t.propertyName],r.remove=function(e){e||(t.object[t.propertyName]=r.getValue()),r.op&&r.op.remove(),delete t.object[t.Name].mapping},r.replace=function(i,n,o){var s=new e.Audio.Core.Proxy2(i,n);r.input=s,i[o].targets&&-1===i[o].targets.indexOf(t)&&i[o].targets.push([t,t.Name])},r},audioOut:function(t,i){var n;n=e.Audio.Core.Binops.Map(null,t.min,t.max,0,1,0),t.object[t.propertyName]=t.object[t.Name].mapping=n,"undefined"!=typeof i.object.track?(n.follow=i.object.track,n.follow.count++):(n.follow=new e.Audio.Analysis.Follow({input:i.object,useAbsoluteValue:!0}),n.follow.count=1),i.object.track=n.input=n.follow,n.remove=function(e){e||(t.object[t.propertyName]=t.object[t.Name].mapping.getValue()),n.bus&&n.bus.disconnect(),n.follow&&(n.follow.count--,0===n.follow.count&&(delete i.object.track,n.follow.remove())),delete t.object[t.Name].mapping},n.replace=function(e,i,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{configurable:!0,get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n}},graphics:{graphics:function(t,i){var n,r=e.Audio.Core.Binops.Map(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap),o=r.getValue.bind(r);return r.getValue=function(){return r.callback(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap),o()},n=t.object[t.Name].mapping=r,t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),t.object[t.propertyName]=t.object[t.Name].mapping.getValue(),delete t.object[t.Name].mapping},n.replace=function(e){n.input=e},n},"interface":function(t,i){var n,r=e.Audio.Core.Binops.Map(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap);"undefined"==typeof i.object.functions&&(i.object.functions={},i.object.onvaluechange=function(){for(var e in i.object.functions)i.object.functions[e]()}),n=t.object[t.Name].mapping=r,t.mapping.from=i;var o=t.propertyName+" <- "+i.object.propertyName+"."+i.Name;if(i.object.functions[o]=function(){var e=n.callback(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap);t.object[t.Name].oldSetter.call(t.object[t.Name],e)},n.replace=function(){},n.remove=function(){console.log("mapping removed"),delete i.object.functions[o]},i.object.setValue&&i.object.setValue(t.object[t.propertyName]),"undefined"!=typeof i.object.label){for(var s="",a=0;a<i.targets.length;a++){var u=i.targets[a];s+=u[0].object.propertyName+"."+u[1],a!==i.targets.length-1&&(s+=" & ")}i.object.label=s}return n},audio:function(t,i){var n;n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,i.min,i.max,t.output,i.wrap),n.follow="undefined"!=typeof i.object.track?i.object.track:new e.Audio.Core.Follow({input:i.object[i.propertyName],useAbsoluteValue:!1}),i.object.track=t.object[t.Name].mapping.follow,n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(e,i,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete i.object.track,this.follow.remove())),t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),delete t.object[t.Name].mapping},n},audioOut:function(i,n){if("undefined"!=typeof i.object[i.Name].mapping)return r.replace(n.object,n.propertyName,n.Name),r;var r=i.object[i.Name].mapping=e.Audio.Core.Binops.Map(null,i.min,i.max,0,1,0);"undefined"!=typeof n.object.track?(r.follow=n.object.track,r.follow.count++):(r.follow=new e.Audio.Core.Follow({input:n.object}),r.follow.count=1),n.object.track=r.follow;var o=r.follow.bufferSize;return Object.defineProperty(i.object[i.Name],"env",{configurable:!0,get:function(){return o},set:function(t){o=e.Clock.time(t),r.follow.bufferSize=o}}),r.input=r.follow,r.bus=new e.Audio.Core.Bus2({amp:0}).connect(),r.connect(r.bus),r.replace=function(t,o,s){if(t[s].timescale===n.timescale){var a=r.follow.input[n.Name].targets.indexOf(i);a>=-1&&r.follow.input[n.Name].targets.splice(a,1),r.follow.input=t,-1===t[s].targets.indexOf(i)&&t[s].targets.push([i,i.Name])}else r.bus.disconnect(),r.follow.remove(),e.createMappingObject(i,t)},i.object.mod?i.object.mod(i.propertyName,r,"="):i.modObject?i.modObject.mod(i.modName,r,"="):!function(){var e=r;i.object.update=function(){i.object[i.propertyName](e.getValue())}}(),r.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete n.object.track,this.follow.remove())),i.object.mod?i.object.removeMod(i.propertyName):i.modObject&&i.modObject.removeMod(i.modName),i.object.mappings.splice(i.object.mappings.indexOf(r),1),n.object.mappings.splice(n.object.mappings.indexOf(r),1);var e=i.object[i.Name].targets,o=e.indexOf(t);-1!==o&&e.splice(o,1),delete i.object[i.Name].mapping},r}},notation:{graphics:function(t,i){var n,r=e.Audio.Core.Binops.Map(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap),o=r.getValue.bind(r);return r.getValue=function(){return r.callback(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap),o()},n=t.object[t.Name].mapping=r,t.object.mod?t.object.mod(t.propertyName,n,"="):t.modObject.mod(t.modName,n,"="),n.remove=function(){t.object.mod?t.object.removeMod(t.propertyName):t.modObject.removeMod(t.modName),t.object[t.propertyName]=t.object[t.Name].mapping.getValue(),delete t.object[t.Name].mapping},n.replace=function(e){n.input=e},n},"interface":function(t,i){var n,r=e.Audio.Core.Binops.Map(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap);"undefined"==typeof i.object.functions&&(i.object.functions={},i.object.onvaluechange=function(){for(var e in i.object.functions)i.object.functions[e]()}),n=t.object[t.Name].mapping=r,t.mapping.from=i;var o=t.propertyName+" <- "+i.object.propertyName+"."+i.Name;if(i.object.functions[o]=function(){var e=n.callback(i.object[i.propertyName],t.min,t.max,i.min,i.max,t.output,i.wrap);t.object[t.Name].oldSetter.call(t.object[t.Name],e)},n.replace=function(){},n.remove=function(){console.log("mapping removed"),delete i.object.functions[o]},i.object.setValue&&i.object.setValue(t.object[t.propertyName]),"undefined"!=typeof i.object.label){for(var s="",a=0;a<i.targets.length;a++){var u=i.targets[a];s+=u[0].object.propertyName+"."+u[1],a!==i.targets.length-1&&(s+=" & ")}i.object.label=s}return n},audio:function(t,i){var n;n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,i.min,i.max,t.output,i.wrap),"undefined"!=typeof i.object.track&&i.object.track.input===i.object.properties[i.propertyName]?(n.follow=i.object.track,n.follow.count++):(n.follow=new e.Audio.Core.Follow({input:i.object.properties[i.propertyName],useAbsoluteValue:!1}),n.follow.count=1),i.object.track=t.object[t.Name].mapping.follow,n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(e,i,r){n.follow.input=e,-1===e[r].targets.indexOf(t)&&e[r].targets.push([t,t.Name])};var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n.update=function(){t.object[t.propertyName](n.getValue())},n.text=t.object,e.Environment.Notation.add(n),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete i.object.track,this.follow.remove())),e.Environment.Notation.remove(n),delete t.object[t.Name].mapping},n},audioOut:function(t,i){if("undefined"!=typeof t.object[t.Name].mapping)return n.replace(i.object,i.propertyName,i.Name),n;var n=t.object[t.Name].mapping=e.Audio.Core.Binops.Map(null,t.min,t.max,0,1,0);"undefined"!=typeof i.object.track&&i.object.track.input===i.object.properties[i.propertyName]?(n.follow=i.object.track,n.follow.count++):(n.follow=new e.Audio.Core.Follow({input:i.object,useAbsoluteValue:!0}),n.follow.count=1),i.object.track=n.follow;var r=n.follow.bufferSize;return Object.defineProperty(t.object[t.Name],"env",{configurable:!0,get:function(){return r},set:function(t){r=e.Clock.time(t),n.follow.bufferSize=r}}),n.input=n.follow,n.bus=new e.Audio.Core.Bus2({amp:0}).connect(),n.connect(n.bus),n.replace=function(r,o,s){if(r[s].timescale===i.timescale){var a=n.follow.input[i.Name].targets.indexOf(t);a>=-1&&n.follow.input[i.Name].targets.splice(a,1),n.follow.input=r,-1===r[s].targets.indexOf(t)&&r[s].targets.push([t,t.Name])}else n.bus.disconnect(),n.follow.remove(),e.createMappingObject(t,r)},n.update=function(){t.object[t.propertyName](n.getValue())},n.text=t.object,e.Environment.Notation.add(n),n.remove=function(){this.bus.disconnect(),this.follow&&(this.follow.count--,0===this.follow.count&&(delete i.object.track,this.follow.remove())),e.Environment.Notation.remove(n),delete t.object[t.Name].mapping},n}}};return t},t.exports.outputCurves={LINEAR:0,LOGARITHMIC:1}},{}],28:[function(e,t){!function(){"use strict";var e={concat:function(e){this.values=this.values.concat(e.values)},toString:function(){return this.values.toString()},valueOf:function(){return this.values},getLength:function(){var e;return e=this.start<=this.end?this.end-this.start+1:this.values.length+this.end-this.start+1},runFilters:function(e,t){for(var i=[e,1,t],n=0;n<this.filters.length;n++)i=this.filters[n](i,this);return i},_onchange:function(){}},i=function(){if(!(this instanceof i)){var e=Array.prototype.slice.call(arguments,0);return Gibber.construct(i,e)}var t=function(){var e,i,n,r=t.getLength();
return e=1===r?0:Math.floor(t.phase>-1?t.start+t.phase%r:t.end+t.phase%r),i=t.values[Math.floor(e%t.values.length)],n=t.runFilters(i,e),t.phase+=t.stepSize*n[1],i=n[0],"function"==typeof i&&(i=i()),t.update&&(t.update.value=i),i};return $.extend(t,{start:0,end:0,phase:0,values:Array.prototype.slice.call(arguments,0),original:null,storage:[],stepSize:1,integersOnly:!1,filters:[],onchange:null,range:function(){return Array.isArray(arguments[0])?(t.start=arguments[0][0],t.end=arguments[0][1]):(t.start=arguments[0],t.end=arguments[1]),t},reverse:function(){var e,i=t.values,n=null,r=null,o=i.length;for(n=0,r=o-1;r>n;n+=1,r-=1)e=i[n],i[n]=i[r],i[r]=e;return t._onchange(),t},repeat:function(){for(var e={},i=0;i<arguments.length;i+=2)e[arguments[i]]={phase:0,target:arguments[i+1]};var n=!1,r=null,o=null,s=function(t){var i=t[0],s=(t[1],t);return n===!1&&e[i]&&(n=!0,r=i,o=t[2]),n===!0&&(e[r].phase!==e[r].target?(s[0]=r,s[1]=0,s[2]=o,e[r].phase++):(e[r].phase=0,s[1]=1,i!==r?n=!1:e[r].phase++)),s};return t.filters.push(s),t},reset:function(){return t.values=t.original.slice(0),t._onchange(),t},store:function(){return t.storage[t.storage.length]=t.values.slice(0),t},transpose:function(e){for(var i=0;i<t.values.length;i++)t.values[i]+=e;return t._onchange(),t},shuffle:function(){return Gibber.Utilities.shuffle(t.values),t._onchange(),t},scale:function(e){for(var i=0;i<t.values.length;i++)t.values[i]=t.integersOnly?Math.round(t.values[i]*e):t.values[i]*e;return t._onchange(),t},flip:function(){var e=[],i=null;i=t.values.filter(function(t){var i=-1===e.indexOf(t);return i&&e.push(t),i}),i=i.sort(function(e,t){return e-t});for(var n=0;n<t.values.length;n++){var r=i.indexOf(t.values[n]);t.values[n]=i[i.length-r-1]}return t._onchange(),t},invert:function(){for(var e=t.values[0],i=1;i<t.values.length;i++){var n=e+(e-t.values[i]);t.values[i]=n}return t._onchange(),t},"switch":function(e){return t.storage[e]&&(t.values=t.storage[e].slice(0)),t._onchange(),t},rotate:function(e){if(e>0)for(;e>0;){var i=t.values.pop();t.values.unshift(i),e--}else if(0>e)for(;0>e;){var n=t.values.shift();t.values.push(n),e++}return t._onchange(),t}}),t.retrograde=t.reverse.bind(t),t.end=t.values.length-1,t.original=t.values.slice(0),t.storage[0]=t.original.slice(0),t.integersOnly=t.values.every(function(e){return e===+e&&e===(0|e)}),Gibber.createProxyMethods(t,["rotate","switch","invert","reset","flip","transpose","reverse","shuffle","scale","store","range"],!0),Gibber.createProxyProperties(t,{stepSize:0,start:0,end:0}),t.__proto__=this.__proto__,t};i.prototype=e,t.exports=i}()},{}],29:[function(e,t){t.exports=function(e){"use strict";var t=[],i=!1,n=(e.dollar,e.Audio?e.Audio.Core:null,e.Clock,Math.random,{seq:function(){var e=arguments[0],t=typeof e,i=null;return"object"===t&&Array.isArray(e)&&(t="array"),i},random:function(){return this.randomFlag=!0,this.randomArgs=Array.prototype.slice.call(arguments,0),this},random2:function(){for(var e={},t=null,i=this,r=0;r<arguments.length;r+=2)e[""+arguments[r]]={repeat:arguments[r+1],count:0};return this.pick=function(){var r,o,s=0;return i[t]&&(o=i[t]),null!==t&&e[o].count++<=e[o].repeat?(r=t,e[o].count>=e[o].repeat&&(e[o].count=0,t=null)):(r=n.rndi(0,i.length-1),s=i[r],"undefined"!=typeof e[""+s]?(e[""+s].count=1,t=r):t=null),i[r]},this.pick},choose:function(e){var t=null;if(isNaN(e)&&(e=1),1!==e){for(var i=[],r=0;e>r;r++)i[r]=this[n.rndi(0,this.length-1)];t=i}else t=this[n.rndi(0,this.length-1)];return t},future:function(t,i){var n=0,r=e.Audio.Seqs.Seq(function(){1===n&&(t(),r.stop(),r.disconnect()),n++},e.Audio.Clock.time(i));return function(){r.stop(),r.disconnect()}},shuffle:function(e){for(var t,i,n=e.length;n;t=parseInt(Math.random()*n),i=e[--n],e[n]=e[t],e[t]=i);},solo:function(e){var r=Array.prototype.slice.call(arguments,0);if(e){i&&n.solo();for(var o=0;o<r.length;o++){var s=r[o];s.fx.length>0&&(r[o]=s.fx[s.fx.length-1])}for(var a=0;a<Master.inputs.length;a++){var u=r.indexOf(Master.inputs[a].value),c=Master.inputs[a].value,l=c.name;-1===u&&"polyseq"!==l&&"Seq"!==l&&(Master.inputs[a]._amp=Master.inputs[a].amp,Master.inputs[a].amp=0,t.push(Master.inputs[a]))}i=!0}else{for(var a=0;a<t.length;a++)t[a].amp=t[a]._amp;t.length=0,i=!1}},fill:function(e,t){isNaN(e)&&(e=16),"function"!=typeof t&&(t=Rndf()),t=t.bind(this);for(var i=0;e>i;i++)this[i]=t();return this},merge:function(){for(var e=[],t=0;t<this.length;t++){var i=this[t];if(Array.isArray(i))for(var n=0;n<i.length;n++)e.push(i[n]);else e.push(i)}return e},weight:function(){var e=Array.prototype.slice.call(arguments,0);return this.pick=function(){for(var t=this[0],i=0,r=n.rndf(),o=0;o<e.length;o++)if(i+=e[o],i>r){t=o;break}return t},this},gibberArray:function(){},rndf:function(e,t,i,r){if(r="undefined"==typeof r?!0:r,"undefined"==typeof i&&"object"!=typeof e){1==arguments.length?(t=arguments[0],e=0):2==arguments.length?(e=arguments[0],t=arguments[1]):(e=0,t=1);var o=t-e,s=Math.random(),a=o*s;return e+a}var u=[],c=[];"undefined"==typeof i&&(i=t||e.length);for(var l=0;i>l;l++){var p;if("object"==typeof arguments[0])p=arguments[0][rndi(0,arguments[0].length-1)];else if(r)p=n.rndf(e,t);else{for(p=n.rndf(e,t);c.indexOf(p)>-1;)p=n.rndf(e,t);c.push(p)}u.push(p)}return u},Rndf:function(){{var e,t,i,r;Math.random}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],i=arguments[2]):(e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3]),function(){var o,s,a;return s="function"==typeof e?e():e,a="function"==typeof t?t():t,o="undefined"==typeof i?n.rndf(s,a):n.rndf(s,a,i,r)}},rndi:function(e,t,i,r){var o;if(0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):(e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3]),o=t-e,i>o&&(r=!0),"undefined"==typeof i)return o=t-e,Math.round(e+Math.random()*o);for(var s=[],a=[],u=0;i>u;u++){var c;if(r)c=n.rndi(e,t);else{for(c=n.rndi(e,t);a.indexOf(c)>-1;)c=n.rndi(e,t);a.push(c)}s.push(c)}return s},Rndi:function(){{var e,t,i,r,o;Math.random,Math.round}return 0===arguments.length?(e=0,t=1):1===arguments.length?(t=arguments[0],e=0):2===arguments.length?(e=arguments[0],t=arguments[1]):3===arguments.length?(e=arguments[0],t=arguments[1],i=arguments[2]):(e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3]),o=t-e,"number"==typeof i&&i>o&&(r=!0),function(){var o,s,a;return s="function"==typeof e?e():e,a="function"==typeof t?t():t,o="undefined"==typeof i?n.rndi(s,a):n.rndi(s,a,i,r)}},"export":function(e){e.rndi=n.rndi,e.rndf=n.rndf,e.Rndi=n.Rndi,e.Rndf=n.Rndf,e.future=n.future,e.solo=n.solo},init:function(){Array.prototype.random=Array.prototype.rnd=n.random}});return n}},{}]},{},[1]);